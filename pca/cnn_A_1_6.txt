/afs/inf.ed.ac.uk/user/s17/s1738075/.local/lib/python2.7/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
pca_early_fusion_cnn.py:146: RuntimeWarning: invalid value encountered in divide
  train_set_audio = train_set_audio / audio_max
pca_early_fusion_cnn.py:148: RuntimeWarning: invalid value encountered in divide
  test_set_audio = test_set_audio / audio_max
2018-03-28 21:48:18.364841: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
This API will be deprecated in the future versions. Please check the Github page for the current API

Modality facet for video 8qrpnFRGt2A segment 13 is (partially) missing and is thus being replaced by zeros!

Train on 1283 samples, validate on 229 samples
Epoch 1/100

  64/1283 [>.............................] - ETA: 10s - loss: 0.7133 - acc: 0.4688
 192/1283 [===>..........................] - ETA: 3s - loss: 0.7037 - acc: 0.5260 
 384/1283 [=======>......................] - ETA: 1s - loss: 0.7016 - acc: 0.5521
 512/1283 [==========>...................] - ETA: 1s - loss: 0.7222 - acc: 0.5352
 640/1283 [=============>................] - ETA: 0s - loss: 0.7181 - acc: 0.5359
 768/1283 [================>.............] - ETA: 0s - loss: 0.7140 - acc: 0.5299
 896/1283 [===================>..........] - ETA: 0s - loss: 0.7139 - acc: 0.5324
1088/1283 [========================>.....] - ETA: 0s - loss: 0.7077 - acc: 0.5386
1152/1283 [=========================>....] - ETA: 0s - loss: 0.7063 - acc: 0.5417
1216/1283 [===========================>..] - ETA: 0s - loss: 0.7073 - acc: 0.5411
1280/1283 [============================>.] - ETA: 0s - loss: 0.7071 - acc: 0.5391
1283/1283 [==============================] - 1s 1ms/step - loss: 0.7072 - acc: 0.5386 - val_loss: 0.6849 - val_acc: 0.5895

Epoch 00001: val_acc improved from -inf to 0.58952, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20.ckpt
Epoch 2/100

  64/1283 [>.............................] - ETA: 2s - loss: 0.6591 - acc: 0.5312
 192/1283 [===>..........................] - ETA: 1s - loss: 0.6447 - acc: 0.5885
 320/1283 [======>.......................] - ETA: 0s - loss: 0.6377 - acc: 0.6125
 448/1283 [=========>....................] - ETA: 0s - loss: 0.6390 - acc: 0.6228
 576/1283 [============>.................] - ETA: 0s - loss: 0.6400 - acc: 0.6233
 640/1283 [=============>................] - ETA: 0s - loss: 0.6444 - acc: 0.6188
 704/1283 [===============>..............] - ETA: 0s - loss: 0.6404 - acc: 0.6293
 896/1283 [===================>..........] - ETA: 0s - loss: 0.6347 - acc: 0.6406
1088/1283 [========================>.....] - ETA: 0s - loss: 0.6373 - acc: 0.6351
1280/1283 [============================>.] - ETA: 0s - loss: 0.6322 - acc: 0.6438
1283/1283 [==============================] - 1s 668us/step - loss: 0.6319 - acc: 0.6446 - val_loss: 0.7022 - val_acc: 0.5546

Epoch 00002: val_acc did not improve
Epoch 3/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5798 - acc: 0.6719
 128/1283 [=>............................] - ETA: 0s - loss: 0.5967 - acc: 0.6562
 192/1283 [===>..........................] - ETA: 1s - loss: 0.6260 - acc: 0.6198
 384/1283 [=======>......................] - ETA: 0s - loss: 0.6157 - acc: 0.6536
 576/1283 [============>.................] - ETA: 0s - loss: 0.6220 - acc: 0.6389
 704/1283 [===============>..............] - ETA: 0s - loss: 0.6143 - acc: 0.6463
 896/1283 [===================>..........] - ETA: 0s - loss: 0.6189 - acc: 0.6429
1024/1283 [======================>.......] - ETA: 0s - loss: 0.6178 - acc: 0.6455
1152/1283 [=========================>....] - ETA: 0s - loss: 0.6179 - acc: 0.6510
1216/1283 [===========================>..] - ETA: 0s - loss: 0.6152 - acc: 0.6571
1283/1283 [==============================] - 1s 836us/step - loss: 0.6168 - acc: 0.6532 - val_loss: 0.6930 - val_acc: 0.5590

Epoch 00003: val_acc did not improve
Epoch 4/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5576 - acc: 0.7812
 256/1283 [====>.........................] - ETA: 0s - loss: 0.6086 - acc: 0.6719
 384/1283 [=======>......................] - ETA: 0s - loss: 0.5850 - acc: 0.7005
 576/1283 [============>.................] - ETA: 0s - loss: 0.5796 - acc: 0.7118
 768/1283 [================>.............] - ETA: 0s - loss: 0.5784 - acc: 0.7044
 960/1283 [=====================>........] - ETA: 0s - loss: 0.5764 - acc: 0.7063
1088/1283 [========================>.....] - ETA: 0s - loss: 0.5816 - acc: 0.6994
1152/1283 [=========================>....] - ETA: 0s - loss: 0.5801 - acc: 0.7005
1283/1283 [==============================] - 1s 554us/step - loss: 0.5758 - acc: 0.7038 - val_loss: 0.6983 - val_acc: 0.5764

Epoch 00004: val_acc did not improve
Epoch 5/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5250 - acc: 0.7812
 192/1283 [===>..........................] - ETA: 0s - loss: 0.5361 - acc: 0.7552
 384/1283 [=======>......................] - ETA: 0s - loss: 0.5705 - acc: 0.7005
 512/1283 [==========>...................] - ETA: 0s - loss: 0.5746 - acc: 0.6934
 640/1283 [=============>................] - ETA: 0s - loss: 0.5678 - acc: 0.7078
 768/1283 [================>.............] - ETA: 0s - loss: 0.5608 - acc: 0.7148
 896/1283 [===================>..........] - ETA: 0s - loss: 0.5596 - acc: 0.7143
 960/1283 [=====================>........] - ETA: 0s - loss: 0.5600 - acc: 0.7146
1152/1283 [=========================>....] - ETA: 0s - loss: 0.5549 - acc: 0.7231
1283/1283 [==============================] - 1s 691us/step - loss: 0.5511 - acc: 0.7249 - val_loss: 0.7278 - val_acc: 0.5983

Epoch 00005: val_acc improved from 0.58952 to 0.59825, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20.ckpt
Epoch 6/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5371 - acc: 0.7656
 256/1283 [====>.........................] - ETA: 0s - loss: 0.5332 - acc: 0.7539
 320/1283 [======>.......................] - ETA: 0s - loss: 0.5257 - acc: 0.7562
 448/1283 [=========>....................] - ETA: 0s - loss: 0.5244 - acc: 0.7589
 512/1283 [==========>...................] - ETA: 0s - loss: 0.5196 - acc: 0.7637
 576/1283 [============>.................] - ETA: 0s - loss: 0.5155 - acc: 0.7656
 640/1283 [=============>................] - ETA: 0s - loss: 0.5109 - acc: 0.7688
 768/1283 [================>.............] - ETA: 0s - loss: 0.5101 - acc: 0.7656
 896/1283 [===================>..........] - ETA: 0s - loss: 0.5048 - acc: 0.7712
1088/1283 [========================>.....] - ETA: 0s - loss: 0.5133 - acc: 0.7555
1216/1283 [===========================>..] - ETA: 0s - loss: 0.5133 - acc: 0.7549
1283/1283 [==============================] - 1s 697us/step - loss: 0.5155 - acc: 0.7545 - val_loss: 0.7365 - val_acc: 0.5983

Epoch 00006: val_acc improved from 0.59825 to 0.59825, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20.ckpt
Epoch 7/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.6088 - acc: 0.6094
 192/1283 [===>..........................] - ETA: 0s - loss: 0.5215 - acc: 0.7344
 320/1283 [======>.......................] - ETA: 0s - loss: 0.5113 - acc: 0.7594
 448/1283 [=========>....................] - ETA: 0s - loss: 0.5286 - acc: 0.7411
 576/1283 [============>.................] - ETA: 0s - loss: 0.5224 - acc: 0.7448
 640/1283 [=============>................] - ETA: 0s - loss: 0.5108 - acc: 0.7531
 704/1283 [===============>..............] - ETA: 0s - loss: 0.5068 - acc: 0.7585
 768/1283 [================>.............] - ETA: 0s - loss: 0.5000 - acc: 0.7695
 896/1283 [===================>..........] - ETA: 0s - loss: 0.5008 - acc: 0.7701
1024/1283 [======================>.......] - ETA: 0s - loss: 0.4961 - acc: 0.7764
1216/1283 [===========================>..] - ETA: 0s - loss: 0.4922 - acc: 0.7771
1283/1283 [==============================] - 1s 734us/step - loss: 0.4932 - acc: 0.7740 - val_loss: 0.7414 - val_acc: 0.5895

Epoch 00007: val_acc did not improve
Epoch 8/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.4625 - acc: 0.7656
 256/1283 [====>.........................] - ETA: 0s - loss: 0.4681 - acc: 0.7734
 448/1283 [=========>....................] - ETA: 0s - loss: 0.4629 - acc: 0.7812
 576/1283 [============>.................] - ETA: 0s - loss: 0.4499 - acc: 0.7934
 704/1283 [===============>..............] - ETA: 0s - loss: 0.4509 - acc: 0.7884
 832/1283 [==================>...........] - ETA: 0s - loss: 0.4488 - acc: 0.7957
 960/1283 [=====================>........] - ETA: 0s - loss: 0.4473 - acc: 0.7958
1088/1283 [========================>.....] - ETA: 0s - loss: 0.4474 - acc: 0.7987
1216/1283 [===========================>..] - ETA: 0s - loss: 0.4495 - acc: 0.8002
1280/1283 [============================>.] - ETA: 0s - loss: 0.4480 - acc: 0.8016
1283/1283 [==============================] - 1s 706us/step - loss: 0.4478 - acc: 0.8020 - val_loss: 0.7353 - val_acc: 0.5983

Epoch 00008: val_acc did not improve
Epoch 9/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.3677 - acc: 0.8281
 192/1283 [===>..........................] - ETA: 0s - loss: 0.4137 - acc: 0.8125
 384/1283 [=======>......................] - ETA: 0s - loss: 0.4101 - acc: 0.8099
 512/1283 [==========>...................] - ETA: 0s - loss: 0.3987 - acc: 0.8262
 576/1283 [============>.................] - ETA: 0s - loss: 0.4045 - acc: 0.8160
 704/1283 [===============>..............] - ETA: 0s - loss: 0.4036 - acc: 0.8239
 832/1283 [==================>...........] - ETA: 0s - loss: 0.4151 - acc: 0.8209
 960/1283 [=====================>........] - ETA: 0s - loss: 0.4084 - acc: 0.8229
1088/1283 [========================>.....] - ETA: 0s - loss: 0.4173 - acc: 0.8180
1216/1283 [===========================>..] - ETA: 0s - loss: 0.4195 - acc: 0.8191
1280/1283 [============================>.] - ETA: 0s - loss: 0.4194 - acc: 0.8195
1283/1283 [==============================] - 1s 755us/step - loss: 0.4196 - acc: 0.8192 - val_loss: 0.7456 - val_acc: 0.5721

Epoch 00009: val_acc did not improve
Epoch 10/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.3435 - acc: 0.8750
 192/1283 [===>..........................] - ETA: 0s - loss: 0.3848 - acc: 0.8438
 384/1283 [=======>......................] - ETA: 0s - loss: 0.3897 - acc: 0.8464
 576/1283 [============>.................] - ETA: 0s - loss: 0.3963 - acc: 0.8333
 768/1283 [================>.............] - ETA: 0s - loss: 0.3942 - acc: 0.8398
 832/1283 [==================>...........] - ETA: 0s - loss: 0.4019 - acc: 0.8305
 896/1283 [===================>..........] - ETA: 0s - loss: 0.3991 - acc: 0.8315
 960/1283 [=====================>........] - ETA: 0s - loss: 0.4022 - acc: 0.8240
1088/1283 [========================>.....] - ETA: 0s - loss: 0.3998 - acc: 0.8272
1216/1283 [===========================>..] - ETA: 0s - loss: 0.3991 - acc: 0.8281
1283/1283 [==============================] - 1s 725us/step - loss: 0.3995 - acc: 0.8277 - val_loss: 0.7696 - val_acc: 0.5764

Epoch 00010: val_acc did not improve
Epoch 11/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.2919 - acc: 0.9219
 192/1283 [===>..........................] - ETA: 0s - loss: 0.3106 - acc: 0.8906
 320/1283 [======>.......................] - ETA: 0s - loss: 0.3388 - acc: 0.8656
 384/1283 [=======>......................] - ETA: 0s - loss: 0.3367 - acc: 0.8698
 512/1283 [==========>...................] - ETA: 0s - loss: 0.3394 - acc: 0.8691
 640/1283 [=============>................] - ETA: 0s - loss: 0.3425 - acc: 0.8625
 704/1283 [===============>..............] - ETA: 0s - loss: 0.3506 - acc: 0.8551
 768/1283 [================>.............] - ETA: 0s - loss: 0.3501 - acc: 0.8555
 832/1283 [==================>...........] - ETA: 0s - loss: 0.3538 - acc: 0.8522
 896/1283 [===================>..........] - ETA: 0s - loss: 0.3534 - acc: 0.8549
1024/1283 [======================>.......] - ETA: 0s - loss: 0.3537 - acc: 0.8535
1152/1283 [=========================>....] - ETA: 0s - loss: 0.3589 - acc: 0.8490
1280/1283 [============================>.] - ETA: 0s - loss: 0.3577 - acc: 0.8523
1283/1283 [==============================] - 1s 720us/step - loss: 0.3576 - acc: 0.8527 - val_loss: 0.8352 - val_acc: 0.5895

Epoch 00011: val_acc did not improve
Epoch 12/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.2987 - acc: 0.8906
 256/1283 [====>.........................] - ETA: 0s - loss: 0.3525 - acc: 0.8477
 384/1283 [=======>......................] - ETA: 0s - loss: 0.3442 - acc: 0.8568
 448/1283 [=========>....................] - ETA: 0s - loss: 0.3500 - acc: 0.8616
 576/1283 [============>.................] - ETA: 0s - loss: 0.3642 - acc: 0.8559
 704/1283 [===============>..............] - ETA: 0s - loss: 0.3585 - acc: 0.8608
 832/1283 [==================>...........] - ETA: 0s - loss: 0.3603 - acc: 0.8534
 896/1283 [===================>..........] - ETA: 0s - loss: 0.3595 - acc: 0.8516
1088/1283 [========================>.....] - ETA: 0s - loss: 0.3577 - acc: 0.8511
1216/1283 [===========================>..] - ETA: 0s - loss: 0.3563 - acc: 0.8544
1280/1283 [============================>.] - ETA: 0s - loss: 0.3549 - acc: 0.8562
1283/1283 [==============================] - 1s 643us/step - loss: 0.3550 - acc: 0.8566 - val_loss: 0.8356 - val_acc: 0.5808

Epoch 00012: val_acc did not improve
Epoch 13/100

  64/1283 [>.............................] - ETA: 1s - loss: 0.3250 - acc: 0.8438
 192/1283 [===>..........................] - ETA: 1s - loss: 0.3137 - acc: 0.8854
 320/1283 [======>.......................] - ETA: 0s - loss: 0.3144 - acc: 0.8812
 448/1283 [=========>....................] - ETA: 0s - loss: 0.3082 - acc: 0.8795
 640/1283 [=============>................] - ETA: 0s - loss: 0.3247 - acc: 0.8656
 768/1283 [================>.............] - ETA: 0s - loss: 0.3190 - acc: 0.8646
 896/1283 [===================>..........] - ETA: 0s - loss: 0.3185 - acc: 0.8661
1024/1283 [======================>.......] - ETA: 0s - loss: 0.3205 - acc: 0.8633
1088/1283 [========================>.....] - ETA: 0s - loss: 0.3219 - acc: 0.8631
1216/1283 [===========================>..] - ETA: 0s - loss: 0.3197 - acc: 0.8676
1283/1283 [==============================] - 1s 747us/step - loss: 0.3216 - acc: 0.8636 - val_loss: 0.9322 - val_acc: 0.5895

Epoch 00013: val_acc did not improve
Epoch 14/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.3044 - acc: 0.8594
 192/1283 [===>..........................] - ETA: 0s - loss: 0.3837 - acc: 0.7969
 256/1283 [====>.........................] - ETA: 0s - loss: 0.4031 - acc: 0.7891
 320/1283 [======>.......................] - ETA: 0s - loss: 0.3849 - acc: 0.8125
 448/1283 [=========>....................] - ETA: 0s - loss: 0.3707 - acc: 0.8259
 576/1283 [============>.................] - ETA: 0s - loss: 0.3898 - acc: 0.8142
 640/1283 [=============>................] - ETA: 0s - loss: 0.3823 - acc: 0.8234
 704/1283 [===============>..............] - ETA: 0s - loss: 0.3802 - acc: 0.8224
 832/1283 [==================>...........] - ETA: 0s - loss: 0.3755 - acc: 0.8257
 960/1283 [=====================>........] - ETA: 0s - loss: 0.3743 - acc: 0.8229
1088/1283 [========================>.....] - ETA: 0s - loss: 0.3795 - acc: 0.8180
1216/1283 [===========================>..] - ETA: 0s - loss: 0.3738 - acc: 0.8257
1280/1283 [============================>.] - ETA: 0s - loss: 0.3754 - acc: 0.8227
1283/1283 [==============================] - 1s 945us/step - loss: 0.3763 - acc: 0.8223 - val_loss: 0.8453 - val_acc: 0.5459

Epoch 00014: val_acc did not improve
Epoch 15/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.2788 - acc: 0.9219
 128/1283 [=>............................] - ETA: 1s - loss: 0.2725 - acc: 0.8828
 192/1283 [===>..........................] - ETA: 1s - loss: 0.2707 - acc: 0.8854
 384/1283 [=======>......................] - ETA: 0s - loss: 0.3304 - acc: 0.8385
 448/1283 [=========>....................] - ETA: 0s - loss: 0.3225 - acc: 0.8482
 512/1283 [==========>...................] - ETA: 0s - loss: 0.3175 - acc: 0.8594
 640/1283 [=============>................] - ETA: 0s - loss: 0.3183 - acc: 0.8594
 768/1283 [================>.............] - ETA: 0s - loss: 0.3206 - acc: 0.8620
 896/1283 [===================>..........] - ETA: 0s - loss: 0.3163 - acc: 0.8683
1024/1283 [======================>.......] - ETA: 0s - loss: 0.3125 - acc: 0.8682
1152/1283 [=========================>....] - ETA: 0s - loss: 0.3136 - acc: 0.8707
1280/1283 [============================>.] - ETA: 0s - loss: 0.3132 - acc: 0.8688
1283/1283 [==============================] - 1s 747us/step - loss: 0.3129 - acc: 0.8691 - val_loss: 0.8361 - val_acc: 0.5939

Epoch 00015: val_acc did not improve
Epoch 16/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.2474 - acc: 0.9219
 128/1283 [=>............................] - ETA: 2s - loss: 0.2520 - acc: 0.9141
 256/1283 [====>.........................] - ETA: 1s - loss: 0.2542 - acc: 0.9141
 384/1283 [=======>......................] - ETA: 1s - loss: 0.2476 - acc: 0.9219
 512/1283 [==========>...................] - ETA: 0s - loss: 0.2553 - acc: 0.9121
 640/1283 [=============>................] - ETA: 0s - loss: 0.2594 - acc: 0.9094
 768/1283 [================>.............] - ETA: 0s - loss: 0.2543 - acc: 0.9102
 960/1283 [=====================>........] - ETA: 0s - loss: 0.2506 - acc: 0.9125
1152/1283 [=========================>....] - ETA: 0s - loss: 0.2494 - acc: 0.9106
1280/1283 [============================>.] - ETA: 0s - loss: 0.2480 - acc: 0.9109
1283/1283 [==============================] - 1s 758us/step - loss: 0.2477 - acc: 0.9111 - val_loss: 0.8904 - val_acc: 0.5852

Epoch 00016: val_acc did not improve
Epoch 00016: early stopping
batch_size=64
batch_norm=False
dropout_rate=0.2
n_layers=1
max_len=20
nodes=100
mode=A
PCA audio=30
PCA visual=10
PCA text=100
accuracy=0.5131195335276968
best_valid_accuracy=0.48104956268221577
/afs/inf.ed.ac.uk/user/s17/s1738075/.local/lib/python2.7/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
pca_early_fusion_cnn.py:146: RuntimeWarning: invalid value encountered in divide
  train_set_audio = train_set_audio / audio_max
pca_early_fusion_cnn.py:148: RuntimeWarning: invalid value encountered in divide
  test_set_audio = test_set_audio / audio_max
2018-03-28 21:54:51.076497: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
This API will be deprecated in the future versions. Please check the Github page for the current API

Modality facet for video 8qrpnFRGt2A segment 13 is (partially) missing and is thus being replaced by zeros!

Train on 1283 samples, validate on 229 samples
Epoch 1/100

  64/1283 [>.............................] - ETA: 2s - loss: 0.8257 - acc: 0.4219
 320/1283 [======>.......................] - ETA: 0s - loss: 0.7903 - acc: 0.5031
 512/1283 [==========>...................] - ETA: 0s - loss: 0.7625 - acc: 0.5117
 576/1283 [============>.................] - ETA: 0s - loss: 0.7721 - acc: 0.5087
 896/1283 [===================>..........] - ETA: 0s - loss: 0.7478 - acc: 0.5279
1152/1283 [=========================>....] - ETA: 0s - loss: 0.7361 - acc: 0.5408
1283/1283 [==============================] - 1s 684us/step - loss: 0.7338 - acc: 0.5378 - val_loss: 0.6830 - val_acc: 0.5721

Epoch 00001: val_acc improved from -inf to 0.57205, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20.ckpt
Epoch 2/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.6785 - acc: 0.5156
 384/1283 [=======>......................] - ETA: 0s - loss: 0.6582 - acc: 0.6120
 640/1283 [=============>................] - ETA: 0s - loss: 0.6582 - acc: 0.6031
 832/1283 [==================>...........] - ETA: 0s - loss: 0.6521 - acc: 0.6154
1024/1283 [======================>.......] - ETA: 0s - loss: 0.6576 - acc: 0.6113
1280/1283 [============================>.] - ETA: 0s - loss: 0.6526 - acc: 0.6227
1283/1283 [==============================] - 0s 310us/step - loss: 0.6527 - acc: 0.6228 - val_loss: 0.6870 - val_acc: 0.5459

Epoch 00002: val_acc did not improve
Epoch 3/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.6247 - acc: 0.6406
 256/1283 [====>.........................] - ETA: 0s - loss: 0.6209 - acc: 0.6602
 512/1283 [==========>...................] - ETA: 0s - loss: 0.6114 - acc: 0.6738
 768/1283 [================>.............] - ETA: 0s - loss: 0.6042 - acc: 0.6875
1024/1283 [======================>.......] - ETA: 0s - loss: 0.6141 - acc: 0.6758
1283/1283 [==============================] - 0s 255us/step - loss: 0.6200 - acc: 0.6610 - val_loss: 0.7174 - val_acc: 0.5502

Epoch 00003: val_acc did not improve
Epoch 4/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.6411 - acc: 0.5938
 384/1283 [=======>......................] - ETA: 0s - loss: 0.5876 - acc: 0.6823
 704/1283 [===============>..............] - ETA: 0s - loss: 0.5841 - acc: 0.6932
1024/1283 [======================>.......] - ETA: 0s - loss: 0.5808 - acc: 0.6973
1283/1283 [==============================] - 0s 194us/step - loss: 0.5834 - acc: 0.6968 - val_loss: 0.6932 - val_acc: 0.5590

Epoch 00004: val_acc did not improve
Epoch 5/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5421 - acc: 0.7188
 384/1283 [=======>......................] - ETA: 0s - loss: 0.5482 - acc: 0.7188
 704/1283 [===============>..............] - ETA: 0s - loss: 0.5557 - acc: 0.7259
1024/1283 [======================>.......] - ETA: 0s - loss: 0.5538 - acc: 0.7305
1280/1283 [============================>.] - ETA: 0s - loss: 0.5504 - acc: 0.7359
1283/1283 [==============================] - 0s 207us/step - loss: 0.5506 - acc: 0.7358 - val_loss: 0.7444 - val_acc: 0.5590

Epoch 00005: val_acc did not improve
Epoch 6/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5300 - acc: 0.7031
 320/1283 [======>.......................] - ETA: 0s - loss: 0.5517 - acc: 0.6719
 576/1283 [============>.................] - ETA: 0s - loss: 0.5279 - acc: 0.7135
 832/1283 [==================>...........] - ETA: 0s - loss: 0.5296 - acc: 0.7248
1088/1283 [========================>.....] - ETA: 0s - loss: 0.5188 - acc: 0.7426
1283/1283 [==============================] - 0s 237us/step - loss: 0.5166 - acc: 0.7443 - val_loss: 0.7471 - val_acc: 0.6026

Epoch 00006: val_acc improved from 0.57205 to 0.60262, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20.ckpt
Epoch 7/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5233 - acc: 0.7344
 320/1283 [======>.......................] - ETA: 0s - loss: 0.4956 - acc: 0.7469
 576/1283 [============>.................] - ETA: 0s - loss: 0.4895 - acc: 0.7639
 896/1283 [===================>..........] - ETA: 0s - loss: 0.4825 - acc: 0.7790
1216/1283 [===========================>..] - ETA: 0s - loss: 0.4857 - acc: 0.7689
1283/1283 [==============================] - 0s 233us/step - loss: 0.4872 - acc: 0.7677 - val_loss: 0.7255 - val_acc: 0.5983

Epoch 00007: val_acc did not improve
Epoch 8/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.4383 - acc: 0.8438
 320/1283 [======>.......................] - ETA: 0s - loss: 0.4502 - acc: 0.8031
 576/1283 [============>.................] - ETA: 0s - loss: 0.4582 - acc: 0.8038
 768/1283 [================>.............] - ETA: 0s - loss: 0.4448 - acc: 0.8086
1088/1283 [========================>.....] - ETA: 0s - loss: 0.4354 - acc: 0.8171
1283/1283 [==============================] - 0s 225us/step - loss: 0.4424 - acc: 0.8114 - val_loss: 0.7324 - val_acc: 0.5939

Epoch 00008: val_acc did not improve
Epoch 9/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.3648 - acc: 0.9062
 384/1283 [=======>......................] - ETA: 0s - loss: 0.4119 - acc: 0.8333
 704/1283 [===============>..............] - ETA: 0s - loss: 0.4171 - acc: 0.8224
 896/1283 [===================>..........] - ETA: 0s - loss: 0.4146 - acc: 0.8248
1216/1283 [===========================>..] - ETA: 0s - loss: 0.4097 - acc: 0.8273
1283/1283 [==============================] - 0s 212us/step - loss: 0.4085 - acc: 0.8277 - val_loss: 0.7700 - val_acc: 0.5415

Epoch 00009: val_acc did not improve
Epoch 10/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.3661 - acc: 0.9219
 384/1283 [=======>......................] - ETA: 0s - loss: 0.3856 - acc: 0.8568
 704/1283 [===============>..............] - ETA: 0s - loss: 0.3781 - acc: 0.8565
1024/1283 [======================>.......] - ETA: 0s - loss: 0.3957 - acc: 0.8359
1152/1283 [=========================>....] - ETA: 0s - loss: 0.3902 - acc: 0.8377
1280/1283 [============================>.] - ETA: 0s - loss: 0.3883 - acc: 0.8383
1283/1283 [==============================] - 0s 268us/step - loss: 0.3883 - acc: 0.8387 - val_loss: 0.7592 - val_acc: 0.5808

Epoch 00010: val_acc did not improve
Epoch 11/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.3088 - acc: 0.9219
 384/1283 [=======>......................] - ETA: 0s - loss: 0.3367 - acc: 0.8724
 640/1283 [=============>................] - ETA: 0s - loss: 0.3306 - acc: 0.8844
 896/1283 [===================>..........] - ETA: 0s - loss: 0.3314 - acc: 0.8850
1216/1283 [===========================>..] - ETA: 0s - loss: 0.3296 - acc: 0.8882
1283/1283 [==============================] - 0s 226us/step - loss: 0.3296 - acc: 0.8854 - val_loss: 0.8017 - val_acc: 0.5852

Epoch 00011: val_acc did not improve
Epoch 12/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.3446 - acc: 0.8906
 320/1283 [======>.......................] - ETA: 0s - loss: 0.3174 - acc: 0.8938
 640/1283 [=============>................] - ETA: 0s - loss: 0.3073 - acc: 0.8938
 896/1283 [===================>..........] - ETA: 0s - loss: 0.2908 - acc: 0.9074
1216/1283 [===========================>..] - ETA: 0s - loss: 0.2887 - acc: 0.9095
1283/1283 [==============================] - 0s 226us/step - loss: 0.2889 - acc: 0.9104 - val_loss: 0.8559 - val_acc: 0.5764

Epoch 00012: val_acc did not improve
Epoch 13/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.3217 - acc: 0.8438
 320/1283 [======>.......................] - ETA: 0s - loss: 0.2895 - acc: 0.8844
 640/1283 [=============>................] - ETA: 0s - loss: 0.2822 - acc: 0.8969
 960/1283 [=====================>........] - ETA: 0s - loss: 0.2797 - acc: 0.8990
1216/1283 [===========================>..] - ETA: 0s - loss: 0.2757 - acc: 0.9038
1283/1283 [==============================] - 0s 224us/step - loss: 0.2747 - acc: 0.9034 - val_loss: 0.8257 - val_acc: 0.6070

Epoch 00013: val_acc improved from 0.60262 to 0.60699, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20.ckpt
Epoch 14/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.2195 - acc: 0.9531
 320/1283 [======>.......................] - ETA: 0s - loss: 0.2295 - acc: 0.9625
 512/1283 [==========>...................] - ETA: 0s - loss: 0.2186 - acc: 0.9629
 704/1283 [===============>..............] - ETA: 0s - loss: 0.2208 - acc: 0.9560
 960/1283 [=====================>........] - ETA: 0s - loss: 0.2242 - acc: 0.9490
1152/1283 [=========================>....] - ETA: 0s - loss: 0.2275 - acc: 0.9444
1283/1283 [==============================] - 0s 291us/step - loss: 0.2331 - acc: 0.9384 - val_loss: 0.9126 - val_acc: 0.5590

Epoch 00014: val_acc did not improve
Epoch 15/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1815 - acc: 0.9531
 256/1283 [====>.........................] - ETA: 0s - loss: 0.2297 - acc: 0.9258
 448/1283 [=========>....................] - ETA: 0s - loss: 0.2269 - acc: 0.9286
 768/1283 [================>.............] - ETA: 0s - loss: 0.2428 - acc: 0.9089
 960/1283 [=====================>........] - ETA: 0s - loss: 0.2576 - acc: 0.9021
1216/1283 [===========================>..] - ETA: 0s - loss: 0.2627 - acc: 0.8980
1283/1283 [==============================] - 0s 288us/step - loss: 0.2630 - acc: 0.8987 - val_loss: 0.9547 - val_acc: 0.5939

Epoch 00015: val_acc did not improve
Epoch 16/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1802 - acc: 0.9375
 320/1283 [======>.......................] - ETA: 0s - loss: 0.2235 - acc: 0.9219
 640/1283 [=============>................] - ETA: 0s - loss: 0.2053 - acc: 0.9391
 960/1283 [=====================>........] - ETA: 0s - loss: 0.2062 - acc: 0.9344
1152/1283 [=========================>....] - ETA: 0s - loss: 0.2000 - acc: 0.9410
1283/1283 [==============================] - 0s 288us/step - loss: 0.1953 - acc: 0.9439 - val_loss: 1.0105 - val_acc: 0.5415

Epoch 00016: val_acc did not improve
Epoch 17/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1925 - acc: 0.9531
 320/1283 [======>.......................] - ETA: 0s - loss: 0.1788 - acc: 0.9594
 576/1283 [============>.................] - ETA: 0s - loss: 0.1617 - acc: 0.9688
 832/1283 [==================>...........] - ETA: 0s - loss: 0.1631 - acc: 0.9675
1152/1283 [=========================>....] - ETA: 0s - loss: 0.1580 - acc: 0.9670
1283/1283 [==============================] - 0s 230us/step - loss: 0.1556 - acc: 0.9665 - val_loss: 1.0728 - val_acc: 0.5328

Epoch 00017: val_acc did not improve
Epoch 18/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1158 - acc: 1.0000
 384/1283 [=======>......................] - ETA: 0s - loss: 0.1974 - acc: 0.9427
 704/1283 [===============>..............] - ETA: 0s - loss: 0.1840 - acc: 0.9474
 960/1283 [=====================>........] - ETA: 0s - loss: 0.1780 - acc: 0.9490
1216/1283 [===========================>..] - ETA: 0s - loss: 0.1814 - acc: 0.9474
1283/1283 [==============================] - 0s 254us/step - loss: 0.1773 - acc: 0.9501 - val_loss: 1.0897 - val_acc: 0.5852

Epoch 00018: val_acc did not improve
Epoch 19/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1302 - acc: 0.9531
 384/1283 [=======>......................] - ETA: 0s - loss: 0.1427 - acc: 0.9609
 704/1283 [===============>..............] - ETA: 0s - loss: 0.1493 - acc: 0.9631
 960/1283 [=====================>........] - ETA: 0s - loss: 0.1498 - acc: 0.9625
1152/1283 [=========================>....] - ETA: 0s - loss: 0.1438 - acc: 0.9670
1283/1283 [==============================] - 0s 243us/step - loss: 0.1397 - acc: 0.9673 - val_loss: 1.0518 - val_acc: 0.5590

Epoch 00019: val_acc did not improve
Epoch 20/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0799 - acc: 1.0000
 384/1283 [=======>......................] - ETA: 0s - loss: 0.1052 - acc: 0.9922
 576/1283 [============>.................] - ETA: 0s - loss: 0.1067 - acc: 0.9861
 832/1283 [==================>...........] - ETA: 0s - loss: 0.1087 - acc: 0.9808
1088/1283 [========================>.....] - ETA: 0s - loss: 0.1041 - acc: 0.9807
1283/1283 [==============================] - 0s 230us/step - loss: 0.1030 - acc: 0.9821 - val_loss: 1.1762 - val_acc: 0.5502

Epoch 00020: val_acc did not improve
Epoch 21/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0734 - acc: 0.9844
 320/1283 [======>.......................] - ETA: 0s - loss: 0.0921 - acc: 0.9812
 512/1283 [==========>...................] - ETA: 0s - loss: 0.0919 - acc: 0.9785
 768/1283 [================>.............] - ETA: 0s - loss: 0.0929 - acc: 0.9792
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0887 - acc: 0.9834
1283/1283 [==============================] - 0s 255us/step - loss: 0.0861 - acc: 0.9860 - val_loss: 1.2240 - val_acc: 0.5590

Epoch 00021: val_acc did not improve
Epoch 22/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0871 - acc: 1.0000
 256/1283 [====>.........................] - ETA: 0s - loss: 0.0654 - acc: 0.9922
 512/1283 [==========>...................] - ETA: 0s - loss: 0.0731 - acc: 0.9883
 768/1283 [================>.............] - ETA: 0s - loss: 0.0777 - acc: 0.9870
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0776 - acc: 0.9875
1152/1283 [=========================>....] - ETA: 0s - loss: 0.0787 - acc: 0.9870
1283/1283 [==============================] - 0s 299us/step - loss: 0.0796 - acc: 0.9875 - val_loss: 1.2743 - val_acc: 0.5546

Epoch 00022: val_acc did not improve
Epoch 23/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0620 - acc: 1.0000
 384/1283 [=======>......................] - ETA: 0s - loss: 0.0693 - acc: 0.9870
 640/1283 [=============>................] - ETA: 0s - loss: 0.0658 - acc: 0.9906
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0636 - acc: 0.9928
 896/1283 [===================>..........] - ETA: 0s - loss: 0.0665 - acc: 0.9911
1152/1283 [=========================>....] - ETA: 0s - loss: 0.0639 - acc: 0.9922
1283/1283 [==============================] - 0s 308us/step - loss: 0.0646 - acc: 0.9930 - val_loss: 1.2704 - val_acc: 0.5459

Epoch 00023: val_acc did not improve
Epoch 00023: early stopping
batch_size=64
batch_norm=False
dropout_rate=0.2
n_layers=1
max_len=20
nodes=100
mode=A
PCA audio=30
PCA visual=15
PCA text=100
accuracy=0.5408163265306123
best_valid_accuracy=0.5495626822157434
/afs/inf.ed.ac.uk/user/s17/s1738075/.local/lib/python2.7/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
pca_early_fusion_cnn.py:146: RuntimeWarning: invalid value encountered in divide
  train_set_audio = train_set_audio / audio_max
pca_early_fusion_cnn.py:148: RuntimeWarning: invalid value encountered in divide
  test_set_audio = test_set_audio / audio_max
2018-03-28 22:09:14.029388: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
This API will be deprecated in the future versions. Please check the Github page for the current API

Modality facet for video 8qrpnFRGt2A segment 13 is (partially) missing and is thus being replaced by zeros!

Train on 1283 samples, validate on 229 samples
Epoch 1/100

  64/1283 [>.............................] - ETA: 5s - loss: 0.7398 - acc: 0.4531
 256/1283 [====>.........................] - ETA: 1s - loss: 0.7308 - acc: 0.5234
 384/1283 [=======>......................] - ETA: 0s - loss: 0.7314 - acc: 0.5286
 512/1283 [==========>...................] - ETA: 0s - loss: 0.7202 - acc: 0.5410
 640/1283 [=============>................] - ETA: 0s - loss: 0.7347 - acc: 0.5219
 768/1283 [================>.............] - ETA: 0s - loss: 0.7264 - acc: 0.5247
 896/1283 [===================>..........] - ETA: 0s - loss: 0.7191 - acc: 0.5379
1024/1283 [======================>.......] - ETA: 0s - loss: 0.7232 - acc: 0.5410
1088/1283 [========================>.....] - ETA: 0s - loss: 0.7250 - acc: 0.5404
1216/1283 [===========================>..] - ETA: 0s - loss: 0.7209 - acc: 0.5469
1283/1283 [==============================] - 1s 905us/step - loss: 0.7189 - acc: 0.5472 - val_loss: 0.7030 - val_acc: 0.5415

Epoch 00001: val_acc improved from -inf to 0.54148, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20.ckpt
Epoch 2/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.6283 - acc: 0.6719
 192/1283 [===>..........................] - ETA: 0s - loss: 0.6386 - acc: 0.6250
 320/1283 [======>.......................] - ETA: 0s - loss: 0.6372 - acc: 0.6094
 448/1283 [=========>....................] - ETA: 0s - loss: 0.6358 - acc: 0.6138
 576/1283 [============>.................] - ETA: 0s - loss: 0.6329 - acc: 0.6198
 704/1283 [===============>..............] - ETA: 0s - loss: 0.6395 - acc: 0.6122
 832/1283 [==================>...........] - ETA: 0s - loss: 0.6353 - acc: 0.6226
1024/1283 [======================>.......] - ETA: 0s - loss: 0.6308 - acc: 0.6309
1088/1283 [========================>.....] - ETA: 0s - loss: 0.6288 - acc: 0.6388
1216/1283 [===========================>..] - ETA: 0s - loss: 0.6289 - acc: 0.6431
1283/1283 [==============================] - 1s 722us/step - loss: 0.6286 - acc: 0.6438 - val_loss: 0.7052 - val_acc: 0.5328

Epoch 00002: val_acc did not improve
Epoch 3/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5369 - acc: 0.7500
 128/1283 [=>............................] - ETA: 0s - loss: 0.5157 - acc: 0.7891
 256/1283 [====>.........................] - ETA: 0s - loss: 0.5428 - acc: 0.7656
 384/1283 [=======>......................] - ETA: 0s - loss: 0.5392 - acc: 0.7682
 512/1283 [==========>...................] - ETA: 0s - loss: 0.5472 - acc: 0.7461
 640/1283 [=============>................] - ETA: 0s - loss: 0.5523 - acc: 0.7422
 704/1283 [===============>..............] - ETA: 0s - loss: 0.5544 - acc: 0.7415
 768/1283 [================>.............] - ETA: 0s - loss: 0.5551 - acc: 0.7422
 832/1283 [==================>...........] - ETA: 0s - loss: 0.5579 - acc: 0.7344
 960/1283 [=====================>........] - ETA: 0s - loss: 0.5607 - acc: 0.7292
1088/1283 [========================>.....] - ETA: 0s - loss: 0.5616 - acc: 0.7307
1216/1283 [===========================>..] - ETA: 0s - loss: 0.5690 - acc: 0.7237
1283/1283 [==============================] - 1s 827us/step - loss: 0.5684 - acc: 0.7233 - val_loss: 0.7158 - val_acc: 0.5590

Epoch 00003: val_acc improved from 0.54148 to 0.55895, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20.ckpt
Epoch 4/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5849 - acc: 0.6562
 192/1283 [===>..........................] - ETA: 0s - loss: 0.5379 - acc: 0.7135
 320/1283 [======>.......................] - ETA: 0s - loss: 0.5325 - acc: 0.7250
 448/1283 [=========>....................] - ETA: 0s - loss: 0.5249 - acc: 0.7455
 640/1283 [=============>................] - ETA: 0s - loss: 0.5264 - acc: 0.7500
 768/1283 [================>.............] - ETA: 0s - loss: 0.5218 - acc: 0.7578
 896/1283 [===================>..........] - ETA: 0s - loss: 0.5216 - acc: 0.7556
1024/1283 [======================>.......] - ETA: 0s - loss: 0.5243 - acc: 0.7529
1088/1283 [========================>.....] - ETA: 0s - loss: 0.5205 - acc: 0.7555
1216/1283 [===========================>..] - ETA: 0s - loss: 0.5201 - acc: 0.7582
1283/1283 [==============================] - 1s 650us/step - loss: 0.5190 - acc: 0.7615 - val_loss: 0.7295 - val_acc: 0.5284

Epoch 00004: val_acc did not improve
Epoch 5/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.4303 - acc: 0.8281
 128/1283 [=>............................] - ETA: 0s - loss: 0.4421 - acc: 0.8281
 256/1283 [====>.........................] - ETA: 0s - loss: 0.4717 - acc: 0.7930
 320/1283 [======>.......................] - ETA: 0s - loss: 0.4686 - acc: 0.8031
 448/1283 [=========>....................] - ETA: 0s - loss: 0.4687 - acc: 0.8013
 512/1283 [==========>...................] - ETA: 0s - loss: 0.4769 - acc: 0.7891
 640/1283 [=============>................] - ETA: 0s - loss: 0.4840 - acc: 0.7844
 768/1283 [================>.............] - ETA: 0s - loss: 0.4876 - acc: 0.7760
 896/1283 [===================>..........] - ETA: 0s - loss: 0.4798 - acc: 0.7835
1024/1283 [======================>.......] - ETA: 0s - loss: 0.4806 - acc: 0.7852
1216/1283 [===========================>..] - ETA: 0s - loss: 0.4760 - acc: 0.7911
1283/1283 [==============================] - 1s 606us/step - loss: 0.4775 - acc: 0.7903 - val_loss: 0.7462 - val_acc: 0.6026

Epoch 00005: val_acc improved from 0.55895 to 0.60262, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20.ckpt
Epoch 6/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.4861 - acc: 0.7500
 192/1283 [===>..........................] - ETA: 0s - loss: 0.4377 - acc: 0.7969
 320/1283 [======>.......................] - ETA: 0s - loss: 0.4323 - acc: 0.8219
 448/1283 [=========>....................] - ETA: 0s - loss: 0.4321 - acc: 0.8214
 512/1283 [==========>...................] - ETA: 0s - loss: 0.4285 - acc: 0.8262
 576/1283 [============>.................] - ETA: 0s - loss: 0.4319 - acc: 0.8229
 768/1283 [================>.............] - ETA: 0s - loss: 0.4437 - acc: 0.8112
 896/1283 [===================>..........] - ETA: 0s - loss: 0.4384 - acc: 0.8136
1088/1283 [========================>.....] - ETA: 0s - loss: 0.4325 - acc: 0.8263
1216/1283 [===========================>..] - ETA: 0s - loss: 0.4295 - acc: 0.8248
1283/1283 [==============================] - 1s 794us/step - loss: 0.4281 - acc: 0.8277 - val_loss: 0.7479 - val_acc: 0.5633

Epoch 00006: val_acc did not improve
Epoch 7/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.3540 - acc: 0.8906
 192/1283 [===>..........................] - ETA: 0s - loss: 0.3884 - acc: 0.8177
 320/1283 [======>.......................] - ETA: 0s - loss: 0.3919 - acc: 0.8125
 448/1283 [=========>....................] - ETA: 0s - loss: 0.3982 - acc: 0.8170
 576/1283 [============>.................] - ETA: 0s - loss: 0.4139 - acc: 0.8108
 704/1283 [===============>..............] - ETA: 0s - loss: 0.4031 - acc: 0.8253
 832/1283 [==================>...........] - ETA: 0s - loss: 0.3984 - acc: 0.8329
 960/1283 [=====================>........] - ETA: 0s - loss: 0.3888 - acc: 0.8427
1088/1283 [========================>.....] - ETA: 0s - loss: 0.3874 - acc: 0.8410
1216/1283 [===========================>..] - ETA: 0s - loss: 0.3871 - acc: 0.8429
1280/1283 [============================>.] - ETA: 0s - loss: 0.3872 - acc: 0.8422
1283/1283 [==============================] - 1s 678us/step - loss: 0.3873 - acc: 0.8426 - val_loss: 0.7735 - val_acc: 0.5633

Epoch 00007: val_acc did not improve
Epoch 8/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.3017 - acc: 0.9219
 192/1283 [===>..........................] - ETA: 0s - loss: 0.3147 - acc: 0.8906
 320/1283 [======>.......................] - ETA: 0s - loss: 0.3199 - acc: 0.8906
 448/1283 [=========>....................] - ETA: 0s - loss: 0.3277 - acc: 0.8750
 576/1283 [============>.................] - ETA: 0s - loss: 0.3341 - acc: 0.8767
 704/1283 [===============>..............] - ETA: 0s - loss: 0.3387 - acc: 0.8679
 832/1283 [==================>...........] - ETA: 0s - loss: 0.3371 - acc: 0.8714
 960/1283 [=====================>........] - ETA: 0s - loss: 0.3392 - acc: 0.8688
1088/1283 [========================>.....] - ETA: 0s - loss: 0.3347 - acc: 0.8722
1216/1283 [===========================>..] - ETA: 0s - loss: 0.3374 - acc: 0.8668
1283/1283 [==============================] - 1s 671us/step - loss: 0.3367 - acc: 0.8675 - val_loss: 0.7710 - val_acc: 0.6070

Epoch 00008: val_acc improved from 0.60262 to 0.60699, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20.ckpt
Epoch 9/100

  64/1283 [>.............................] - ETA: 1s - loss: 0.3417 - acc: 0.8594
 192/1283 [===>..........................] - ETA: 1s - loss: 0.2823 - acc: 0.9271
 320/1283 [======>.......................] - ETA: 0s - loss: 0.2728 - acc: 0.9250
 512/1283 [==========>...................] - ETA: 0s - loss: 0.2776 - acc: 0.9180
 640/1283 [=============>................] - ETA: 0s - loss: 0.2753 - acc: 0.9156
 832/1283 [==================>...........] - ETA: 0s - loss: 0.2741 - acc: 0.9159
 960/1283 [=====================>........] - ETA: 0s - loss: 0.2759 - acc: 0.9094
1152/1283 [=========================>....] - ETA: 0s - loss: 0.2781 - acc: 0.9062
1280/1283 [============================>.] - ETA: 0s - loss: 0.2797 - acc: 0.9039
1283/1283 [==============================] - 1s 696us/step - loss: 0.2810 - acc: 0.9034 - val_loss: 0.8418 - val_acc: 0.5633

Epoch 00009: val_acc did not improve
Epoch 10/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.2505 - acc: 0.9375
 128/1283 [=>............................] - ETA: 0s - loss: 0.2752 - acc: 0.9141
 192/1283 [===>..........................] - ETA: 1s - loss: 0.2888 - acc: 0.9062
 256/1283 [====>.........................] - ETA: 1s - loss: 0.2806 - acc: 0.9102
 384/1283 [=======>......................] - ETA: 0s - loss: 0.2909 - acc: 0.8880
 512/1283 [==========>...................] - ETA: 0s - loss: 0.2961 - acc: 0.8828
 640/1283 [=============>................] - ETA: 0s - loss: 0.2953 - acc: 0.8844
 768/1283 [================>.............] - ETA: 0s - loss: 0.2879 - acc: 0.8945
 896/1283 [===================>..........] - ETA: 0s - loss: 0.2986 - acc: 0.8862
1088/1283 [========================>.....] - ETA: 0s - loss: 0.2934 - acc: 0.8906
1216/1283 [===========================>..] - ETA: 0s - loss: 0.2905 - acc: 0.8947
1283/1283 [==============================] - 1s 700us/step - loss: 0.2883 - acc: 0.8971 - val_loss: 0.8283 - val_acc: 0.5852

Epoch 00010: val_acc did not improve
Epoch 11/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.2534 - acc: 0.9375
 192/1283 [===>..........................] - ETA: 0s - loss: 0.2638 - acc: 0.9323
 320/1283 [======>.......................] - ETA: 0s - loss: 0.2700 - acc: 0.9313
 384/1283 [=======>......................] - ETA: 0s - loss: 0.2601 - acc: 0.9349
 448/1283 [=========>....................] - ETA: 0s - loss: 0.2618 - acc: 0.9286
 576/1283 [============>.................] - ETA: 0s - loss: 0.2580 - acc: 0.9271
 704/1283 [===============>..............] - ETA: 0s - loss: 0.2674 - acc: 0.9134
 832/1283 [==================>...........] - ETA: 0s - loss: 0.2685 - acc: 0.9087
 960/1283 [=====================>........] - ETA: 0s - loss: 0.2727 - acc: 0.9062
1088/1283 [========================>.....] - ETA: 0s - loss: 0.2706 - acc: 0.9053
1216/1283 [===========================>..] - ETA: 0s - loss: 0.2664 - acc: 0.9071
1283/1283 [==============================] - 1s 772us/step - loss: 0.2642 - acc: 0.9080 - val_loss: 0.8336 - val_acc: 0.5852

Epoch 00011: val_acc did not improve
Epoch 12/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.2076 - acc: 0.9375
 192/1283 [===>..........................] - ETA: 0s - loss: 0.1934 - acc: 0.9583
 320/1283 [======>.......................] - ETA: 0s - loss: 0.1921 - acc: 0.9500
 448/1283 [=========>....................] - ETA: 0s - loss: 0.1928 - acc: 0.9509
 576/1283 [============>.................] - ETA: 0s - loss: 0.1923 - acc: 0.9531
 640/1283 [=============>................] - ETA: 0s - loss: 0.1920 - acc: 0.9547
 704/1283 [===============>..............] - ETA: 0s - loss: 0.1941 - acc: 0.9489
 768/1283 [================>.............] - ETA: 0s - loss: 0.1940 - acc: 0.9466
 896/1283 [===================>..........] - ETA: 0s - loss: 0.1913 - acc: 0.9487
1088/1283 [========================>.....] - ETA: 0s - loss: 0.1920 - acc: 0.9504
1280/1283 [============================>.] - ETA: 0s - loss: 0.1919 - acc: 0.9492
1283/1283 [==============================] - 1s 746us/step - loss: 0.1920 - acc: 0.9493 - val_loss: 0.9435 - val_acc: 0.5983

Epoch 00012: val_acc did not improve
Epoch 13/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1629 - acc: 0.9844
 256/1283 [====>.........................] - ETA: 0s - loss: 0.1661 - acc: 0.9609
 448/1283 [=========>....................] - ETA: 0s - loss: 0.1739 - acc: 0.9576
 640/1283 [=============>................] - ETA: 0s - loss: 0.1779 - acc: 0.9547
 768/1283 [================>.............] - ETA: 0s - loss: 0.1760 - acc: 0.9570
 896/1283 [===================>..........] - ETA: 0s - loss: 0.1724 - acc: 0.9587
 960/1283 [=====================>........] - ETA: 0s - loss: 0.1713 - acc: 0.9604
1088/1283 [========================>.....] - ETA: 0s - loss: 0.1730 - acc: 0.9568
1216/1283 [===========================>..] - ETA: 0s - loss: 0.1711 - acc: 0.9581
1280/1283 [============================>.] - ETA: 0s - loss: 0.1707 - acc: 0.9586
1283/1283 [==============================] - 1s 629us/step - loss: 0.1707 - acc: 0.9587 - val_loss: 0.9168 - val_acc: 0.5939

Epoch 00013: val_acc did not improve
Epoch 14/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1270 - acc: 0.9688
 192/1283 [===>..........................] - ETA: 0s - loss: 0.1379 - acc: 0.9688
 320/1283 [======>.......................] - ETA: 0s - loss: 0.1485 - acc: 0.9719
 448/1283 [=========>....................] - ETA: 0s - loss: 0.1460 - acc: 0.9732
 576/1283 [============>.................] - ETA: 0s - loss: 0.1407 - acc: 0.9740
 768/1283 [================>.............] - ETA: 0s - loss: 0.1376 - acc: 0.9766
 960/1283 [=====================>........] - ETA: 0s - loss: 0.1373 - acc: 0.9750
1024/1283 [======================>.......] - ETA: 0s - loss: 0.1367 - acc: 0.9746
1088/1283 [========================>.....] - ETA: 0s - loss: 0.1388 - acc: 0.9733
1152/1283 [=========================>....] - ETA: 0s - loss: 0.1370 - acc: 0.9740
1280/1283 [============================>.] - ETA: 0s - loss: 0.1385 - acc: 0.9719
1283/1283 [==============================] - 1s 584us/step - loss: 0.1384 - acc: 0.9719 - val_loss: 0.9994 - val_acc: 0.5939

Epoch 00014: val_acc did not improve
Epoch 15/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1039 - acc: 0.9844
 192/1283 [===>..........................] - ETA: 0s - loss: 0.1138 - acc: 0.9844
 320/1283 [======>.......................] - ETA: 0s - loss: 0.1147 - acc: 0.9844
 384/1283 [=======>......................] - ETA: 0s - loss: 0.1166 - acc: 0.9870
 512/1283 [==========>...................] - ETA: 0s - loss: 0.1155 - acc: 0.9883
 640/1283 [=============>................] - ETA: 0s - loss: 0.1193 - acc: 0.9859
 704/1283 [===============>..............] - ETA: 0s - loss: 0.1194 - acc: 0.9844
 768/1283 [================>.............] - ETA: 0s - loss: 0.1168 - acc: 0.9857
1024/1283 [======================>.......] - ETA: 0s - loss: 0.1178 - acc: 0.9863
1216/1283 [===========================>..] - ETA: 0s - loss: 0.1166 - acc: 0.9827
1283/1283 [==============================] - 1s 917us/step - loss: 0.1158 - acc: 0.9829 - val_loss: 1.0615 - val_acc: 0.5852

Epoch 00015: val_acc did not improve
Epoch 16/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1253 - acc: 0.9688
 256/1283 [====>.........................] - ETA: 0s - loss: 0.1034 - acc: 0.9766
 384/1283 [=======>......................] - ETA: 0s - loss: 0.0973 - acc: 0.9818
 576/1283 [============>.................] - ETA: 0s - loss: 0.0998 - acc: 0.9844
 832/1283 [==================>...........] - ETA: 0s - loss: 0.1008 - acc: 0.9856
1024/1283 [======================>.......] - ETA: 0s - loss: 0.1001 - acc: 0.9863
1152/1283 [=========================>....] - ETA: 0s - loss: 0.0994 - acc: 0.9861
1280/1283 [============================>.] - ETA: 0s - loss: 0.0993 - acc: 0.9859
1283/1283 [==============================] - 1s 522us/step - loss: 0.0993 - acc: 0.9860 - val_loss: 1.0583 - val_acc: 0.5983

Epoch 00016: val_acc did not improve
Epoch 17/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1022 - acc: 0.9688
 192/1283 [===>..........................] - ETA: 0s - loss: 0.0740 - acc: 0.9896
 256/1283 [====>.........................] - ETA: 0s - loss: 0.0768 - acc: 0.9922
 384/1283 [=======>......................] - ETA: 0s - loss: 0.0789 - acc: 0.9896
 576/1283 [============>.................] - ETA: 0s - loss: 0.0855 - acc: 0.9896
 768/1283 [================>.............] - ETA: 0s - loss: 0.0860 - acc: 0.9883
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0854 - acc: 0.9896
1152/1283 [=========================>....] - ETA: 0s - loss: 0.0850 - acc: 0.9896
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0843 - acc: 0.9893
1280/1283 [============================>.] - ETA: 0s - loss: 0.0843 - acc: 0.9891
1283/1283 [==============================] - 1s 668us/step - loss: 0.0842 - acc: 0.9891 - val_loss: 1.1322 - val_acc: 0.5764

Epoch 00017: val_acc did not improve
Epoch 18/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0679 - acc: 0.9844
 192/1283 [===>..........................] - ETA: 0s - loss: 0.0751 - acc: 0.9844
 320/1283 [======>.......................] - ETA: 0s - loss: 0.0727 - acc: 0.9844
 384/1283 [=======>......................] - ETA: 0s - loss: 0.0722 - acc: 0.9844
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0734 - acc: 0.9821
 576/1283 [============>.................] - ETA: 0s - loss: 0.0722 - acc: 0.9826
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0706 - acc: 0.9844
 896/1283 [===================>..........] - ETA: 0s - loss: 0.0700 - acc: 0.9855
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0678 - acc: 0.9881
1280/1283 [============================>.] - ETA: 0s - loss: 0.0672 - acc: 0.9898
1283/1283 [==============================] - 1s 707us/step - loss: 0.0671 - acc: 0.9899 - val_loss: 1.1915 - val_acc: 0.6070

Epoch 00018: val_acc did not improve
Epoch 00018: early stopping
batch_size=64
batch_norm=False
dropout_rate=0.2
n_layers=1
max_len=20
nodes=100
mode=A
PCA audio=30
PCA visual=20
PCA text=100
accuracy=0.5247813411078717
best_valid_accuracy=0.5451895043731778
/afs/inf.ed.ac.uk/user/s17/s1738075/.local/lib/python2.7/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
pca_early_fusion_cnn.py:146: RuntimeWarning: invalid value encountered in divide
  train_set_audio = train_set_audio / audio_max
pca_early_fusion_cnn.py:148: RuntimeWarning: invalid value encountered in divide
  test_set_audio = test_set_audio / audio_max
2018-03-28 22:18:52.096353: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
This API will be deprecated in the future versions. Please check the Github page for the current API

Modality facet for video 8qrpnFRGt2A segment 13 is (partially) missing and is thus being replaced by zeros!

Train on 1283 samples, validate on 229 samples
Epoch 1/100

  64/1283 [>.............................] - ETA: 15s - loss: 0.7602 - acc: 0.4531
 256/1283 [====>.........................] - ETA: 3s - loss: 0.7315 - acc: 0.5703 
 384/1283 [=======>......................] - ETA: 2s - loss: 0.7249 - acc: 0.5469
 512/1283 [==========>...................] - ETA: 1s - loss: 0.7378 - acc: 0.5566
 640/1283 [=============>................] - ETA: 1s - loss: 0.7339 - acc: 0.5625
 832/1283 [==================>...........] - ETA: 0s - loss: 0.7294 - acc: 0.5625
1024/1283 [======================>.......] - ETA: 0s - loss: 0.7300 - acc: 0.5498
1152/1283 [=========================>....] - ETA: 0s - loss: 0.7257 - acc: 0.5460
1280/1283 [============================>.] - ETA: 0s - loss: 0.7260 - acc: 0.5453
1283/1283 [==============================] - 1s 1ms/step - loss: 0.7265 - acc: 0.5440 - val_loss: 0.7197 - val_acc: 0.5284

Epoch 00001: val_acc improved from -inf to 0.52838, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20.ckpt
Epoch 2/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.6719 - acc: 0.5938
 256/1283 [====>.........................] - ETA: 0s - loss: 0.6586 - acc: 0.5898
 384/1283 [=======>......................] - ETA: 0s - loss: 0.6459 - acc: 0.6302
 640/1283 [=============>................] - ETA: 0s - loss: 0.6380 - acc: 0.6469
 960/1283 [=====================>........] - ETA: 0s - loss: 0.6364 - acc: 0.6625
1152/1283 [=========================>....] - ETA: 0s - loss: 0.6315 - acc: 0.6684
1283/1283 [==============================] - 0s 312us/step - loss: 0.6325 - acc: 0.6610 - val_loss: 0.6950 - val_acc: 0.5764

Epoch 00002: val_acc improved from 0.52838 to 0.57642, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20.ckpt
Epoch 3/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5688 - acc: 0.7031
 256/1283 [====>.........................] - ETA: 0s - loss: 0.5720 - acc: 0.7148
 448/1283 [=========>....................] - ETA: 0s - loss: 0.5831 - acc: 0.7076
 576/1283 [============>.................] - ETA: 0s - loss: 0.5769 - acc: 0.7066
 768/1283 [================>.............] - ETA: 0s - loss: 0.5777 - acc: 0.7109
 896/1283 [===================>..........] - ETA: 0s - loss: 0.5798 - acc: 0.7165
1152/1283 [=========================>....] - ETA: 0s - loss: 0.5733 - acc: 0.7170
1283/1283 [==============================] - 0s 376us/step - loss: 0.5746 - acc: 0.7124 - val_loss: 0.7223 - val_acc: 0.5546

Epoch 00003: val_acc did not improve
Epoch 4/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.6171 - acc: 0.6875
 256/1283 [====>.........................] - ETA: 0s - loss: 0.5792 - acc: 0.6836
 448/1283 [=========>....................] - ETA: 0s - loss: 0.5506 - acc: 0.7210
 576/1283 [============>.................] - ETA: 0s - loss: 0.5440 - acc: 0.7274
 768/1283 [================>.............] - ETA: 0s - loss: 0.5353 - acc: 0.7422
 960/1283 [=====================>........] - ETA: 0s - loss: 0.5325 - acc: 0.7448
1024/1283 [======================>.......] - ETA: 0s - loss: 0.5314 - acc: 0.7471
1152/1283 [=========================>....] - ETA: 0s - loss: 0.5307 - acc: 0.7465
1280/1283 [============================>.] - ETA: 0s - loss: 0.5319 - acc: 0.7414
1283/1283 [==============================] - 1s 485us/step - loss: 0.5318 - acc: 0.7412 - val_loss: 0.6991 - val_acc: 0.5590

Epoch 00004: val_acc did not improve
Epoch 5/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5022 - acc: 0.7344
 256/1283 [====>.........................] - ETA: 0s - loss: 0.4977 - acc: 0.7578
 448/1283 [=========>....................] - ETA: 0s - loss: 0.4872 - acc: 0.7835
 704/1283 [===============>..............] - ETA: 0s - loss: 0.4863 - acc: 0.7770
 832/1283 [==================>...........] - ETA: 0s - loss: 0.4882 - acc: 0.7728
 960/1283 [=====================>........] - ETA: 0s - loss: 0.4916 - acc: 0.7667
1152/1283 [=========================>....] - ETA: 0s - loss: 0.4809 - acc: 0.7795
1283/1283 [==============================] - 1s 392us/step - loss: 0.4791 - acc: 0.7818 - val_loss: 0.7179 - val_acc: 0.5546

Epoch 00005: val_acc did not improve
Epoch 6/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5137 - acc: 0.7188
 192/1283 [===>..........................] - ETA: 0s - loss: 0.4667 - acc: 0.7708
 384/1283 [=======>......................] - ETA: 0s - loss: 0.4455 - acc: 0.8099
 576/1283 [============>.................] - ETA: 0s - loss: 0.4358 - acc: 0.8021
 704/1283 [===============>..............] - ETA: 0s - loss: 0.4395 - acc: 0.8026
 832/1283 [==================>...........] - ETA: 0s - loss: 0.4398 - acc: 0.8005
 960/1283 [=====================>........] - ETA: 0s - loss: 0.4531 - acc: 0.7875
1152/1283 [=========================>....] - ETA: 0s - loss: 0.4489 - acc: 0.7899
1283/1283 [==============================] - 1s 423us/step - loss: 0.4453 - acc: 0.7927 - val_loss: 0.7330 - val_acc: 0.5808

Epoch 00006: val_acc improved from 0.57642 to 0.58079, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20.ckpt
Epoch 7/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.3976 - acc: 0.8281
 192/1283 [===>..........................] - ETA: 0s - loss: 0.3752 - acc: 0.8438
 320/1283 [======>.......................] - ETA: 0s - loss: 0.3706 - acc: 0.8594
 512/1283 [==========>...................] - ETA: 0s - loss: 0.3604 - acc: 0.8594
 704/1283 [===============>..............] - ETA: 0s - loss: 0.3616 - acc: 0.8636
 960/1283 [=====================>........] - ETA: 0s - loss: 0.3609 - acc: 0.8625
1216/1283 [===========================>..] - ETA: 0s - loss: 0.3697 - acc: 0.8536
1283/1283 [==============================] - 0s 350us/step - loss: 0.3715 - acc: 0.8511 - val_loss: 0.8223 - val_acc: 0.5590

Epoch 00007: val_acc did not improve
Epoch 8/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.3535 - acc: 0.8438
 256/1283 [====>.........................] - ETA: 0s - loss: 0.3871 - acc: 0.8242
 512/1283 [==========>...................] - ETA: 0s - loss: 0.3653 - acc: 0.8574
 768/1283 [================>.............] - ETA: 0s - loss: 0.3563 - acc: 0.8724
 960/1283 [=====================>........] - ETA: 0s - loss: 0.3506 - acc: 0.8698
1152/1283 [=========================>....] - ETA: 0s - loss: 0.3419 - acc: 0.8767
1283/1283 [==============================] - 0s 318us/step - loss: 0.3384 - acc: 0.8815 - val_loss: 0.7708 - val_acc: 0.5546

Epoch 00008: val_acc did not improve
Epoch 9/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.2512 - acc: 0.9688
 256/1283 [====>.........................] - ETA: 0s - loss: 0.2956 - acc: 0.8906
 384/1283 [=======>......................] - ETA: 0s - loss: 0.2886 - acc: 0.8984
 576/1283 [============>.................] - ETA: 0s - loss: 0.2873 - acc: 0.9097
 768/1283 [================>.............] - ETA: 0s - loss: 0.2929 - acc: 0.9062
 960/1283 [=====================>........] - ETA: 0s - loss: 0.2963 - acc: 0.9010
1152/1283 [=========================>....] - ETA: 0s - loss: 0.2964 - acc: 0.8984
1283/1283 [==============================] - 0s 353us/step - loss: 0.2938 - acc: 0.9002 - val_loss: 0.8146 - val_acc: 0.5721

Epoch 00009: val_acc did not improve
Epoch 10/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.2344 - acc: 0.9219
 256/1283 [====>.........................] - ETA: 0s - loss: 0.2397 - acc: 0.9297
 448/1283 [=========>....................] - ETA: 0s - loss: 0.2390 - acc: 0.9308
 576/1283 [============>.................] - ETA: 0s - loss: 0.2425 - acc: 0.9271
 768/1283 [================>.............] - ETA: 0s - loss: 0.2490 - acc: 0.9180
 960/1283 [=====================>........] - ETA: 0s - loss: 0.2464 - acc: 0.9229
1152/1283 [=========================>....] - ETA: 0s - loss: 0.2436 - acc: 0.9253
1283/1283 [==============================] - 0s 331us/step - loss: 0.2447 - acc: 0.9228 - val_loss: 0.8508 - val_acc: 0.5852

Epoch 00010: val_acc improved from 0.58079 to 0.58515, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20.ckpt
Epoch 11/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1606 - acc: 0.9844
 256/1283 [====>.........................] - ETA: 0s - loss: 0.2044 - acc: 0.9531
 512/1283 [==========>...................] - ETA: 0s - loss: 0.2128 - acc: 0.9473
 768/1283 [================>.............] - ETA: 0s - loss: 0.2082 - acc: 0.9453
1024/1283 [======================>.......] - ETA: 0s - loss: 0.2172 - acc: 0.9424
1152/1283 [=========================>....] - ETA: 0s - loss: 0.2130 - acc: 0.9427
1283/1283 [==============================] - 0s 316us/step - loss: 0.2142 - acc: 0.9431 - val_loss: 0.8665 - val_acc: 0.5590

Epoch 00011: val_acc did not improve
Epoch 12/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1930 - acc: 0.9531
 256/1283 [====>.........................] - ETA: 0s - loss: 0.1874 - acc: 0.9609
 384/1283 [=======>......................] - ETA: 0s - loss: 0.1731 - acc: 0.9688
 512/1283 [==========>...................] - ETA: 0s - loss: 0.1672 - acc: 0.9727
 704/1283 [===============>..............] - ETA: 0s - loss: 0.1757 - acc: 0.9631
 896/1283 [===================>..........] - ETA: 0s - loss: 0.1821 - acc: 0.9520
1152/1283 [=========================>....] - ETA: 0s - loss: 0.1779 - acc: 0.9549
1283/1283 [==============================] - 0s 348us/step - loss: 0.1832 - acc: 0.9525 - val_loss: 0.9294 - val_acc: 0.5677

Epoch 00012: val_acc did not improve
Epoch 13/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1604 - acc: 0.9375
 320/1283 [======>.......................] - ETA: 0s - loss: 0.1542 - acc: 0.9625
 576/1283 [============>.................] - ETA: 0s - loss: 0.1470 - acc: 0.9670
 832/1283 [==================>...........] - ETA: 0s - loss: 0.1406 - acc: 0.9724
1024/1283 [======================>.......] - ETA: 0s - loss: 0.1398 - acc: 0.9727
1280/1283 [============================>.] - ETA: 0s - loss: 0.1377 - acc: 0.9742
1283/1283 [==============================] - 0s 309us/step - loss: 0.1378 - acc: 0.9743 - val_loss: 1.0104 - val_acc: 0.5764

Epoch 00013: val_acc did not improve
Epoch 14/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0833 - acc: 1.0000
 256/1283 [====>.........................] - ETA: 0s - loss: 0.1108 - acc: 0.9883
 448/1283 [=========>....................] - ETA: 0s - loss: 0.1109 - acc: 0.9777
 704/1283 [===============>..............] - ETA: 0s - loss: 0.1165 - acc: 0.9787
 896/1283 [===================>..........] - ETA: 0s - loss: 0.1180 - acc: 0.9743
1152/1283 [=========================>....] - ETA: 0s - loss: 0.1141 - acc: 0.9757
1283/1283 [==============================] - 0s 326us/step - loss: 0.1135 - acc: 0.9782 - val_loss: 1.0771 - val_acc: 0.5677

Epoch 00014: val_acc did not improve
Epoch 15/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0799 - acc: 1.0000
 256/1283 [====>.........................] - ETA: 0s - loss: 0.1162 - acc: 0.9844
 512/1283 [==========>...................] - ETA: 0s - loss: 0.1062 - acc: 0.9883
 768/1283 [================>.............] - ETA: 0s - loss: 0.1154 - acc: 0.9792
1024/1283 [======================>.......] - ETA: 0s - loss: 0.1129 - acc: 0.9805
1280/1283 [============================>.] - ETA: 0s - loss: 0.1141 - acc: 0.9789
1283/1283 [==============================] - 0s 304us/step - loss: 0.1140 - acc: 0.9790 - val_loss: 1.0864 - val_acc: 0.5721

Epoch 00015: val_acc did not improve
Epoch 16/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0697 - acc: 1.0000
 256/1283 [====>.........................] - ETA: 0s - loss: 0.0898 - acc: 0.9883
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0926 - acc: 0.9866
 640/1283 [=============>................] - ETA: 0s - loss: 0.0950 - acc: 0.9875
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0926 - acc: 0.9880
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0908 - acc: 0.9883
1152/1283 [=========================>....] - ETA: 0s - loss: 0.0912 - acc: 0.9887
1283/1283 [==============================] - 0s 376us/step - loss: 0.0895 - acc: 0.9891 - val_loss: 1.1910 - val_acc: 0.5852

Epoch 00016: val_acc improved from 0.58515 to 0.58515, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20.ckpt
Epoch 17/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0563 - acc: 1.0000
 320/1283 [======>.......................] - ETA: 0s - loss: 0.0614 - acc: 0.9969
 576/1283 [============>.................] - ETA: 0s - loss: 0.0646 - acc: 0.9965
 768/1283 [================>.............] - ETA: 0s - loss: 0.0643 - acc: 0.9961
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0619 - acc: 0.9958
1152/1283 [=========================>....] - ETA: 0s - loss: 0.0644 - acc: 0.9939
1280/1283 [============================>.] - ETA: 0s - loss: 0.0630 - acc: 0.9945
1283/1283 [==============================] - 0s 372us/step - loss: 0.0629 - acc: 0.9945 - val_loss: 1.2798 - val_acc: 0.5328

Epoch 00017: val_acc did not improve
Epoch 18/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0327 - acc: 1.0000
 256/1283 [====>.........................] - ETA: 0s - loss: 0.0504 - acc: 0.9961
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0468 - acc: 0.9978
 640/1283 [=============>................] - ETA: 0s - loss: 0.0477 - acc: 0.9969
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0484 - acc: 0.9976
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0484 - acc: 0.9969
1152/1283 [=========================>....] - ETA: 0s - loss: 0.0504 - acc: 0.9965
1283/1283 [==============================] - 1s 394us/step - loss: 0.0525 - acc: 0.9961 - val_loss: 1.2858 - val_acc: 0.5415

Epoch 00018: val_acc did not improve
Epoch 19/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0346 - acc: 1.0000
 256/1283 [====>.........................] - ETA: 0s - loss: 0.0637 - acc: 0.9883
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0671 - acc: 0.9888
 640/1283 [=============>................] - ETA: 0s - loss: 0.0710 - acc: 0.9891
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0665 - acc: 0.9916
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0662 - acc: 0.9902
1280/1283 [============================>.] - ETA: 0s - loss: 0.0660 - acc: 0.9906
1283/1283 [==============================] - 0s 320us/step - loss: 0.0661 - acc: 0.9906 - val_loss: 1.3702 - val_acc: 0.5415

Epoch 00019: val_acc did not improve
Epoch 20/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0418 - acc: 1.0000
 320/1283 [======>.......................] - ETA: 0s - loss: 0.0476 - acc: 1.0000
 512/1283 [==========>...................] - ETA: 0s - loss: 0.0463 - acc: 1.0000
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0468 - acc: 0.9957
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0468 - acc: 0.9969
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0461 - acc: 0.9967
1283/1283 [==============================] - 0s 303us/step - loss: 0.0462 - acc: 0.9961 - val_loss: 1.4222 - val_acc: 0.4891

Epoch 00020: val_acc did not improve
Epoch 21/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0397 - acc: 1.0000
 256/1283 [====>.........................] - ETA: 0s - loss: 0.0859 - acc: 0.9688
 512/1283 [==========>...................] - ETA: 0s - loss: 0.0831 - acc: 0.9727
 768/1283 [================>.............] - ETA: 0s - loss: 0.0808 - acc: 0.9753
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0844 - acc: 0.9750
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0815 - acc: 0.9779
1280/1283 [============================>.] - ETA: 0s - loss: 0.0791 - acc: 0.9789
1283/1283 [==============================] - 0s 353us/step - loss: 0.0792 - acc: 0.9790 - val_loss: 1.5752 - val_acc: 0.5633

Epoch 00021: val_acc did not improve
Epoch 22/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0488 - acc: 1.0000
 256/1283 [====>.........................] - ETA: 0s - loss: 0.1147 - acc: 0.9648
 512/1283 [==========>...................] - ETA: 0s - loss: 0.0972 - acc: 0.9727
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0933 - acc: 0.9759
 896/1283 [===================>..........] - ETA: 0s - loss: 0.0883 - acc: 0.9754
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0830 - acc: 0.9785
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0777 - acc: 0.9811
1283/1283 [==============================] - 0s 320us/step - loss: 0.0768 - acc: 0.9821 - val_loss: 1.4177 - val_acc: 0.5677

Epoch 00022: val_acc did not improve
Epoch 23/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0395 - acc: 1.0000
 320/1283 [======>.......................] - ETA: 0s - loss: 0.0513 - acc: 0.9938
 576/1283 [============>.................] - ETA: 0s - loss: 0.0454 - acc: 0.9948
 768/1283 [================>.............] - ETA: 0s - loss: 0.0419 - acc: 0.9948
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0404 - acc: 0.9948
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0385 - acc: 0.9951
1283/1283 [==============================] - 0s 285us/step - loss: 0.0376 - acc: 0.9953 - val_loss: 1.4421 - val_acc: 0.5502

Epoch 00023: val_acc did not improve
Epoch 24/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0316 - acc: 0.9844
 320/1283 [======>.......................] - ETA: 0s - loss: 0.0278 - acc: 0.9969
 512/1283 [==========>...................] - ETA: 0s - loss: 0.0276 - acc: 0.9980
 768/1283 [================>.............] - ETA: 0s - loss: 0.0253 - acc: 0.9987
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0242 - acc: 0.9990
1152/1283 [=========================>....] - ETA: 0s - loss: 0.0238 - acc: 0.9991
1283/1283 [==============================] - 0s 328us/step - loss: 0.0242 - acc: 0.9992 - val_loss: 1.5331 - val_acc: 0.5764

Epoch 00024: val_acc did not improve
Epoch 25/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0205 - acc: 1.0000
 256/1283 [====>.........................] - ETA: 0s - loss: 0.0198 - acc: 1.0000
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0205 - acc: 0.9978
 640/1283 [=============>................] - ETA: 0s - loss: 0.0188 - acc: 0.9984
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0187 - acc: 0.9988
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0186 - acc: 0.9990
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0186 - acc: 0.9992
1283/1283 [==============================] - 0s 328us/step - loss: 0.0182 - acc: 0.9992 - val_loss: 1.5509 - val_acc: 0.5764

Epoch 00025: val_acc did not improve
Epoch 26/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0121 - acc: 1.0000
 256/1283 [====>.........................] - ETA: 0s - loss: 0.0126 - acc: 1.0000
 384/1283 [=======>......................] - ETA: 0s - loss: 0.0141 - acc: 1.0000
 576/1283 [============>.................] - ETA: 0s - loss: 0.0164 - acc: 1.0000
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0152 - acc: 1.0000
 896/1283 [===================>..........] - ETA: 0s - loss: 0.0144 - acc: 1.0000
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0150 - acc: 0.9991
1280/1283 [============================>.] - ETA: 0s - loss: 0.0146 - acc: 0.9992
1283/1283 [==============================] - 1s 429us/step - loss: 0.0145 - acc: 0.9992 - val_loss: 1.5804 - val_acc: 0.5546

Epoch 00026: val_acc did not improve
Epoch 00026: early stopping
batch_size=64
batch_norm=False
dropout_rate=0.2
n_layers=1
max_len=20
nodes=100
mode=A
PCA audio=30
PCA visual=25
PCA text=100
accuracy=0.4970845481049563
best_valid_accuracy=0.5262390670553936
/afs/inf.ed.ac.uk/user/s17/s1738075/.local/lib/python2.7/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
pca_early_fusion_cnn.py:146: RuntimeWarning: invalid value encountered in divide
  train_set_audio = train_set_audio / audio_max
pca_early_fusion_cnn.py:148: RuntimeWarning: invalid value encountered in divide
  test_set_audio = test_set_audio / audio_max
2018-03-28 22:24:34.786675: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
This API will be deprecated in the future versions. Please check the Github page for the current API

Modality facet for video 8qrpnFRGt2A segment 13 is (partially) missing and is thus being replaced by zeros!

Train on 1283 samples, validate on 229 samples
Epoch 1/100

  64/1283 [>.............................] - ETA: 5s - loss: 0.7456 - acc: 0.5000
 192/1283 [===>..........................] - ETA: 2s - loss: 0.7843 - acc: 0.5156
 320/1283 [======>.......................] - ETA: 1s - loss: 0.7636 - acc: 0.5188
 448/1283 [=========>....................] - ETA: 0s - loss: 0.7477 - acc: 0.5246
 640/1283 [=============>................] - ETA: 0s - loss: 0.7524 - acc: 0.5172
 832/1283 [==================>...........] - ETA: 0s - loss: 0.7437 - acc: 0.5216
1024/1283 [======================>.......] - ETA: 0s - loss: 0.7398 - acc: 0.5215
1216/1283 [===========================>..] - ETA: 0s - loss: 0.7339 - acc: 0.5238
1283/1283 [==============================] - 1s 661us/step - loss: 0.7288 - acc: 0.5300 - val_loss: 0.7030 - val_acc: 0.5109

Epoch 00001: val_acc improved from -inf to 0.51092, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20.ckpt
Epoch 2/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.6389 - acc: 0.6719
 256/1283 [====>.........................] - ETA: 0s - loss: 0.6256 - acc: 0.6875
 512/1283 [==========>...................] - ETA: 0s - loss: 0.6272 - acc: 0.6738
 768/1283 [================>.............] - ETA: 0s - loss: 0.6234 - acc: 0.6732
 960/1283 [=====================>........] - ETA: 0s - loss: 0.6102 - acc: 0.6833
1152/1283 [=========================>....] - ETA: 0s - loss: 0.6061 - acc: 0.6840
1283/1283 [==============================] - 0s 275us/step - loss: 0.6034 - acc: 0.6867 - val_loss: 0.7345 - val_acc: 0.5415

Epoch 00002: val_acc improved from 0.51092 to 0.54148, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20.ckpt
Epoch 3/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5422 - acc: 0.7656
 256/1283 [====>.........................] - ETA: 0s - loss: 0.5581 - acc: 0.7227
 448/1283 [=========>....................] - ETA: 0s - loss: 0.5550 - acc: 0.7254
 640/1283 [=============>................] - ETA: 0s - loss: 0.5471 - acc: 0.7250
 832/1283 [==================>...........] - ETA: 0s - loss: 0.5469 - acc: 0.7248
1088/1283 [========================>.....] - ETA: 0s - loss: 0.5454 - acc: 0.7188
1283/1283 [==============================] - 0s 305us/step - loss: 0.5519 - acc: 0.7124 - val_loss: 0.7298 - val_acc: 0.5459

Epoch 00003: val_acc improved from 0.54148 to 0.54585, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20.ckpt
Epoch 4/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.4815 - acc: 0.8438
 320/1283 [======>.......................] - ETA: 0s - loss: 0.5163 - acc: 0.7469
 512/1283 [==========>...................] - ETA: 0s - loss: 0.5093 - acc: 0.7480
 640/1283 [=============>................] - ETA: 0s - loss: 0.5040 - acc: 0.7562
 832/1283 [==================>...........] - ETA: 0s - loss: 0.5087 - acc: 0.7476
1088/1283 [========================>.....] - ETA: 0s - loss: 0.4986 - acc: 0.7537
1283/1283 [==============================] - 0s 306us/step - loss: 0.5021 - acc: 0.7560 - val_loss: 0.8242 - val_acc: 0.5197

Epoch 00004: val_acc did not improve
Epoch 5/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.4927 - acc: 0.7344
 256/1283 [====>.........................] - ETA: 0s - loss: 0.5200 - acc: 0.6953
 448/1283 [=========>....................] - ETA: 0s - loss: 0.4785 - acc: 0.7545
 704/1283 [===============>..............] - ETA: 0s - loss: 0.4729 - acc: 0.7571
 896/1283 [===================>..........] - ETA: 0s - loss: 0.4740 - acc: 0.7656
1152/1283 [=========================>....] - ETA: 0s - loss: 0.4801 - acc: 0.7604
1283/1283 [==============================] - 0s 318us/step - loss: 0.4725 - acc: 0.7701 - val_loss: 0.7510 - val_acc: 0.5371

Epoch 00005: val_acc did not improve
Epoch 6/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.4470 - acc: 0.8438
 320/1283 [======>.......................] - ETA: 0s - loss: 0.3925 - acc: 0.8625
 576/1283 [============>.................] - ETA: 0s - loss: 0.3841 - acc: 0.8698
 832/1283 [==================>...........] - ETA: 0s - loss: 0.3868 - acc: 0.8642
1024/1283 [======================>.......] - ETA: 0s - loss: 0.3890 - acc: 0.8604
1280/1283 [============================>.] - ETA: 0s - loss: 0.3856 - acc: 0.8586
1283/1283 [==============================] - 0s 306us/step - loss: 0.3857 - acc: 0.8589 - val_loss: 0.8526 - val_acc: 0.5109

Epoch 00006: val_acc did not improve
Epoch 7/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.3732 - acc: 0.8438
 320/1283 [======>.......................] - ETA: 0s - loss: 0.3691 - acc: 0.8313
 576/1283 [============>.................] - ETA: 0s - loss: 0.3657 - acc: 0.8351
 832/1283 [==================>...........] - ETA: 0s - loss: 0.3539 - acc: 0.8534
1024/1283 [======================>.......] - ETA: 0s - loss: 0.3520 - acc: 0.8525
1216/1283 [===========================>..] - ETA: 0s - loss: 0.3521 - acc: 0.8503
1283/1283 [==============================] - 0s 313us/step - loss: 0.3509 - acc: 0.8488 - val_loss: 0.8111 - val_acc: 0.5677

Epoch 00007: val_acc improved from 0.54585 to 0.56769, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20.ckpt
Epoch 8/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.3511 - acc: 0.8438
 256/1283 [====>.........................] - ETA: 0s - loss: 0.2802 - acc: 0.9141
 448/1283 [=========>....................] - ETA: 0s - loss: 0.2846 - acc: 0.9129
 768/1283 [================>.............] - ETA: 0s - loss: 0.2820 - acc: 0.9076
 960/1283 [=====================>........] - ETA: 0s - loss: 0.2780 - acc: 0.9052
1152/1283 [=========================>....] - ETA: 0s - loss: 0.2764 - acc: 0.9097
1283/1283 [==============================] - 0s 315us/step - loss: 0.2746 - acc: 0.9088 - val_loss: 0.8463 - val_acc: 0.5546

Epoch 00008: val_acc did not improve
Epoch 9/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.2117 - acc: 0.9375
 256/1283 [====>.........................] - ETA: 0s - loss: 0.2869 - acc: 0.8867
 448/1283 [=========>....................] - ETA: 0s - loss: 0.2634 - acc: 0.9085
 704/1283 [===============>..............] - ETA: 0s - loss: 0.2492 - acc: 0.9233
 960/1283 [=====================>........] - ETA: 0s - loss: 0.2442 - acc: 0.9240
1216/1283 [===========================>..] - ETA: 0s - loss: 0.2420 - acc: 0.9293
1283/1283 [==============================] - 0s 293us/step - loss: 0.2435 - acc: 0.9275 - val_loss: 0.8564 - val_acc: 0.5590

Epoch 00009: val_acc did not improve
Epoch 10/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1531 - acc: 1.0000
 256/1283 [====>.........................] - ETA: 0s - loss: 0.2304 - acc: 0.9219
 512/1283 [==========>...................] - ETA: 0s - loss: 0.2325 - acc: 0.9219
 768/1283 [================>.............] - ETA: 0s - loss: 0.2406 - acc: 0.9180
 960/1283 [=====================>........] - ETA: 0s - loss: 0.2390 - acc: 0.9156
1152/1283 [=========================>....] - ETA: 0s - loss: 0.2300 - acc: 0.9236
1283/1283 [==============================] - 0s 288us/step - loss: 0.2293 - acc: 0.9244 - val_loss: 0.9058 - val_acc: 0.5721

Epoch 00010: val_acc improved from 0.56769 to 0.57205, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20.ckpt
Epoch 11/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.2071 - acc: 0.9219
 256/1283 [====>.........................] - ETA: 0s - loss: 0.1707 - acc: 0.9648
 448/1283 [=========>....................] - ETA: 0s - loss: 0.1639 - acc: 0.9688
 704/1283 [===============>..............] - ETA: 0s - loss: 0.1706 - acc: 0.9574
 896/1283 [===================>..........] - ETA: 0s - loss: 0.1660 - acc: 0.9621
1088/1283 [========================>.....] - ETA: 0s - loss: 0.1625 - acc: 0.9642
1280/1283 [============================>.] - ETA: 0s - loss: 0.1622 - acc: 0.9641
1283/1283 [==============================] - 0s 316us/step - loss: 0.1628 - acc: 0.9634 - val_loss: 0.9430 - val_acc: 0.5721

Epoch 00011: val_acc did not improve
Epoch 12/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1222 - acc: 0.9844
 256/1283 [====>.........................] - ETA: 0s - loss: 0.1645 - acc: 0.9336
 512/1283 [==========>...................] - ETA: 0s - loss: 0.1536 - acc: 0.9512
 768/1283 [================>.............] - ETA: 0s - loss: 0.1475 - acc: 0.9583
1024/1283 [======================>.......] - ETA: 0s - loss: 0.1419 - acc: 0.9619
1280/1283 [============================>.] - ETA: 0s - loss: 0.1402 - acc: 0.9656
1283/1283 [==============================] - 0s 254us/step - loss: 0.1399 - acc: 0.9657 - val_loss: 1.0027 - val_acc: 0.5808

Epoch 00012: val_acc improved from 0.57205 to 0.58079, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20.ckpt
Epoch 13/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1348 - acc: 0.9844
 320/1283 [======>.......................] - ETA: 0s - loss: 0.1058 - acc: 0.9906
 576/1283 [============>.................] - ETA: 0s - loss: 0.1077 - acc: 0.9861
 768/1283 [================>.............] - ETA: 0s - loss: 0.1037 - acc: 0.9870
 896/1283 [===================>..........] - ETA: 0s - loss: 0.1021 - acc: 0.9866
1088/1283 [========================>.....] - ETA: 0s - loss: 0.1027 - acc: 0.9871
1280/1283 [============================>.] - ETA: 0s - loss: 0.1031 - acc: 0.9875
1283/1283 [==============================] - 0s 338us/step - loss: 0.1029 - acc: 0.9875 - val_loss: 1.0065 - val_acc: 0.5459

Epoch 00013: val_acc did not improve
Epoch 14/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0901 - acc: 0.9844
 256/1283 [====>.........................] - ETA: 0s - loss: 0.0890 - acc: 0.9844
 512/1283 [==========>...................] - ETA: 0s - loss: 0.0849 - acc: 0.9883
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0805 - acc: 0.9901
 896/1283 [===================>..........] - ETA: 0s - loss: 0.0795 - acc: 0.9900
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0791 - acc: 0.9917
1280/1283 [============================>.] - ETA: 0s - loss: 0.0790 - acc: 0.9922
1283/1283 [==============================] - 0s 321us/step - loss: 0.0794 - acc: 0.9922 - val_loss: 1.0961 - val_acc: 0.5764

Epoch 00014: val_acc did not improve
Epoch 15/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0734 - acc: 1.0000
 256/1283 [====>.........................] - ETA: 0s - loss: 0.0914 - acc: 0.9883
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0918 - acc: 0.9866
 640/1283 [=============>................] - ETA: 0s - loss: 0.0889 - acc: 0.9891
 896/1283 [===================>..........] - ETA: 0s - loss: 0.0904 - acc: 0.9833
1152/1283 [=========================>....] - ETA: 0s - loss: 0.0920 - acc: 0.9826
1283/1283 [==============================] - 0s 294us/step - loss: 0.0901 - acc: 0.9836 - val_loss: 1.2122 - val_acc: 0.5590

Epoch 00015: val_acc did not improve
Epoch 16/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0844 - acc: 0.9844
 320/1283 [======>.......................] - ETA: 0s - loss: 0.0820 - acc: 0.9844
 512/1283 [==========>...................] - ETA: 0s - loss: 0.0791 - acc: 0.9844
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0748 - acc: 0.9886
 896/1283 [===================>..........] - ETA: 0s - loss: 0.0724 - acc: 0.9888
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0709 - acc: 0.9890
1280/1283 [============================>.] - ETA: 0s - loss: 0.0682 - acc: 0.9906
1283/1283 [==============================] - 0s 325us/step - loss: 0.0681 - acc: 0.9906 - val_loss: 1.1453 - val_acc: 0.5764

Epoch 00016: val_acc did not improve
Epoch 17/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0638 - acc: 1.0000
 256/1283 [====>.........................] - ETA: 0s - loss: 0.0542 - acc: 1.0000
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0520 - acc: 0.9978
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0491 - acc: 0.9986
 896/1283 [===================>..........] - ETA: 0s - loss: 0.0481 - acc: 0.9978
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0462 - acc: 0.9963
1283/1283 [==============================] - 0s 276us/step - loss: 0.0457 - acc: 0.9969 - val_loss: 1.1908 - val_acc: 0.5633

Epoch 00017: val_acc did not improve
Epoch 18/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0300 - acc: 1.0000
 256/1283 [====>.........................] - ETA: 0s - loss: 0.0378 - acc: 1.0000
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0356 - acc: 1.0000
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0352 - acc: 1.0000
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0358 - acc: 0.9990
1152/1283 [=========================>....] - ETA: 0s - loss: 0.0335 - acc: 0.9991
1283/1283 [==============================] - 0s 274us/step - loss: 0.0341 - acc: 0.9984 - val_loss: 1.2426 - val_acc: 0.5764

Epoch 00018: val_acc did not improve
Epoch 19/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0281 - acc: 1.0000
 256/1283 [====>.........................] - ETA: 0s - loss: 0.0283 - acc: 1.0000
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0263 - acc: 1.0000
 640/1283 [=============>................] - ETA: 0s - loss: 0.0273 - acc: 0.9984
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0282 - acc: 0.9988
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0266 - acc: 0.9990
1280/1283 [============================>.] - ETA: 0s - loss: 0.0268 - acc: 0.9992
1283/1283 [==============================] - 0s 309us/step - loss: 0.0268 - acc: 0.9992 - val_loss: 1.2676 - val_acc: 0.5808

Epoch 00019: val_acc did not improve
Epoch 20/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0273 - acc: 1.0000
 256/1283 [====>.........................] - ETA: 0s - loss: 0.0200 - acc: 1.0000
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0230 - acc: 0.9978
 640/1283 [=============>................] - ETA: 0s - loss: 0.0230 - acc: 0.9969
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0239 - acc: 0.9976
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0232 - acc: 0.9982
1280/1283 [============================>.] - ETA: 0s - loss: 0.0229 - acc: 0.9984
1283/1283 [==============================] - 0s 306us/step - loss: 0.0230 - acc: 0.9984 - val_loss: 1.2965 - val_acc: 0.5677

Epoch 00020: val_acc did not improve
Epoch 21/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0128 - acc: 1.0000
 320/1283 [======>.......................] - ETA: 0s - loss: 0.0198 - acc: 0.9969
 576/1283 [============>.................] - ETA: 0s - loss: 0.0194 - acc: 0.9983
 768/1283 [================>.............] - ETA: 0s - loss: 0.0198 - acc: 0.9987
 896/1283 [===================>..........] - ETA: 0s - loss: 0.0200 - acc: 0.9989
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0203 - acc: 0.9991
1280/1283 [============================>.] - ETA: 0s - loss: 0.0201 - acc: 0.9992
1283/1283 [==============================] - 0s 356us/step - loss: 0.0206 - acc: 0.9984 - val_loss: 1.3317 - val_acc: 0.5852

Epoch 00021: val_acc improved from 0.58079 to 0.58515, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20.ckpt
Epoch 22/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0167 - acc: 1.0000
 192/1283 [===>..........................] - ETA: 0s - loss: 0.0131 - acc: 1.0000
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0183 - acc: 0.9978
 640/1283 [=============>................] - ETA: 0s - loss: 0.0189 - acc: 0.9984
 896/1283 [===================>..........] - ETA: 0s - loss: 0.0210 - acc: 0.9978
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0219 - acc: 0.9980
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0217 - acc: 0.9984
1283/1283 [==============================] - 0s 358us/step - loss: 0.0222 - acc: 0.9984 - val_loss: 1.3352 - val_acc: 0.5764

Epoch 00022: val_acc did not improve
Epoch 23/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0201 - acc: 1.0000
 256/1283 [====>.........................] - ETA: 0s - loss: 0.0154 - acc: 1.0000
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0160 - acc: 1.0000
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0155 - acc: 1.0000
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0162 - acc: 0.9990
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0158 - acc: 0.9992
1283/1283 [==============================] - 0s 346us/step - loss: 0.0160 - acc: 0.9992 - val_loss: 1.3430 - val_acc: 0.5983

Epoch 00023: val_acc improved from 0.58515 to 0.59825, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20.ckpt
Epoch 24/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0112 - acc: 1.0000
 256/1283 [====>.........................] - ETA: 0s - loss: 0.0122 - acc: 1.0000
 512/1283 [==========>...................] - ETA: 0s - loss: 0.0181 - acc: 0.9980
 768/1283 [================>.............] - ETA: 0s - loss: 0.0167 - acc: 0.9987
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0169 - acc: 0.9990
1283/1283 [==============================] - 0s 257us/step - loss: 0.0170 - acc: 0.9992 - val_loss: 1.5002 - val_acc: 0.5939

Epoch 00024: val_acc did not improve
Epoch 25/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0198 - acc: 1.0000
 320/1283 [======>.......................] - ETA: 0s - loss: 0.0162 - acc: 1.0000
 576/1283 [============>.................] - ETA: 0s - loss: 0.0153 - acc: 0.9983
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0155 - acc: 0.9988
1152/1283 [=========================>....] - ETA: 0s - loss: 0.0151 - acc: 0.9991
1283/1283 [==============================] - 0s 242us/step - loss: 0.0151 - acc: 0.9992 - val_loss: 1.4002 - val_acc: 0.5764

Epoch 00025: val_acc did not improve
Epoch 26/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0122 - acc: 1.0000
 384/1283 [=======>......................] - ETA: 0s - loss: 0.0109 - acc: 1.0000
 640/1283 [=============>................] - ETA: 0s - loss: 0.0106 - acc: 1.0000
 896/1283 [===================>..........] - ETA: 0s - loss: 0.0115 - acc: 0.9989
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0114 - acc: 0.9992
1283/1283 [==============================] - 0s 229us/step - loss: 0.0112 - acc: 0.9992 - val_loss: 1.3674 - val_acc: 0.5852

Epoch 00026: val_acc did not improve
Epoch 27/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0097 - acc: 1.0000
 320/1283 [======>.......................] - ETA: 0s - loss: 0.0079 - acc: 1.0000
 576/1283 [============>.................] - ETA: 0s - loss: 0.0083 - acc: 1.0000
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0084 - acc: 1.0000
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0082 - acc: 1.0000
1280/1283 [============================>.] - ETA: 0s - loss: 0.0085 - acc: 0.9992
1283/1283 [==============================] - 0s 257us/step - loss: 0.0085 - acc: 0.9992 - val_loss: 1.4523 - val_acc: 0.5808

Epoch 00027: val_acc did not improve
Epoch 28/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0096 - acc: 1.0000
 320/1283 [======>.......................] - ETA: 0s - loss: 0.0075 - acc: 1.0000
 576/1283 [============>.................] - ETA: 0s - loss: 0.0066 - acc: 1.0000
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0063 - acc: 1.0000
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0070 - acc: 1.0000
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0073 - acc: 1.0000
1283/1283 [==============================] - 0s 289us/step - loss: 0.0072 - acc: 1.0000 - val_loss: 1.4818 - val_acc: 0.5721

Epoch 00028: val_acc did not improve
Epoch 29/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0053 - acc: 1.0000
 320/1283 [======>.......................] - ETA: 0s - loss: 0.0075 - acc: 1.0000
 576/1283 [============>.................] - ETA: 0s - loss: 0.0066 - acc: 1.0000
 768/1283 [================>.............] - ETA: 0s - loss: 0.0063 - acc: 1.0000
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0058 - acc: 1.0000
1280/1283 [============================>.] - ETA: 0s - loss: 0.0064 - acc: 0.9992
1283/1283 [==============================] - 0s 276us/step - loss: 0.0064 - acc: 0.9992 - val_loss: 1.5199 - val_acc: 0.5808

Epoch 00029: val_acc did not improve
Epoch 30/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0035 - acc: 1.0000
 256/1283 [====>.........................] - ETA: 0s - loss: 0.0059 - acc: 1.0000
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0058 - acc: 1.0000
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0054 - acc: 1.0000
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0050 - acc: 1.0000
1280/1283 [============================>.] - ETA: 0s - loss: 0.0058 - acc: 0.9992
1283/1283 [==============================] - 0s 237us/step - loss: 0.0057 - acc: 0.9992 - val_loss: 1.5456 - val_acc: 0.5721

Epoch 00030: val_acc did not improve
Epoch 31/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0045 - acc: 1.0000
 384/1283 [=======>......................] - ETA: 0s - loss: 0.0038 - acc: 1.0000
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0042 - acc: 1.0000
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0046 - acc: 1.0000
1283/1283 [==============================] - 0s 184us/step - loss: 0.0048 - acc: 1.0000 - val_loss: 1.5549 - val_acc: 0.5852

Epoch 00031: val_acc did not improve
Epoch 32/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0129 - acc: 1.0000
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0069 - acc: 1.0000
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0056 - acc: 1.0000
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0049 - acc: 1.0000
1283/1283 [==============================] - 0s 163us/step - loss: 0.0048 - acc: 1.0000 - val_loss: 1.5715 - val_acc: 0.5764

Epoch 00032: val_acc did not improve
Epoch 33/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0041 - acc: 1.0000
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0034 - acc: 1.0000
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0040 - acc: 1.0000
1280/1283 [============================>.] - ETA: 0s - loss: 0.0043 - acc: 1.0000
1283/1283 [==============================] - 0s 155us/step - loss: 0.0043 - acc: 1.0000 - val_loss: 1.5821 - val_acc: 0.5939

Epoch 00033: val_acc did not improve
Epoch 00033: early stopping
batch_size=64
batch_norm=False
dropout_rate=0.2
n_layers=1
max_len=20
nodes=100
mode=A
PCA audio=30
PCA visual=30
PCA text=100
accuracy=0.5189504373177842
best_valid_accuracy=0.5160349854227405
/afs/inf.ed.ac.uk/user/s17/s1738075/.local/lib/python2.7/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
pca_early_fusion_cnn.py:146: RuntimeWarning: invalid value encountered in divide
  train_set_audio = train_set_audio / audio_max
pca_early_fusion_cnn.py:148: RuntimeWarning: invalid value encountered in divide
  test_set_audio = test_set_audio / audio_max
2018-03-28 22:44:17.503335: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
This API will be deprecated in the future versions. Please check the Github page for the current API

Modality facet for video 8qrpnFRGt2A segment 13 is (partially) missing and is thus being replaced by zeros!

Train on 1283 samples, validate on 229 samples
Epoch 1/100

  64/1283 [>.............................] - ETA: 13s - loss: 0.8074 - acc: 0.4844
 320/1283 [======>.......................] - ETA: 2s - loss: 0.7801 - acc: 0.5156 
 512/1283 [==========>...................] - ETA: 1s - loss: 0.7903 - acc: 0.5020
 832/1283 [==================>...........] - ETA: 0s - loss: 0.7699 - acc: 0.5180
1088/1283 [========================>.....] - ETA: 0s - loss: 0.7491 - acc: 0.5322
1283/1283 [==============================] - 1s 918us/step - loss: 0.7446 - acc: 0.5331 - val_loss: 0.7209 - val_acc: 0.4847

Epoch 00001: val_acc improved from -inf to 0.48472, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20.ckpt
Epoch 2/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.6196 - acc: 0.6250
 384/1283 [=======>......................] - ETA: 0s - loss: 0.6216 - acc: 0.6536
 576/1283 [============>.................] - ETA: 0s - loss: 0.6175 - acc: 0.6649
 768/1283 [================>.............] - ETA: 0s - loss: 0.6148 - acc: 0.6654
 960/1283 [=====================>........] - ETA: 0s - loss: 0.6117 - acc: 0.6698
1152/1283 [=========================>....] - ETA: 0s - loss: 0.6155 - acc: 0.6658
1283/1283 [==============================] - 0s 316us/step - loss: 0.6170 - acc: 0.6602 - val_loss: 0.7148 - val_acc: 0.5328

Epoch 00002: val_acc improved from 0.48472 to 0.53275, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20.ckpt
Epoch 3/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5525 - acc: 0.7188
 256/1283 [====>.........................] - ETA: 0s - loss: 0.5528 - acc: 0.7148
 448/1283 [=========>....................] - ETA: 0s - loss: 0.5423 - acc: 0.7366
 640/1283 [=============>................] - ETA: 0s - loss: 0.5619 - acc: 0.7156
 768/1283 [================>.............] - ETA: 0s - loss: 0.5624 - acc: 0.7135
 832/1283 [==================>...........] - ETA: 0s - loss: 0.5625 - acc: 0.7127
1088/1283 [========================>.....] - ETA: 0s - loss: 0.5631 - acc: 0.7077
1216/1283 [===========================>..] - ETA: 0s - loss: 0.5667 - acc: 0.7039
1283/1283 [==============================] - 1s 414us/step - loss: 0.5662 - acc: 0.7054 - val_loss: 0.7325 - val_acc: 0.5066

Epoch 00003: val_acc did not improve
Epoch 4/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.4618 - acc: 0.8594
 256/1283 [====>.........................] - ETA: 0s - loss: 0.4962 - acc: 0.7852
 384/1283 [=======>......................] - ETA: 0s - loss: 0.4849 - acc: 0.7891
 512/1283 [==========>...................] - ETA: 0s - loss: 0.4894 - acc: 0.7871
 640/1283 [=============>................] - ETA: 0s - loss: 0.4965 - acc: 0.7750
 832/1283 [==================>...........] - ETA: 0s - loss: 0.4956 - acc: 0.7861
 960/1283 [=====================>........] - ETA: 0s - loss: 0.4961 - acc: 0.7833
1152/1283 [=========================>....] - ETA: 0s - loss: 0.4969 - acc: 0.7830
1283/1283 [==============================] - 1s 412us/step - loss: 0.4945 - acc: 0.7872 - val_loss: 0.7877 - val_acc: 0.5284

Epoch 00004: val_acc did not improve
Epoch 5/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.4265 - acc: 0.8438
 256/1283 [====>.........................] - ETA: 0s - loss: 0.4335 - acc: 0.8242
 512/1283 [==========>...................] - ETA: 0s - loss: 0.4336 - acc: 0.8184
 640/1283 [=============>................] - ETA: 0s - loss: 0.4429 - acc: 0.8125
 832/1283 [==================>...........] - ETA: 0s - loss: 0.4335 - acc: 0.8209
1088/1283 [========================>.....] - ETA: 0s - loss: 0.4368 - acc: 0.8171
1216/1283 [===========================>..] - ETA: 0s - loss: 0.4394 - acc: 0.8141
1283/1283 [==============================] - 0s 378us/step - loss: 0.4400 - acc: 0.8145 - val_loss: 0.8026 - val_acc: 0.5459

Epoch 00005: val_acc improved from 0.53275 to 0.54585, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20.ckpt
Epoch 6/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.3710 - acc: 0.8750
 384/1283 [=======>......................] - ETA: 0s - loss: 0.3613 - acc: 0.8802
 640/1283 [=============>................] - ETA: 0s - loss: 0.3585 - acc: 0.8750
 896/1283 [===================>..........] - ETA: 0s - loss: 0.3742 - acc: 0.8594
1088/1283 [========================>.....] - ETA: 0s - loss: 0.3693 - acc: 0.8594
1280/1283 [============================>.] - ETA: 0s - loss: 0.3666 - acc: 0.8609
1283/1283 [==============================] - 0s 278us/step - loss: 0.3671 - acc: 0.8605 - val_loss: 0.8397 - val_acc: 0.5153

Epoch 00006: val_acc did not improve
Epoch 7/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.3710 - acc: 0.8438
 256/1283 [====>.........................] - ETA: 0s - loss: 0.3203 - acc: 0.8984
 512/1283 [==========>...................] - ETA: 0s - loss: 0.3206 - acc: 0.8809
 704/1283 [===============>..............] - ETA: 0s - loss: 0.3295 - acc: 0.8750
 832/1283 [==================>...........] - ETA: 0s - loss: 0.3304 - acc: 0.8798
1088/1283 [========================>.....] - ETA: 0s - loss: 0.3246 - acc: 0.8915
1283/1283 [==============================] - 0s 341us/step - loss: 0.3247 - acc: 0.8901 - val_loss: 0.9151 - val_acc: 0.5459

Epoch 00007: val_acc improved from 0.54585 to 0.54585, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20.ckpt
Epoch 8/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.3056 - acc: 0.8750
 320/1283 [======>.......................] - ETA: 0s - loss: 0.2787 - acc: 0.9031
 512/1283 [==========>...................] - ETA: 0s - loss: 0.2635 - acc: 0.9297
 640/1283 [=============>................] - ETA: 0s - loss: 0.2750 - acc: 0.9203
 896/1283 [===================>..........] - ETA: 0s - loss: 0.2843 - acc: 0.9096
1216/1283 [===========================>..] - ETA: 0s - loss: 0.2932 - acc: 0.8972
1283/1283 [==============================] - 0s 335us/step - loss: 0.2930 - acc: 0.8979 - val_loss: 0.8835 - val_acc: 0.5415

Epoch 00008: val_acc did not improve
Epoch 9/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1827 - acc: 0.9531
 320/1283 [======>.......................] - ETA: 0s - loss: 0.2532 - acc: 0.9125
 576/1283 [============>.................] - ETA: 0s - loss: 0.2442 - acc: 0.9184
 896/1283 [===================>..........] - ETA: 0s - loss: 0.2382 - acc: 0.9219
1280/1283 [============================>.] - ETA: 0s - loss: 0.2397 - acc: 0.9234
1283/1283 [==============================] - 0s 195us/step - loss: 0.2399 - acc: 0.9228 - val_loss: 0.9437 - val_acc: 0.5459

Epoch 00009: val_acc did not improve
Epoch 10/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1988 - acc: 0.9688
 320/1283 [======>.......................] - ETA: 0s - loss: 0.1809 - acc: 0.9688
 640/1283 [=============>................] - ETA: 0s - loss: 0.1812 - acc: 0.9641
 960/1283 [=====================>........] - ETA: 0s - loss: 0.1865 - acc: 0.9604
1216/1283 [===========================>..] - ETA: 0s - loss: 0.1810 - acc: 0.9655
1283/1283 [==============================] - 0s 213us/step - loss: 0.1803 - acc: 0.9657 - val_loss: 1.0183 - val_acc: 0.5371

Epoch 00010: val_acc did not improve
Epoch 11/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1143 - acc: 0.9844
 384/1283 [=======>......................] - ETA: 0s - loss: 0.1307 - acc: 0.9844
 768/1283 [================>.............] - ETA: 0s - loss: 0.1368 - acc: 0.9844
1088/1283 [========================>.....] - ETA: 0s - loss: 0.1395 - acc: 0.9789
1283/1283 [==============================] - 0s 191us/step - loss: 0.1404 - acc: 0.9751 - val_loss: 1.0822 - val_acc: 0.5284

Epoch 00011: val_acc did not improve
Epoch 12/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1012 - acc: 1.0000
 384/1283 [=======>......................] - ETA: 0s - loss: 0.1148 - acc: 0.9870
 704/1283 [===============>..............] - ETA: 0s - loss: 0.1171 - acc: 0.9844
1024/1283 [======================>.......] - ETA: 0s - loss: 0.1153 - acc: 0.9834
1283/1283 [==============================] - 0s 190us/step - loss: 0.1188 - acc: 0.9813 - val_loss: 1.1445 - val_acc: 0.5546

Epoch 00012: val_acc improved from 0.54585 to 0.55459, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20.ckpt
Epoch 13/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0789 - acc: 0.9844
 384/1283 [=======>......................] - ETA: 0s - loss: 0.0840 - acc: 0.9948
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0921 - acc: 0.9858
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0887 - acc: 0.9890
1283/1283 [==============================] - 0s 194us/step - loss: 0.0892 - acc: 0.9891 - val_loss: 1.1910 - val_acc: 0.5415

Epoch 00013: val_acc did not improve
Epoch 14/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0847 - acc: 1.0000
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0691 - acc: 0.9978
 768/1283 [================>.............] - ETA: 0s - loss: 0.0684 - acc: 0.9974
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0717 - acc: 0.9936
1283/1283 [==============================] - 0s 180us/step - loss: 0.0733 - acc: 0.9938 - val_loss: 1.3548 - val_acc: 0.5371

Epoch 00014: val_acc did not improve
Epoch 15/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0581 - acc: 1.0000
 384/1283 [=======>......................] - ETA: 0s - loss: 0.0575 - acc: 0.9948
 640/1283 [=============>................] - ETA: 0s - loss: 0.0546 - acc: 0.9953
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0542 - acc: 0.9958
1283/1283 [==============================] - 0s 217us/step - loss: 0.0559 - acc: 0.9945 - val_loss: 1.2638 - val_acc: 0.5677

Epoch 00015: val_acc improved from 0.55459 to 0.56769, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_1_ml_20.ckpt
Epoch 16/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0499 - acc: 1.0000
 512/1283 [==========>...................] - ETA: 0s - loss: 0.0478 - acc: 1.0000
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0461 - acc: 1.0000
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0449 - acc: 0.9992
1283/1283 [==============================] - 0s 179us/step - loss: 0.0440 - acc: 0.9992 - val_loss: 1.4532 - val_acc: 0.5502

Epoch 00016: val_acc did not improve
Epoch 17/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0233 - acc: 1.0000
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0303 - acc: 1.0000
 768/1283 [================>.............] - ETA: 0s - loss: 0.0317 - acc: 0.9987
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0322 - acc: 0.9990
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0320 - acc: 0.9984
1283/1283 [==============================] - 0s 197us/step - loss: 0.0321 - acc: 0.9984 - val_loss: 1.4727 - val_acc: 0.5459

Epoch 00017: val_acc did not improve
Epoch 18/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0147 - acc: 1.0000
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0223 - acc: 1.0000
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0242 - acc: 0.9986
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0243 - acc: 0.9982
1283/1283 [==============================] - 0s 166us/step - loss: 0.0248 - acc: 0.9984 - val_loss: 1.4827 - val_acc: 0.5590

Epoch 00018: val_acc did not improve
Epoch 19/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0225 - acc: 1.0000
 512/1283 [==========>...................] - ETA: 0s - loss: 0.0329 - acc: 1.0000
 896/1283 [===================>..........] - ETA: 0s - loss: 0.0340 - acc: 0.9989
1283/1283 [==============================] - 0s 142us/step - loss: 0.0318 - acc: 0.9984 - val_loss: 1.6051 - val_acc: 0.5328

Epoch 00019: val_acc did not improve
Epoch 20/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0222 - acc: 1.0000
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0254 - acc: 1.0000
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0284 - acc: 0.9976
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0283 - acc: 0.9980
1283/1283 [==============================] - 0s 188us/step - loss: 0.0297 - acc: 0.9969 - val_loss: 1.8666 - val_acc: 0.5284

Epoch 00020: val_acc did not improve
Epoch 21/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0315 - acc: 1.0000
 512/1283 [==========>...................] - ETA: 0s - loss: 0.1553 - acc: 0.9492
 960/1283 [=====================>........] - ETA: 0s - loss: 0.1276 - acc: 0.9604
1280/1283 [============================>.] - ETA: 0s - loss: 0.1141 - acc: 0.9656
1283/1283 [==============================] - 0s 161us/step - loss: 0.1139 - acc: 0.9657 - val_loss: 1.4191 - val_acc: 0.5502

Epoch 00021: val_acc did not improve
Epoch 22/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0451 - acc: 0.9844
 384/1283 [=======>......................] - ETA: 0s - loss: 0.0316 - acc: 0.9974
 576/1283 [============>.................] - ETA: 0s - loss: 0.0430 - acc: 0.9913
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0384 - acc: 0.9938
1283/1283 [==============================] - 0s 186us/step - loss: 0.0371 - acc: 0.9938 - val_loss: 1.7337 - val_acc: 0.5197

Epoch 00022: val_acc did not improve
Epoch 23/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0145 - acc: 1.0000
 384/1283 [=======>......................] - ETA: 0s - loss: 0.0251 - acc: 1.0000
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0220 - acc: 1.0000
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0212 - acc: 1.0000
1283/1283 [==============================] - 0s 197us/step - loss: 0.0206 - acc: 0.9992 - val_loss: 1.7483 - val_acc: 0.5240

Epoch 00023: val_acc did not improve
Epoch 24/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0105 - acc: 1.0000
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0122 - acc: 0.9978
 896/1283 [===================>..........] - ETA: 0s - loss: 0.0120 - acc: 0.9989
1283/1283 [==============================] - 0s 134us/step - loss: 0.0117 - acc: 0.9992 - val_loss: 1.7574 - val_acc: 0.5459

Epoch 00024: val_acc did not improve
Epoch 25/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0085 - acc: 1.0000
 512/1283 [==========>...................] - ETA: 0s - loss: 0.0099 - acc: 0.9980
 896/1283 [===================>..........] - ETA: 0s - loss: 0.0089 - acc: 0.9989
1280/1283 [============================>.] - ETA: 0s - loss: 0.0093 - acc: 0.9984
1283/1283 [==============================] - 0s 141us/step - loss: 0.0093 - acc: 0.9984 - val_loss: 1.8581 - val_acc: 0.5371

Epoch 00025: val_acc did not improve
Epoch 00025: early stopping
batch_size=64
batch_norm=False
dropout_rate=0.2
n_layers=1
max_len=20
nodes=100
mode=A
PCA audio=30
PCA visual=35
PCA text=100
accuracy=0.49854227405247814
best_valid_accuracy=0.521865889212828
