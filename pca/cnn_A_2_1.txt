/afs/inf.ed.ac.uk/user/s17/s1738075/.local/lib/python2.7/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
pca_early_fusion_cnn.py:146: RuntimeWarning: invalid value encountered in divide
  train_set_audio = train_set_audio / audio_max
pca_early_fusion_cnn.py:148: RuntimeWarning: invalid value encountered in divide
  test_set_audio = test_set_audio / audio_max
2018-03-28 21:48:19.201360: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
This API will be deprecated in the future versions. Please check the Github page for the current API

Modality facet for video 8qrpnFRGt2A segment 13 is (partially) missing and is thus being replaced by zeros!

Train on 1283 samples, validate on 229 samples
Epoch 1/100

  64/1283 [>.............................] - ETA: 4s - loss: 0.7931 - acc: 0.4219
 192/1283 [===>..........................] - ETA: 1s - loss: 0.7662 - acc: 0.4844
 384/1283 [=======>......................] - ETA: 0s - loss: 0.7618 - acc: 0.4740
 512/1283 [==========>...................] - ETA: 0s - loss: 0.7496 - acc: 0.4805
 640/1283 [=============>................] - ETA: 0s - loss: 0.7356 - acc: 0.5047
 768/1283 [================>.............] - ETA: 0s - loss: 0.7320 - acc: 0.5104
 832/1283 [==================>...........] - ETA: 0s - loss: 0.7306 - acc: 0.5120
 960/1283 [=====================>........] - ETA: 0s - loss: 0.7292 - acc: 0.5115
1152/1283 [=========================>....] - ETA: 0s - loss: 0.7269 - acc: 0.5078
1280/1283 [============================>.] - ETA: 0s - loss: 0.7225 - acc: 0.5141
1283/1283 [==============================] - 1s 862us/step - loss: 0.7223 - acc: 0.5152 - val_loss: 0.6920 - val_acc: 0.5502

Epoch 00001: val_acc improved from -inf to 0.55022, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_2_ml_15/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_2_ml_15.ckpt
Epoch 2/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.6777 - acc: 0.5625
 192/1283 [===>..........................] - ETA: 0s - loss: 0.6612 - acc: 0.6198
 320/1283 [======>.......................] - ETA: 0s - loss: 0.6674 - acc: 0.6219
 384/1283 [=======>......................] - ETA: 0s - loss: 0.6676 - acc: 0.6172
 512/1283 [==========>...................] - ETA: 0s - loss: 0.6724 - acc: 0.6035
 576/1283 [============>.................] - ETA: 0s - loss: 0.6717 - acc: 0.6076
 704/1283 [===============>..............] - ETA: 0s - loss: 0.6680 - acc: 0.6080
 832/1283 [==================>...........] - ETA: 0s - loss: 0.6651 - acc: 0.6106
 960/1283 [=====================>........] - ETA: 0s - loss: 0.6675 - acc: 0.5979
1088/1283 [========================>.....] - ETA: 0s - loss: 0.6675 - acc: 0.5956
1152/1283 [=========================>....] - ETA: 0s - loss: 0.6694 - acc: 0.5938
1216/1283 [===========================>..] - ETA: 0s - loss: 0.6670 - acc: 0.5995
1283/1283 [==============================] - 1s 988us/step - loss: 0.6670 - acc: 0.6009 - val_loss: 0.6910 - val_acc: 0.5808

Epoch 00002: val_acc improved from 0.55022 to 0.58079, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_2_ml_15/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_2_ml_15.ckpt
Epoch 3/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.6937 - acc: 0.5312
 256/1283 [====>.........................] - ETA: 0s - loss: 0.6703 - acc: 0.5859
 384/1283 [=======>......................] - ETA: 0s - loss: 0.6618 - acc: 0.6016
 512/1283 [==========>...................] - ETA: 0s - loss: 0.6571 - acc: 0.6094
 640/1283 [=============>................] - ETA: 0s - loss: 0.6578 - acc: 0.6031
 768/1283 [================>.............] - ETA: 0s - loss: 0.6557 - acc: 0.6172
 832/1283 [==================>...........] - ETA: 0s - loss: 0.6552 - acc: 0.6178
 960/1283 [=====================>........] - ETA: 0s - loss: 0.6556 - acc: 0.6125
1088/1283 [========================>.....] - ETA: 0s - loss: 0.6517 - acc: 0.6195
1152/1283 [=========================>....] - ETA: 0s - loss: 0.6503 - acc: 0.6233
1280/1283 [============================>.] - ETA: 0s - loss: 0.6461 - acc: 0.6328
1283/1283 [==============================] - 1s 642us/step - loss: 0.6460 - acc: 0.6329 - val_loss: 0.6880 - val_acc: 0.5197

Epoch 00003: val_acc did not improve
Epoch 4/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.6704 - acc: 0.5625
 192/1283 [===>..........................] - ETA: 0s - loss: 0.6237 - acc: 0.6198
 320/1283 [======>.......................] - ETA: 0s - loss: 0.6319 - acc: 0.6188
 512/1283 [==========>...................] - ETA: 0s - loss: 0.6306 - acc: 0.6211
 704/1283 [===============>..............] - ETA: 0s - loss: 0.6268 - acc: 0.6321
 832/1283 [==================>...........] - ETA: 0s - loss: 0.6294 - acc: 0.6334
 896/1283 [===================>..........] - ETA: 0s - loss: 0.6311 - acc: 0.6328
1024/1283 [======================>.......] - ETA: 0s - loss: 0.6280 - acc: 0.6406
1152/1283 [=========================>....] - ETA: 0s - loss: 0.6308 - acc: 0.6345
1280/1283 [============================>.] - ETA: 0s - loss: 0.6276 - acc: 0.6414
1283/1283 [==============================] - 1s 724us/step - loss: 0.6281 - acc: 0.6407 - val_loss: 0.6872 - val_acc: 0.5677

Epoch 00004: val_acc did not improve
Epoch 5/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.6111 - acc: 0.6406
 128/1283 [=>............................] - ETA: 0s - loss: 0.6029 - acc: 0.6875
 192/1283 [===>..........................] - ETA: 1s - loss: 0.6075 - acc: 0.6823
 320/1283 [======>.......................] - ETA: 1s - loss: 0.5963 - acc: 0.7063
 384/1283 [=======>......................] - ETA: 1s - loss: 0.5908 - acc: 0.7135
 448/1283 [=========>....................] - ETA: 1s - loss: 0.5977 - acc: 0.7031
 576/1283 [============>.................] - ETA: 0s - loss: 0.6016 - acc: 0.7014
 704/1283 [===============>..............] - ETA: 0s - loss: 0.6087 - acc: 0.6918
 832/1283 [==================>...........] - ETA: 0s - loss: 0.6083 - acc: 0.6899
1024/1283 [======================>.......] - ETA: 0s - loss: 0.6064 - acc: 0.6982
1152/1283 [=========================>....] - ETA: 0s - loss: 0.6047 - acc: 0.6962
1280/1283 [============================>.] - ETA: 0s - loss: 0.6026 - acc: 0.6953
1283/1283 [==============================] - 1s 828us/step - loss: 0.6027 - acc: 0.6952 - val_loss: 0.6907 - val_acc: 0.5677

Epoch 00005: val_acc did not improve
Epoch 6/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5844 - acc: 0.6719
 128/1283 [=>............................] - ETA: 1s - loss: 0.6052 - acc: 0.6406
 256/1283 [====>.........................] - ETA: 0s - loss: 0.5772 - acc: 0.6836
 384/1283 [=======>......................] - ETA: 0s - loss: 0.5860 - acc: 0.6797
 512/1283 [==========>...................] - ETA: 0s - loss: 0.5877 - acc: 0.6855
 640/1283 [=============>................] - ETA: 0s - loss: 0.5886 - acc: 0.6813
 768/1283 [================>.............] - ETA: 0s - loss: 0.5781 - acc: 0.6953
 896/1283 [===================>..........] - ETA: 0s - loss: 0.5815 - acc: 0.6908
 960/1283 [=====================>........] - ETA: 0s - loss: 0.5801 - acc: 0.6906
1024/1283 [======================>.......] - ETA: 0s - loss: 0.5819 - acc: 0.6924
1088/1283 [========================>.....] - ETA: 0s - loss: 0.5816 - acc: 0.6921
1216/1283 [===========================>..] - ETA: 0s - loss: 0.5792 - acc: 0.6933
1283/1283 [==============================] - 1s 924us/step - loss: 0.5860 - acc: 0.6890 - val_loss: 0.6951 - val_acc: 0.5721

Epoch 00006: val_acc did not improve
Epoch 7/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5458 - acc: 0.7344
 192/1283 [===>..........................] - ETA: 0s - loss: 0.5414 - acc: 0.7604
 320/1283 [======>.......................] - ETA: 0s - loss: 0.5649 - acc: 0.7219
 448/1283 [=========>....................] - ETA: 0s - loss: 0.5704 - acc: 0.7098
 512/1283 [==========>...................] - ETA: 0s - loss: 0.5605 - acc: 0.7246
 576/1283 [============>.................] - ETA: 0s - loss: 0.5544 - acc: 0.7361
 704/1283 [===============>..............] - ETA: 0s - loss: 0.5534 - acc: 0.7358
 896/1283 [===================>..........] - ETA: 0s - loss: 0.5473 - acc: 0.7411
1024/1283 [======================>.......] - ETA: 0s - loss: 0.5467 - acc: 0.7373
1152/1283 [=========================>....] - ETA: 0s - loss: 0.5425 - acc: 0.7405
1216/1283 [===========================>..] - ETA: 0s - loss: 0.5395 - acc: 0.7451
1280/1283 [============================>.] - ETA: 0s - loss: 0.5379 - acc: 0.7477
1283/1283 [==============================] - 1s 838us/step - loss: 0.5381 - acc: 0.7475 - val_loss: 0.7311 - val_acc: 0.5677

Epoch 00007: val_acc did not improve
Epoch 8/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.4475 - acc: 0.8750
 192/1283 [===>..........................] - ETA: 0s - loss: 0.4623 - acc: 0.8333
 320/1283 [======>.......................] - ETA: 0s - loss: 0.4720 - acc: 0.8219
 448/1283 [=========>....................] - ETA: 0s - loss: 0.4779 - acc: 0.8125
 512/1283 [==========>...................] - ETA: 0s - loss: 0.4820 - acc: 0.8066
 640/1283 [=============>................] - ETA: 0s - loss: 0.4877 - acc: 0.7953
 704/1283 [===============>..............] - ETA: 0s - loss: 0.4852 - acc: 0.7940
 768/1283 [================>.............] - ETA: 0s - loss: 0.4878 - acc: 0.7917
 832/1283 [==================>...........] - ETA: 0s - loss: 0.4810 - acc: 0.7993
1024/1283 [======================>.......] - ETA: 0s - loss: 0.4771 - acc: 0.7998
1152/1283 [=========================>....] - ETA: 0s - loss: 0.4758 - acc: 0.8021
1280/1283 [============================>.] - ETA: 0s - loss: 0.4745 - acc: 0.8031
1283/1283 [==============================] - 1s 877us/step - loss: 0.4754 - acc: 0.8020 - val_loss: 0.7386 - val_acc: 0.6157

Epoch 00008: val_acc improved from 0.58079 to 0.61572, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_2_ml_15/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_2_ml_15.ckpt
Epoch 9/100

  64/1283 [>.............................] - ETA: 2s - loss: 0.4228 - acc: 0.8594
 192/1283 [===>..........................] - ETA: 1s - loss: 0.4129 - acc: 0.8333
 320/1283 [======>.......................] - ETA: 0s - loss: 0.4246 - acc: 0.8313
 384/1283 [=======>......................] - ETA: 0s - loss: 0.4173 - acc: 0.8307
 448/1283 [=========>....................] - ETA: 0s - loss: 0.4205 - acc: 0.8259
 512/1283 [==========>...................] - ETA: 0s - loss: 0.4214 - acc: 0.8301
 640/1283 [=============>................] - ETA: 0s - loss: 0.4343 - acc: 0.8203
 704/1283 [===============>..............] - ETA: 0s - loss: 0.4350 - acc: 0.8182
 832/1283 [==================>...........] - ETA: 0s - loss: 0.4327 - acc: 0.8209
 960/1283 [=====================>........] - ETA: 0s - loss: 0.4389 - acc: 0.8177
1088/1283 [========================>.....] - ETA: 0s - loss: 0.4365 - acc: 0.8208
1216/1283 [===========================>..] - ETA: 0s - loss: 0.4296 - acc: 0.8281
1283/1283 [==============================] - 1s 975us/step - loss: 0.4288 - acc: 0.8285 - val_loss: 0.7699 - val_acc: 0.5983

Epoch 00009: val_acc did not improve
Epoch 10/100

  64/1283 [>.............................] - ETA: 3s - loss: 0.3647 - acc: 0.8906
 128/1283 [=>............................] - ETA: 2s - loss: 0.3649 - acc: 0.8828
 192/1283 [===>..........................] - ETA: 1s - loss: 0.4016 - acc: 0.8333
 320/1283 [======>.......................] - ETA: 1s - loss: 0.4392 - acc: 0.8031
 384/1283 [=======>......................] - ETA: 1s - loss: 0.4314 - acc: 0.8021
 512/1283 [==========>...................] - ETA: 0s - loss: 0.4240 - acc: 0.8027
 640/1283 [=============>................] - ETA: 0s - loss: 0.4170 - acc: 0.8125
 768/1283 [================>.............] - ETA: 0s - loss: 0.4049 - acc: 0.8255
 832/1283 [==================>...........] - ETA: 0s - loss: 0.4120 - acc: 0.8161
 896/1283 [===================>..........] - ETA: 0s - loss: 0.4056 - acc: 0.8214
1024/1283 [======================>.......] - ETA: 0s - loss: 0.3994 - acc: 0.8242
1152/1283 [=========================>....] - ETA: 0s - loss: 0.3912 - acc: 0.8307
1283/1283 [==============================] - 1s 1ms/step - loss: 0.3908 - acc: 0.8316 - val_loss: 0.8498 - val_acc: 0.5284

Epoch 00010: val_acc did not improve
Epoch 11/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.3361 - acc: 0.8594
 192/1283 [===>..........................] - ETA: 0s - loss: 0.3595 - acc: 0.8177
 320/1283 [======>.......................] - ETA: 0s - loss: 0.3387 - acc: 0.8469
 384/1283 [=======>......................] - ETA: 0s - loss: 0.3348 - acc: 0.8568
 512/1283 [==========>...................] - ETA: 0s - loss: 0.3447 - acc: 0.8555
 640/1283 [=============>................] - ETA: 0s - loss: 0.3426 - acc: 0.8578
 768/1283 [================>.............] - ETA: 0s - loss: 0.3416 - acc: 0.8568
 896/1283 [===================>..........] - ETA: 0s - loss: 0.3405 - acc: 0.8538
 960/1283 [=====================>........] - ETA: 0s - loss: 0.3407 - acc: 0.8562
1024/1283 [======================>.......] - ETA: 0s - loss: 0.3423 - acc: 0.8545
1088/1283 [========================>.....] - ETA: 0s - loss: 0.3452 - acc: 0.8502
1216/1283 [===========================>..] - ETA: 0s - loss: 0.3448 - acc: 0.8503
1283/1283 [==============================] - 1s 913us/step - loss: 0.3447 - acc: 0.8496 - val_loss: 1.0515 - val_acc: 0.5371

Epoch 00011: val_acc did not improve
Epoch 12/100

  64/1283 [>.............................] - ETA: 4s - loss: 0.4380 - acc: 0.7812
 128/1283 [=>............................] - ETA: 2s - loss: 0.4179 - acc: 0.8125
 256/1283 [====>.........................] - ETA: 1s - loss: 0.3681 - acc: 0.8281
 320/1283 [======>.......................] - ETA: 1s - loss: 0.3508 - acc: 0.8500
 448/1283 [=========>....................] - ETA: 0s - loss: 0.3356 - acc: 0.8549
 576/1283 [============>.................] - ETA: 0s - loss: 0.3277 - acc: 0.8576
 704/1283 [===============>..............] - ETA: 0s - loss: 0.3165 - acc: 0.8665
 832/1283 [==================>...........] - ETA: 0s - loss: 0.3125 - acc: 0.8750
 960/1283 [=====================>........] - ETA: 0s - loss: 0.3094 - acc: 0.8760
1088/1283 [========================>.....] - ETA: 0s - loss: 0.3193 - acc: 0.8686
1152/1283 [=========================>....] - ETA: 0s - loss: 0.3174 - acc: 0.8733
1280/1283 [============================>.] - ETA: 0s - loss: 0.3236 - acc: 0.8703
1283/1283 [==============================] - 1s 1ms/step - loss: 0.3251 - acc: 0.8691 - val_loss: 0.8880 - val_acc: 0.5895

Epoch 00012: val_acc did not improve
Epoch 13/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.2674 - acc: 0.8906
 192/1283 [===>..........................] - ETA: 0s - loss: 0.2914 - acc: 0.8698
 320/1283 [======>.......................] - ETA: 0s - loss: 0.3404 - acc: 0.8313
 448/1283 [=========>....................] - ETA: 0s - loss: 0.3493 - acc: 0.8348
 576/1283 [============>.................] - ETA: 0s - loss: 0.3484 - acc: 0.8351
 768/1283 [================>.............] - ETA: 0s - loss: 0.3492 - acc: 0.8438
 896/1283 [===================>..........] - ETA: 0s - loss: 0.3467 - acc: 0.8415
1088/1283 [========================>.....] - ETA: 0s - loss: 0.3381 - acc: 0.8447
1216/1283 [===========================>..] - ETA: 0s - loss: 0.3285 - acc: 0.8528
1283/1283 [==============================] - 1s 583us/step - loss: 0.3256 - acc: 0.8566 - val_loss: 0.9574 - val_acc: 0.5677

Epoch 00013: val_acc did not improve
Epoch 14/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.2178 - acc: 0.9375
 192/1283 [===>..........................] - ETA: 0s - loss: 0.2493 - acc: 0.9219
 320/1283 [======>.......................] - ETA: 0s - loss: 0.2333 - acc: 0.9375
 448/1283 [=========>....................] - ETA: 0s - loss: 0.2359 - acc: 0.9263
 576/1283 [============>.................] - ETA: 0s - loss: 0.2328 - acc: 0.9219
 704/1283 [===============>..............] - ETA: 0s - loss: 0.2275 - acc: 0.9233
 832/1283 [==================>...........] - ETA: 0s - loss: 0.2243 - acc: 0.9255
 896/1283 [===================>..........] - ETA: 0s - loss: 0.2276 - acc: 0.9219
1024/1283 [======================>.......] - ETA: 0s - loss: 0.2256 - acc: 0.9238
1152/1283 [=========================>....] - ETA: 0s - loss: 0.2218 - acc: 0.9253
1216/1283 [===========================>..] - ETA: 0s - loss: 0.2199 - acc: 0.9252
1283/1283 [==============================] - 1s 810us/step - loss: 0.2195 - acc: 0.9260 - val_loss: 0.9875 - val_acc: 0.5677

Epoch 00014: val_acc did not improve
Epoch 15/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1571 - acc: 0.9688
 128/1283 [=>............................] - ETA: 0s - loss: 0.1597 - acc: 0.9609
 192/1283 [===>..........................] - ETA: 0s - loss: 0.1724 - acc: 0.9427
 320/1283 [======>.......................] - ETA: 0s - loss: 0.1557 - acc: 0.9594
 448/1283 [=========>....................] - ETA: 0s - loss: 0.1576 - acc: 0.9554
 512/1283 [==========>...................] - ETA: 0s - loss: 0.1619 - acc: 0.9531
 576/1283 [============>.................] - ETA: 0s - loss: 0.1612 - acc: 0.9566
 640/1283 [=============>................] - ETA: 0s - loss: 0.1605 - acc: 0.9563
 768/1283 [================>.............] - ETA: 0s - loss: 0.1719 - acc: 0.9453
 832/1283 [==================>...........] - ETA: 0s - loss: 0.1672 - acc: 0.9483
 896/1283 [===================>..........] - ETA: 0s - loss: 0.1694 - acc: 0.9498
1024/1283 [======================>.......] - ETA: 0s - loss: 0.1682 - acc: 0.9512
1152/1283 [=========================>....] - ETA: 0s - loss: 0.1713 - acc: 0.9479
1280/1283 [============================>.] - ETA: 0s - loss: 0.1697 - acc: 0.9484
1283/1283 [==============================] - 1s 955us/step - loss: 0.1699 - acc: 0.9486 - val_loss: 1.0766 - val_acc: 0.5764

Epoch 00015: val_acc did not improve
Epoch 16/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1537 - acc: 0.9531
 192/1283 [===>..........................] - ETA: 0s - loss: 0.1406 - acc: 0.9740
 384/1283 [=======>......................] - ETA: 0s - loss: 0.1519 - acc: 0.9557
 512/1283 [==========>...................] - ETA: 0s - loss: 0.1551 - acc: 0.9492
 576/1283 [============>.................] - ETA: 0s - loss: 0.1502 - acc: 0.9514
 640/1283 [=============>................] - ETA: 0s - loss: 0.1518 - acc: 0.9500
 704/1283 [===============>..............] - ETA: 0s - loss: 0.1484 - acc: 0.9517
 832/1283 [==================>...........] - ETA: 0s - loss: 0.1475 - acc: 0.9531
 896/1283 [===================>..........] - ETA: 0s - loss: 0.1426 - acc: 0.9565
 960/1283 [=====================>........] - ETA: 0s - loss: 0.1416 - acc: 0.9583
1024/1283 [======================>.......] - ETA: 0s - loss: 0.1423 - acc: 0.9570
1152/1283 [=========================>....] - ETA: 0s - loss: 0.1430 - acc: 0.9566
1280/1283 [============================>.] - ETA: 0s - loss: 0.1394 - acc: 0.9602
1283/1283 [==============================] - 1s 838us/step - loss: 0.1393 - acc: 0.9602 - val_loss: 1.1534 - val_acc: 0.5983

Epoch 00016: val_acc did not improve
Epoch 17/100

  64/1283 [>.............................] - ETA: 3s - loss: 0.0815 - acc: 1.0000
 192/1283 [===>..........................] - ETA: 1s - loss: 0.1676 - acc: 0.9479
 320/1283 [======>.......................] - ETA: 1s - loss: 0.1795 - acc: 0.9344
 448/1283 [=========>....................] - ETA: 0s - loss: 0.1701 - acc: 0.9330
 576/1283 [============>.................] - ETA: 0s - loss: 0.1693 - acc: 0.9375
 704/1283 [===============>..............] - ETA: 0s - loss: 0.1633 - acc: 0.9403
 768/1283 [================>.............] - ETA: 0s - loss: 0.1630 - acc: 0.9414
 832/1283 [==================>...........] - ETA: 0s - loss: 0.1605 - acc: 0.9411
 960/1283 [=====================>........] - ETA: 0s - loss: 0.1518 - acc: 0.9479
1088/1283 [========================>.....] - ETA: 0s - loss: 0.1533 - acc: 0.9467
1216/1283 [===========================>..] - ETA: 0s - loss: 0.1532 - acc: 0.9474
1283/1283 [==============================] - 1s 916us/step - loss: 0.1509 - acc: 0.9470 - val_loss: 1.3738 - val_acc: 0.5240

Epoch 00017: val_acc did not improve
Epoch 18/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1350 - acc: 0.9219
 192/1283 [===>..........................] - ETA: 0s - loss: 0.2577 - acc: 0.8854
 320/1283 [======>.......................] - ETA: 0s - loss: 0.2062 - acc: 0.9125
 384/1283 [=======>......................] - ETA: 0s - loss: 0.1949 - acc: 0.9167
 448/1283 [=========>....................] - ETA: 0s - loss: 0.2175 - acc: 0.8973
 512/1283 [==========>...................] - ETA: 0s - loss: 0.2274 - acc: 0.8926
 640/1283 [=============>................] - ETA: 0s - loss: 0.2110 - acc: 0.9031
 768/1283 [================>.............] - ETA: 0s - loss: 0.2018 - acc: 0.9102
 832/1283 [==================>...........] - ETA: 0s - loss: 0.1982 - acc: 0.9147
 896/1283 [===================>..........] - ETA: 0s - loss: 0.1938 - acc: 0.9174
 960/1283 [=====================>........] - ETA: 0s - loss: 0.1920 - acc: 0.9219
1024/1283 [======================>.......] - ETA: 0s - loss: 0.1890 - acc: 0.9229
1152/1283 [=========================>....] - ETA: 0s - loss: 0.1839 - acc: 0.9262
1280/1283 [============================>.] - ETA: 0s - loss: 0.1783 - acc: 0.9289
1283/1283 [==============================] - 1s 881us/step - loss: 0.1784 - acc: 0.9291 - val_loss: 1.2141 - val_acc: 0.5328

Epoch 00018: val_acc did not improve
Epoch 00018: early stopping
batch_size=64
batch_norm=False
dropout_rate=0.1
n_layers=2
max_len=15
nodes=100
mode=A
PCA audio=30
PCA visual=10
PCA text=100
accuracy=0.543731778425656
best_valid_accuracy=0.5233236151603499
/afs/inf.ed.ac.uk/user/s17/s1738075/.local/lib/python2.7/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
pca_early_fusion_cnn.py:146: RuntimeWarning: invalid value encountered in divide
  train_set_audio = train_set_audio / audio_max
pca_early_fusion_cnn.py:148: RuntimeWarning: invalid value encountered in divide
  test_set_audio = test_set_audio / audio_max
2018-03-28 21:56:01.712601: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
This API will be deprecated in the future versions. Please check the Github page for the current API

Modality facet for video 8qrpnFRGt2A segment 13 is (partially) missing and is thus being replaced by zeros!

Train on 1283 samples, validate on 229 samples
Epoch 1/100

  64/1283 [>.............................] - ETA: 6s - loss: 0.7535 - acc: 0.4844
 128/1283 [=>............................] - ETA: 4s - loss: 0.7425 - acc: 0.5078
 256/1283 [====>.........................] - ETA: 2s - loss: 0.7266 - acc: 0.5547
 384/1283 [=======>......................] - ETA: 1s - loss: 0.7167 - acc: 0.5365
 512/1283 [==========>...................] - ETA: 1s - loss: 0.7142 - acc: 0.5371
 640/1283 [=============>................] - ETA: 0s - loss: 0.7116 - acc: 0.5359
 768/1283 [================>.............] - ETA: 0s - loss: 0.7103 - acc: 0.5326
 832/1283 [==================>...........] - ETA: 0s - loss: 0.7104 - acc: 0.5264
 960/1283 [=====================>........] - ETA: 0s - loss: 0.7069 - acc: 0.5333
1024/1283 [======================>.......] - ETA: 0s - loss: 0.7073 - acc: 0.5303
1152/1283 [=========================>....] - ETA: 0s - loss: 0.7077 - acc: 0.5252
1216/1283 [===========================>..] - ETA: 0s - loss: 0.7068 - acc: 0.5263
1283/1283 [==============================] - 1s 1ms/step - loss: 0.7060 - acc: 0.5269 - val_loss: 0.6904 - val_acc: 0.5502

Epoch 00001: val_acc improved from -inf to 0.55022, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_2_ml_15/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_2_ml_15.ckpt
Epoch 2/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.6692 - acc: 0.5781
 192/1283 [===>..........................] - ETA: 0s - loss: 0.6677 - acc: 0.5990
 320/1283 [======>.......................] - ETA: 0s - loss: 0.6539 - acc: 0.6438
 512/1283 [==========>...................] - ETA: 0s - loss: 0.6559 - acc: 0.6367
 640/1283 [=============>................] - ETA: 0s - loss: 0.6569 - acc: 0.6250
 768/1283 [================>.............] - ETA: 0s - loss: 0.6568 - acc: 0.6276
 896/1283 [===================>..........] - ETA: 0s - loss: 0.6536 - acc: 0.6295
1024/1283 [======================>.......] - ETA: 0s - loss: 0.6517 - acc: 0.6367
1152/1283 [=========================>....] - ETA: 0s - loss: 0.6514 - acc: 0.6345
1216/1283 [===========================>..] - ETA: 0s - loss: 0.6502 - acc: 0.6382
1280/1283 [============================>.] - ETA: 0s - loss: 0.6493 - acc: 0.6406
1283/1283 [==============================] - 1s 654us/step - loss: 0.6492 - acc: 0.6407 - val_loss: 0.6934 - val_acc: 0.5109

Epoch 00002: val_acc did not improve
Epoch 3/100

  64/1283 [>.............................] - ETA: 1s - loss: 0.6251 - acc: 0.6875
 256/1283 [====>.........................] - ETA: 0s - loss: 0.6419 - acc: 0.6211
 384/1283 [=======>......................] - ETA: 0s - loss: 0.6223 - acc: 0.6536
 576/1283 [============>.................] - ETA: 0s - loss: 0.6260 - acc: 0.6493
 768/1283 [================>.............] - ETA: 0s - loss: 0.6208 - acc: 0.6510
 896/1283 [===================>..........] - ETA: 0s - loss: 0.6223 - acc: 0.6440
1024/1283 [======================>.......] - ETA: 0s - loss: 0.6242 - acc: 0.6416
1152/1283 [=========================>....] - ETA: 0s - loss: 0.6245 - acc: 0.6424
1283/1283 [==============================] - 1s 662us/step - loss: 0.6199 - acc: 0.6524 - val_loss: 0.6910 - val_acc: 0.5284

Epoch 00003: val_acc did not improve
Epoch 4/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5520 - acc: 0.7969
 192/1283 [===>..........................] - ETA: 0s - loss: 0.5702 - acc: 0.7135
 320/1283 [======>.......................] - ETA: 0s - loss: 0.5650 - acc: 0.7312
 384/1283 [=======>......................] - ETA: 0s - loss: 0.5599 - acc: 0.7396
 448/1283 [=========>....................] - ETA: 0s - loss: 0.5661 - acc: 0.7277
 512/1283 [==========>...................] - ETA: 0s - loss: 0.5651 - acc: 0.7344
 576/1283 [============>.................] - ETA: 0s - loss: 0.5659 - acc: 0.7344
 704/1283 [===============>..............] - ETA: 0s - loss: 0.5643 - acc: 0.7344
 832/1283 [==================>...........] - ETA: 0s - loss: 0.5656 - acc: 0.7284
1024/1283 [======================>.......] - ETA: 0s - loss: 0.5654 - acc: 0.7295
1152/1283 [=========================>....] - ETA: 0s - loss: 0.5672 - acc: 0.7240
1280/1283 [============================>.] - ETA: 0s - loss: 0.5682 - acc: 0.7195
1283/1283 [==============================] - 1s 683us/step - loss: 0.5677 - acc: 0.7202 - val_loss: 0.7045 - val_acc: 0.5633

Epoch 00004: val_acc improved from 0.55022 to 0.56332, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_2_ml_15/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_2_ml_15.ckpt
Epoch 5/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5362 - acc: 0.7188
 128/1283 [=>............................] - ETA: 0s - loss: 0.5674 - acc: 0.7031
 256/1283 [====>.........................] - ETA: 0s - loss: 0.5360 - acc: 0.7344
 384/1283 [=======>......................] - ETA: 0s - loss: 0.5336 - acc: 0.7396
 512/1283 [==========>...................] - ETA: 0s - loss: 0.5339 - acc: 0.7363
 640/1283 [=============>................] - ETA: 0s - loss: 0.5387 - acc: 0.7281
 768/1283 [================>.............] - ETA: 0s - loss: 0.5410 - acc: 0.7227
 896/1283 [===================>..........] - ETA: 0s - loss: 0.5321 - acc: 0.7344
1024/1283 [======================>.......] - ETA: 0s - loss: 0.5315 - acc: 0.7373
1152/1283 [=========================>....] - ETA: 0s - loss: 0.5341 - acc: 0.7309
1280/1283 [============================>.] - ETA: 0s - loss: 0.5302 - acc: 0.7375
1283/1283 [==============================] - 1s 633us/step - loss: 0.5309 - acc: 0.7358 - val_loss: 0.7301 - val_acc: 0.5808

Epoch 00005: val_acc improved from 0.56332 to 0.58079, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_2_ml_15/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_2_ml_15.ckpt
Epoch 6/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.4906 - acc: 0.7500
 192/1283 [===>..........................] - ETA: 0s - loss: 0.4921 - acc: 0.7812
 320/1283 [======>.......................] - ETA: 0s - loss: 0.4853 - acc: 0.7750
 384/1283 [=======>......................] - ETA: 0s - loss: 0.4833 - acc: 0.7786
 448/1283 [=========>....................] - ETA: 0s - loss: 0.4867 - acc: 0.7812
 576/1283 [============>.................] - ETA: 0s - loss: 0.4716 - acc: 0.8038
 704/1283 [===============>..............] - ETA: 0s - loss: 0.4691 - acc: 0.8068
 768/1283 [================>.............] - ETA: 0s - loss: 0.4621 - acc: 0.8190
 832/1283 [==================>...........] - ETA: 0s - loss: 0.4588 - acc: 0.8185
 960/1283 [=====================>........] - ETA: 0s - loss: 0.4657 - acc: 0.8094
1088/1283 [========================>.....] - ETA: 0s - loss: 0.4659 - acc: 0.8070
1216/1283 [===========================>..] - ETA: 0s - loss: 0.4644 - acc: 0.8084
1283/1283 [==============================] - 1s 729us/step - loss: 0.4608 - acc: 0.8098 - val_loss: 0.7292 - val_acc: 0.5677

Epoch 00006: val_acc did not improve
Epoch 7/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.4410 - acc: 0.7812
 192/1283 [===>..........................] - ETA: 0s - loss: 0.4044 - acc: 0.8177
 320/1283 [======>.......................] - ETA: 0s - loss: 0.3965 - acc: 0.8344
 384/1283 [=======>......................] - ETA: 0s - loss: 0.3914 - acc: 0.8411
 512/1283 [==========>...................] - ETA: 0s - loss: 0.3921 - acc: 0.8457
 640/1283 [=============>................] - ETA: 0s - loss: 0.3935 - acc: 0.8453
 768/1283 [================>.............] - ETA: 0s - loss: 0.3935 - acc: 0.8451
 896/1283 [===================>..........] - ETA: 0s - loss: 0.3905 - acc: 0.8460
 960/1283 [=====================>........] - ETA: 0s - loss: 0.3897 - acc: 0.8448
1088/1283 [========================>.....] - ETA: 0s - loss: 0.3938 - acc: 0.8373
1216/1283 [===========================>..] - ETA: 0s - loss: 0.3973 - acc: 0.8372
1283/1283 [==============================] - 1s 711us/step - loss: 0.3972 - acc: 0.8363 - val_loss: 0.7335 - val_acc: 0.5808

Epoch 00007: val_acc improved from 0.58079 to 0.58079, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_2_ml_15/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_2_ml_15.ckpt
Epoch 8/100

  64/1283 [>.............................] - ETA: 1s - loss: 0.2911 - acc: 0.9219
 256/1283 [====>.........................] - ETA: 0s - loss: 0.2966 - acc: 0.9102
 384/1283 [=======>......................] - ETA: 0s - loss: 0.3182 - acc: 0.8880
 512/1283 [==========>...................] - ETA: 0s - loss: 0.3301 - acc: 0.8691
 768/1283 [================>.............] - ETA: 0s - loss: 0.3298 - acc: 0.8685
 896/1283 [===================>..........] - ETA: 0s - loss: 0.3325 - acc: 0.8616
1024/1283 [======================>.......] - ETA: 0s - loss: 0.3273 - acc: 0.8643
1152/1283 [=========================>....] - ETA: 0s - loss: 0.3304 - acc: 0.8646
1280/1283 [============================>.] - ETA: 0s - loss: 0.3292 - acc: 0.8641
1283/1283 [==============================] - 1s 616us/step - loss: 0.3294 - acc: 0.8636 - val_loss: 0.7675 - val_acc: 0.6114

Epoch 00008: val_acc improved from 0.58079 to 0.61135, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_2_ml_15/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_2_ml_15.ckpt
Epoch 9/100

  64/1283 [>.............................] - ETA: 1s - loss: 0.2860 - acc: 0.9531
 256/1283 [====>.........................] - ETA: 0s - loss: 0.3429 - acc: 0.8594
 384/1283 [=======>......................] - ETA: 0s - loss: 0.3285 - acc: 0.8672
 576/1283 [============>.................] - ETA: 0s - loss: 0.3429 - acc: 0.8559
 704/1283 [===============>..............] - ETA: 0s - loss: 0.3380 - acc: 0.8537
 768/1283 [================>.............] - ETA: 0s - loss: 0.3365 - acc: 0.8529
 896/1283 [===================>..........] - ETA: 0s - loss: 0.3410 - acc: 0.8449
1024/1283 [======================>.......] - ETA: 0s - loss: 0.3388 - acc: 0.8477
1152/1283 [=========================>....] - ETA: 0s - loss: 0.3346 - acc: 0.8498
1280/1283 [============================>.] - ETA: 0s - loss: 0.3294 - acc: 0.8562
1283/1283 [==============================] - 1s 707us/step - loss: 0.3290 - acc: 0.8566 - val_loss: 0.8171 - val_acc: 0.5983

Epoch 00009: val_acc did not improve
Epoch 10/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.2055 - acc: 0.9219
 320/1283 [======>.......................] - ETA: 0s - loss: 0.2183 - acc: 0.9250
 448/1283 [=========>....................] - ETA: 0s - loss: 0.2354 - acc: 0.9107
 640/1283 [=============>................] - ETA: 0s - loss: 0.2414 - acc: 0.9047
 768/1283 [================>.............] - ETA: 0s - loss: 0.2406 - acc: 0.9076
 896/1283 [===================>..........] - ETA: 0s - loss: 0.2364 - acc: 0.9118
1024/1283 [======================>.......] - ETA: 0s - loss: 0.2382 - acc: 0.9111
1152/1283 [=========================>....] - ETA: 0s - loss: 0.2422 - acc: 0.9106
1280/1283 [============================>.] - ETA: 0s - loss: 0.2431 - acc: 0.9125
1283/1283 [==============================] - 1s 554us/step - loss: 0.2431 - acc: 0.9127 - val_loss: 0.8355 - val_acc: 0.5895

Epoch 00010: val_acc did not improve
Epoch 11/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.2008 - acc: 0.9531
 192/1283 [===>..........................] - ETA: 0s - loss: 0.2152 - acc: 0.9219
 320/1283 [======>.......................] - ETA: 0s - loss: 0.2081 - acc: 0.9250
 448/1283 [=========>....................] - ETA: 0s - loss: 0.2012 - acc: 0.9308
 576/1283 [============>.................] - ETA: 0s - loss: 0.2022 - acc: 0.9288
 640/1283 [=============>................] - ETA: 0s - loss: 0.1994 - acc: 0.9297
 768/1283 [================>.............] - ETA: 0s - loss: 0.2045 - acc: 0.9245
 832/1283 [==================>...........] - ETA: 0s - loss: 0.2063 - acc: 0.9219
 960/1283 [=====================>........] - ETA: 0s - loss: 0.2011 - acc: 0.9271
1088/1283 [========================>.....] - ETA: 0s - loss: 0.2002 - acc: 0.9292
1216/1283 [===========================>..] - ETA: 0s - loss: 0.1966 - acc: 0.9309
1280/1283 [============================>.] - ETA: 0s - loss: 0.1962 - acc: 0.9313
1283/1283 [==============================] - 1s 682us/step - loss: 0.1961 - acc: 0.9314 - val_loss: 0.9115 - val_acc: 0.5852

Epoch 00011: val_acc did not improve
Epoch 12/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1401 - acc: 0.9844
 256/1283 [====>.........................] - ETA: 0s - loss: 0.1549 - acc: 0.9688
 448/1283 [=========>....................] - ETA: 0s - loss: 0.1551 - acc: 0.9554
 576/1283 [============>.................] - ETA: 0s - loss: 0.1447 - acc: 0.9618
 768/1283 [================>.............] - ETA: 0s - loss: 0.1473 - acc: 0.9622
 960/1283 [=====================>........] - ETA: 0s - loss: 0.1464 - acc: 0.9594
1088/1283 [========================>.....] - ETA: 0s - loss: 0.1477 - acc: 0.9577
1152/1283 [=========================>....] - ETA: 0s - loss: 0.1465 - acc: 0.9583
1280/1283 [============================>.] - ETA: 0s - loss: 0.1489 - acc: 0.9555
1283/1283 [==============================] - 1s 552us/step - loss: 0.1495 - acc: 0.9548 - val_loss: 1.0973 - val_acc: 0.5983

Epoch 00012: val_acc did not improve
Epoch 13/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1573 - acc: 0.9219
 192/1283 [===>..........................] - ETA: 0s - loss: 0.1801 - acc: 0.9167
 320/1283 [======>.......................] - ETA: 0s - loss: 0.1837 - acc: 0.9125
 448/1283 [=========>....................] - ETA: 0s - loss: 0.1949 - acc: 0.9152
 576/1283 [============>.................] - ETA: 0s - loss: 0.1796 - acc: 0.9253
 704/1283 [===============>..............] - ETA: 0s - loss: 0.1921 - acc: 0.9190
 768/1283 [================>.............] - ETA: 0s - loss: 0.1858 - acc: 0.9245
 832/1283 [==================>...........] - ETA: 0s - loss: 0.1768 - acc: 0.9303
 960/1283 [=====================>........] - ETA: 0s - loss: 0.1758 - acc: 0.9313
1088/1283 [========================>.....] - ETA: 0s - loss: 0.1676 - acc: 0.9375
1152/1283 [=========================>....] - ETA: 0s - loss: 0.1656 - acc: 0.9375
1216/1283 [===========================>..] - ETA: 0s - loss: 0.1672 - acc: 0.9350
1280/1283 [============================>.] - ETA: 0s - loss: 0.1683 - acc: 0.9344
1283/1283 [==============================] - 1s 1ms/step - loss: 0.1685 - acc: 0.9345 - val_loss: 0.9832 - val_acc: 0.5721

Epoch 00013: val_acc did not improve
Epoch 14/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1139 - acc: 0.9688
 128/1283 [=>............................] - ETA: 0s - loss: 0.1673 - acc: 0.9062
 256/1283 [====>.........................] - ETA: 0s - loss: 0.1920 - acc: 0.8867
 384/1283 [=======>......................] - ETA: 0s - loss: 0.1765 - acc: 0.9036
 512/1283 [==========>...................] - ETA: 0s - loss: 0.1677 - acc: 0.9180
 704/1283 [===============>..............] - ETA: 0s - loss: 0.1680 - acc: 0.9219
 832/1283 [==================>...........] - ETA: 0s - loss: 0.1744 - acc: 0.9159
 896/1283 [===================>..........] - ETA: 0s - loss: 0.1756 - acc: 0.9185
1024/1283 [======================>.......] - ETA: 0s - loss: 0.1701 - acc: 0.9248
1152/1283 [=========================>....] - ETA: 0s - loss: 0.1767 - acc: 0.9210
1280/1283 [============================>.] - ETA: 0s - loss: 0.1742 - acc: 0.9227
1283/1283 [==============================] - 1s 627us/step - loss: 0.1739 - acc: 0.9228 - val_loss: 1.0244 - val_acc: 0.5939

Epoch 00014: val_acc did not improve
Epoch 15/100

  64/1283 [>.............................] - ETA: 1s - loss: 0.1065 - acc: 0.9844
 128/1283 [=>............................] - ETA: 1s - loss: 0.1132 - acc: 0.9609
 256/1283 [====>.........................] - ETA: 1s - loss: 0.1064 - acc: 0.9727
 320/1283 [======>.......................] - ETA: 1s - loss: 0.1027 - acc: 0.9719
 384/1283 [=======>......................] - ETA: 0s - loss: 0.1011 - acc: 0.9714
 512/1283 [==========>...................] - ETA: 0s - loss: 0.1019 - acc: 0.9766
 640/1283 [=============>................] - ETA: 0s - loss: 0.1043 - acc: 0.9750
 768/1283 [================>.............] - ETA: 0s - loss: 0.1050 - acc: 0.9727
 896/1283 [===================>..........] - ETA: 0s - loss: 0.1010 - acc: 0.9766
1024/1283 [======================>.......] - ETA: 0s - loss: 0.1044 - acc: 0.9766
1152/1283 [=========================>....] - ETA: 0s - loss: 0.1053 - acc: 0.9766
1216/1283 [===========================>..] - ETA: 0s - loss: 0.1041 - acc: 0.9778
1283/1283 [==============================] - 1s 965us/step - loss: 0.1034 - acc: 0.9774 - val_loss: 1.2230 - val_acc: 0.5983

Epoch 00015: val_acc did not improve
Epoch 16/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0805 - acc: 0.9844
 192/1283 [===>..........................] - ETA: 0s - loss: 0.1071 - acc: 0.9583
 320/1283 [======>.......................] - ETA: 0s - loss: 0.1065 - acc: 0.9563
 448/1283 [=========>....................] - ETA: 0s - loss: 0.1095 - acc: 0.9598
 576/1283 [============>.................] - ETA: 0s - loss: 0.1084 - acc: 0.9688
 640/1283 [=============>................] - ETA: 0s - loss: 0.1106 - acc: 0.9672
 768/1283 [================>.............] - ETA: 0s - loss: 0.1072 - acc: 0.9688
 896/1283 [===================>..........] - ETA: 0s - loss: 0.1015 - acc: 0.9732
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0990 - acc: 0.9746
1152/1283 [=========================>....] - ETA: 0s - loss: 0.0953 - acc: 0.9774
1280/1283 [============================>.] - ETA: 0s - loss: 0.0943 - acc: 0.9773
1283/1283 [==============================] - 1s 1ms/step - loss: 0.0941 - acc: 0.9774 - val_loss: 1.2810 - val_acc: 0.5633

Epoch 00016: val_acc did not improve
Epoch 17/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0477 - acc: 0.9844
 192/1283 [===>..........................] - ETA: 0s - loss: 0.0698 - acc: 0.9740
 320/1283 [======>.......................] - ETA: 0s - loss: 0.0669 - acc: 0.9781
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0653 - acc: 0.9799
 576/1283 [============>.................] - ETA: 0s - loss: 0.0646 - acc: 0.9844
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0615 - acc: 0.9858
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0601 - acc: 0.9856
 896/1283 [===================>..........] - ETA: 0s - loss: 0.0620 - acc: 0.9844
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0615 - acc: 0.9854
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0617 - acc: 0.9844
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0613 - acc: 0.9853
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0603 - acc: 0.9868
1280/1283 [============================>.] - ETA: 0s - loss: 0.0595 - acc: 0.9875
1283/1283 [==============================] - 1s 700us/step - loss: 0.0595 - acc: 0.9875 - val_loss: 1.2741 - val_acc: 0.5895

Epoch 00017: val_acc did not improve
Epoch 18/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0433 - acc: 1.0000
 128/1283 [=>............................] - ETA: 0s - loss: 0.0401 - acc: 1.0000
 320/1283 [======>.......................] - ETA: 0s - loss: 0.0708 - acc: 0.9688
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0692 - acc: 0.9710
 576/1283 [============>.................] - ETA: 0s - loss: 0.0654 - acc: 0.9740
 768/1283 [================>.............] - ETA: 0s - loss: 0.0628 - acc: 0.9792
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0626 - acc: 0.9781
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0604 - acc: 0.9798
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0577 - acc: 0.9811
1283/1283 [==============================] - 1s 785us/step - loss: 0.0582 - acc: 0.9805 - val_loss: 1.3269 - val_acc: 0.5983

Epoch 00018: val_acc did not improve
Epoch 00018: early stopping
batch_size=64
batch_norm=False
dropout_rate=0.1
n_layers=2
max_len=15
nodes=100
mode=A
PCA audio=30
PCA visual=15
PCA text=100
accuracy=0.5014577259475219
best_valid_accuracy=0.5145772594752187
/afs/inf.ed.ac.uk/user/s17/s1738075/.local/lib/python2.7/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
pca_early_fusion_cnn.py:146: RuntimeWarning: invalid value encountered in divide
  train_set_audio = train_set_audio / audio_max
pca_early_fusion_cnn.py:148: RuntimeWarning: invalid value encountered in divide
  test_set_audio = test_set_audio / audio_max
2018-03-28 22:08:14.816129: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
This API will be deprecated in the future versions. Please check the Github page for the current API

Modality facet for video 8qrpnFRGt2A segment 13 is (partially) missing and is thus being replaced by zeros!

Train on 1283 samples, validate on 229 samples
Epoch 1/100

  64/1283 [>.............................] - ETA: 23s - loss: 0.7354 - acc: 0.4375
 192/1283 [===>..........................] - ETA: 7s - loss: 0.7211 - acc: 0.4948 
 384/1283 [=======>......................] - ETA: 3s - loss: 0.7433 - acc: 0.4818
 512/1283 [==========>...................] - ETA: 2s - loss: 0.7322 - acc: 0.4980
 640/1283 [=============>................] - ETA: 1s - loss: 0.7296 - acc: 0.4984
 768/1283 [================>.............] - ETA: 1s - loss: 0.7283 - acc: 0.5078
 896/1283 [===================>..........] - ETA: 0s - loss: 0.7242 - acc: 0.5100
 960/1283 [=====================>........] - ETA: 0s - loss: 0.7219 - acc: 0.5094
1088/1283 [========================>.....] - ETA: 0s - loss: 0.7177 - acc: 0.5184
1216/1283 [===========================>..] - ETA: 0s - loss: 0.7143 - acc: 0.5214
1283/1283 [==============================] - 2s 2ms/step - loss: 0.7132 - acc: 0.5230 - val_loss: 0.6927 - val_acc: 0.5153

Epoch 00001: val_acc improved from -inf to 0.51528, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_2_ml_15/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_2_ml_15.ckpt
Epoch 2/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.6556 - acc: 0.6250
 128/1283 [=>............................] - ETA: 1s - loss: 0.6555 - acc: 0.6641
 192/1283 [===>..........................] - ETA: 1s - loss: 0.6505 - acc: 0.6667
 256/1283 [====>.........................] - ETA: 2s - loss: 0.6469 - acc: 0.6797
 320/1283 [======>.......................] - ETA: 1s - loss: 0.6452 - acc: 0.6719
 384/1283 [=======>......................] - ETA: 1s - loss: 0.6491 - acc: 0.6589
 448/1283 [=========>....................] - ETA: 1s - loss: 0.6498 - acc: 0.6496
 576/1283 [============>.................] - ETA: 1s - loss: 0.6450 - acc: 0.6597
 704/1283 [===============>..............] - ETA: 0s - loss: 0.6408 - acc: 0.6634
 832/1283 [==================>...........] - ETA: 0s - loss: 0.6405 - acc: 0.6659
 960/1283 [=====================>........] - ETA: 0s - loss: 0.6489 - acc: 0.6531
1088/1283 [========================>.....] - ETA: 0s - loss: 0.6475 - acc: 0.6517
1152/1283 [=========================>....] - ETA: 0s - loss: 0.6443 - acc: 0.6545
1216/1283 [===========================>..] - ETA: 0s - loss: 0.6455 - acc: 0.6513
1280/1283 [============================>.] - ETA: 0s - loss: 0.6450 - acc: 0.6516
1283/1283 [==============================] - 2s 1ms/step - loss: 0.6450 - acc: 0.6508 - val_loss: 0.7075 - val_acc: 0.5197

Epoch 00002: val_acc improved from 0.51528 to 0.51965, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_2_ml_15/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_2_ml_15.ckpt
Epoch 3/100

  64/1283 [>.............................] - ETA: 1s - loss: 0.6522 - acc: 0.5469
 128/1283 [=>............................] - ETA: 1s - loss: 0.6384 - acc: 0.6016
 320/1283 [======>.......................] - ETA: 0s - loss: 0.5970 - acc: 0.7031
 384/1283 [=======>......................] - ETA: 0s - loss: 0.6043 - acc: 0.6849
 448/1283 [=========>....................] - ETA: 0s - loss: 0.6002 - acc: 0.6920
 512/1283 [==========>...................] - ETA: 0s - loss: 0.6011 - acc: 0.6953
 576/1283 [============>.................] - ETA: 0s - loss: 0.5971 - acc: 0.7031
 640/1283 [=============>................] - ETA: 0s - loss: 0.5977 - acc: 0.7031
 704/1283 [===============>..............] - ETA: 0s - loss: 0.6019 - acc: 0.6974
 768/1283 [================>.............] - ETA: 0s - loss: 0.6021 - acc: 0.7005
 832/1283 [==================>...........] - ETA: 0s - loss: 0.6029 - acc: 0.6959
 896/1283 [===================>..........] - ETA: 0s - loss: 0.6059 - acc: 0.6886
 960/1283 [=====================>........] - ETA: 0s - loss: 0.6061 - acc: 0.6885
1024/1283 [======================>.......] - ETA: 0s - loss: 0.6033 - acc: 0.6934
1088/1283 [========================>.....] - ETA: 0s - loss: 0.6018 - acc: 0.6958
1152/1283 [=========================>....] - ETA: 0s - loss: 0.6009 - acc: 0.6962
1216/1283 [===========================>..] - ETA: 0s - loss: 0.6033 - acc: 0.6916
1280/1283 [============================>.] - ETA: 0s - loss: 0.6033 - acc: 0.6891
1283/1283 [==============================] - 1s 1ms/step - loss: 0.6031 - acc: 0.6898 - val_loss: 0.7244 - val_acc: 0.5415

Epoch 00003: val_acc improved from 0.51965 to 0.54148, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_2_ml_15/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_2_ml_15.ckpt
Epoch 4/100

  64/1283 [>.............................] - ETA: 1s - loss: 0.5588 - acc: 0.7344
 128/1283 [=>............................] - ETA: 1s - loss: 0.5365 - acc: 0.7656
 192/1283 [===>..........................] - ETA: 1s - loss: 0.5227 - acc: 0.7812
 256/1283 [====>.........................] - ETA: 1s - loss: 0.5238 - acc: 0.7773
 320/1283 [======>.......................] - ETA: 1s - loss: 0.5216 - acc: 0.7719
 384/1283 [=======>......................] - ETA: 1s - loss: 0.5223 - acc: 0.7734
 448/1283 [=========>....................] - ETA: 1s - loss: 0.5256 - acc: 0.7679
 576/1283 [============>.................] - ETA: 0s - loss: 0.5293 - acc: 0.7569
 704/1283 [===============>..............] - ETA: 0s - loss: 0.5354 - acc: 0.7486
 768/1283 [================>.............] - ETA: 0s - loss: 0.5399 - acc: 0.7409
 896/1283 [===================>..........] - ETA: 0s - loss: 0.5381 - acc: 0.7467
1024/1283 [======================>.......] - ETA: 0s - loss: 0.5428 - acc: 0.7402
1088/1283 [========================>.....] - ETA: 0s - loss: 0.5417 - acc: 0.7426
1152/1283 [=========================>....] - ETA: 0s - loss: 0.5444 - acc: 0.7422
1283/1283 [==============================] - 1s 1ms/step - loss: 0.5446 - acc: 0.7428 - val_loss: 0.7130 - val_acc: 0.5633

Epoch 00004: val_acc improved from 0.54148 to 0.56332, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_2_ml_15/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_2_ml_15.ckpt
Epoch 5/100

  64/1283 [>.............................] - ETA: 1s - loss: 0.4730 - acc: 0.7812
 192/1283 [===>..........................] - ETA: 0s - loss: 0.4600 - acc: 0.8229
 320/1283 [======>.......................] - ETA: 0s - loss: 0.4657 - acc: 0.8187
 448/1283 [=========>....................] - ETA: 0s - loss: 0.4701 - acc: 0.8058
 512/1283 [==========>...................] - ETA: 0s - loss: 0.4748 - acc: 0.7949
 640/1283 [=============>................] - ETA: 0s - loss: 0.4746 - acc: 0.7906
 704/1283 [===============>..............] - ETA: 0s - loss: 0.4793 - acc: 0.7869
 768/1283 [================>.............] - ETA: 0s - loss: 0.4815 - acc: 0.7852
 832/1283 [==================>...........] - ETA: 0s - loss: 0.4805 - acc: 0.7849
 960/1283 [=====================>........] - ETA: 0s - loss: 0.4802 - acc: 0.7823
1024/1283 [======================>.......] - ETA: 0s - loss: 0.4819 - acc: 0.7783
1152/1283 [=========================>....] - ETA: 0s - loss: 0.4819 - acc: 0.7804
1280/1283 [============================>.] - ETA: 0s - loss: 0.4811 - acc: 0.7812
1283/1283 [==============================] - 1s 833us/step - loss: 0.4811 - acc: 0.7810 - val_loss: 0.7508 - val_acc: 0.5502

Epoch 00005: val_acc did not improve
Epoch 6/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.4084 - acc: 0.8750
 192/1283 [===>..........................] - ETA: 0s - loss: 0.3945 - acc: 0.8698
 320/1283 [======>.......................] - ETA: 0s - loss: 0.3977 - acc: 0.8531
 448/1283 [=========>....................] - ETA: 0s - loss: 0.4037 - acc: 0.8504
 576/1283 [============>.................] - ETA: 0s - loss: 0.4064 - acc: 0.8472
 640/1283 [=============>................] - ETA: 0s - loss: 0.4067 - acc: 0.8453
 704/1283 [===============>..............] - ETA: 0s - loss: 0.4094 - acc: 0.8423
 768/1283 [================>.............] - ETA: 0s - loss: 0.4102 - acc: 0.8372
 832/1283 [==================>...........] - ETA: 0s - loss: 0.4085 - acc: 0.8389
 896/1283 [===================>..........] - ETA: 0s - loss: 0.4086 - acc: 0.8371
1024/1283 [======================>.......] - ETA: 0s - loss: 0.4075 - acc: 0.8418
1088/1283 [========================>.....] - ETA: 0s - loss: 0.4093 - acc: 0.8392
1216/1283 [===========================>..] - ETA: 0s - loss: 0.4118 - acc: 0.8347
1283/1283 [==============================] - 1s 798us/step - loss: 0.4100 - acc: 0.8363 - val_loss: 0.8587 - val_acc: 0.5590

Epoch 00006: val_acc did not improve
Epoch 7/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.4700 - acc: 0.7500
 256/1283 [====>.........................] - ETA: 0s - loss: 0.4257 - acc: 0.8008
 384/1283 [=======>......................] - ETA: 0s - loss: 0.4028 - acc: 0.8281
 512/1283 [==========>...................] - ETA: 0s - loss: 0.3922 - acc: 0.8418
 640/1283 [=============>................] - ETA: 0s - loss: 0.3765 - acc: 0.8484
 768/1283 [================>.............] - ETA: 0s - loss: 0.3741 - acc: 0.8477
 832/1283 [==================>...........] - ETA: 0s - loss: 0.3699 - acc: 0.8498
 960/1283 [=====================>........] - ETA: 0s - loss: 0.3667 - acc: 0.8510
1024/1283 [======================>.......] - ETA: 0s - loss: 0.3667 - acc: 0.8496
1088/1283 [========================>.....] - ETA: 0s - loss: 0.3638 - acc: 0.8548
1152/1283 [=========================>....] - ETA: 0s - loss: 0.3629 - acc: 0.8550
1216/1283 [===========================>..] - ETA: 0s - loss: 0.3594 - acc: 0.8577
1280/1283 [============================>.] - ETA: 0s - loss: 0.3596 - acc: 0.8570
1283/1283 [==============================] - 2s 1ms/step - loss: 0.3591 - acc: 0.8574 - val_loss: 0.7890 - val_acc: 0.5764

Epoch 00007: val_acc improved from 0.56332 to 0.57642, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_2_ml_15/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_2_ml_15.ckpt
Epoch 8/100

  64/1283 [>.............................] - ETA: 2s - loss: 0.2680 - acc: 0.9219
 192/1283 [===>..........................] - ETA: 1s - loss: 0.2434 - acc: 0.9323
 256/1283 [====>.........................] - ETA: 1s - loss: 0.2615 - acc: 0.9219
 320/1283 [======>.......................] - ETA: 1s - loss: 0.2621 - acc: 0.9187
 384/1283 [=======>......................] - ETA: 1s - loss: 0.2606 - acc: 0.9167
 448/1283 [=========>....................] - ETA: 1s - loss: 0.2623 - acc: 0.9152
 512/1283 [==========>...................] - ETA: 0s - loss: 0.2582 - acc: 0.9180
 576/1283 [============>.................] - ETA: 0s - loss: 0.2641 - acc: 0.9132
 704/1283 [===============>..............] - ETA: 0s - loss: 0.2662 - acc: 0.9119
 768/1283 [================>.............] - ETA: 0s - loss: 0.2651 - acc: 0.9141
 832/1283 [==================>...........] - ETA: 0s - loss: 0.2630 - acc: 0.9159
 896/1283 [===================>..........] - ETA: 0s - loss: 0.2616 - acc: 0.9141
 960/1283 [=====================>........] - ETA: 0s - loss: 0.2566 - acc: 0.9177
1088/1283 [========================>.....] - ETA: 0s - loss: 0.2574 - acc: 0.9136
1216/1283 [===========================>..] - ETA: 0s - loss: 0.2558 - acc: 0.9169
1280/1283 [============================>.] - ETA: 0s - loss: 0.2536 - acc: 0.9180
1283/1283 [==============================] - 1s 1ms/step - loss: 0.2531 - acc: 0.9182 - val_loss: 0.8843 - val_acc: 0.5633

Epoch 00008: val_acc did not improve
Epoch 9/100

  64/1283 [>.............................] - ETA: 1s - loss: 0.2076 - acc: 0.9062
 128/1283 [=>............................] - ETA: 1s - loss: 0.2092 - acc: 0.9062
 256/1283 [====>.........................] - ETA: 1s - loss: 0.2214 - acc: 0.9062
 320/1283 [======>.......................] - ETA: 1s - loss: 0.2179 - acc: 0.9156
 384/1283 [=======>......................] - ETA: 1s - loss: 0.2114 - acc: 0.9245
 448/1283 [=========>....................] - ETA: 1s - loss: 0.2047 - acc: 0.9286
 576/1283 [============>.................] - ETA: 0s - loss: 0.1996 - acc: 0.9375
 640/1283 [=============>................] - ETA: 0s - loss: 0.2012 - acc: 0.9359
 768/1283 [================>.............] - ETA: 0s - loss: 0.2021 - acc: 0.9375
 896/1283 [===================>..........] - ETA: 0s - loss: 0.2035 - acc: 0.9353
1024/1283 [======================>.......] - ETA: 0s - loss: 0.2019 - acc: 0.9336
1152/1283 [=========================>....] - ETA: 0s - loss: 0.1975 - acc: 0.9358
1216/1283 [===========================>..] - ETA: 0s - loss: 0.1967 - acc: 0.9375
1280/1283 [============================>.] - ETA: 0s - loss: 0.1949 - acc: 0.9391
1283/1283 [==============================] - 1s 1ms/step - loss: 0.1950 - acc: 0.9384 - val_loss: 0.9136 - val_acc: 0.5633

Epoch 00009: val_acc did not improve
Epoch 10/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1892 - acc: 0.9219
 192/1283 [===>..........................] - ETA: 0s - loss: 0.1548 - acc: 0.9375
 320/1283 [======>.......................] - ETA: 0s - loss: 0.1572 - acc: 0.9469
 448/1283 [=========>....................] - ETA: 0s - loss: 0.1537 - acc: 0.9509
 576/1283 [============>.................] - ETA: 0s - loss: 0.1576 - acc: 0.9514
 704/1283 [===============>..............] - ETA: 0s - loss: 0.1599 - acc: 0.9489
 832/1283 [==================>...........] - ETA: 0s - loss: 0.1603 - acc: 0.9435
 896/1283 [===================>..........] - ETA: 0s - loss: 0.1626 - acc: 0.9431
 960/1283 [=====================>........] - ETA: 0s - loss: 0.1625 - acc: 0.9417
1088/1283 [========================>.....] - ETA: 0s - loss: 0.1572 - acc: 0.9458
1152/1283 [=========================>....] - ETA: 0s - loss: 0.1577 - acc: 0.9453
1216/1283 [===========================>..] - ETA: 0s - loss: 0.1599 - acc: 0.9441
1283/1283 [==============================] - 1s 941us/step - loss: 0.1568 - acc: 0.9470 - val_loss: 1.1403 - val_acc: 0.5633

Epoch 00010: val_acc did not improve
Epoch 11/100

  64/1283 [>.............................] - ETA: 1s - loss: 0.1278 - acc: 0.9531
 128/1283 [=>............................] - ETA: 1s - loss: 0.1404 - acc: 0.9688
 192/1283 [===>..........................] - ETA: 1s - loss: 0.1405 - acc: 0.9688
 256/1283 [====>.........................] - ETA: 1s - loss: 0.1368 - acc: 0.9648
 384/1283 [=======>......................] - ETA: 0s - loss: 0.1345 - acc: 0.9635
 448/1283 [=========>....................] - ETA: 0s - loss: 0.1409 - acc: 0.9576
 512/1283 [==========>...................] - ETA: 0s - loss: 0.1606 - acc: 0.9453
 576/1283 [============>.................] - ETA: 0s - loss: 0.1572 - acc: 0.9462
 640/1283 [=============>................] - ETA: 0s - loss: 0.1540 - acc: 0.9484
 704/1283 [===============>..............] - ETA: 0s - loss: 0.1533 - acc: 0.9489
 768/1283 [================>.............] - ETA: 0s - loss: 0.1557 - acc: 0.9479
 832/1283 [==================>...........] - ETA: 0s - loss: 0.1558 - acc: 0.9495
 960/1283 [=====================>........] - ETA: 0s - loss: 0.1598 - acc: 0.9458
1024/1283 [======================>.......] - ETA: 0s - loss: 0.1568 - acc: 0.9473
1088/1283 [========================>.....] - ETA: 0s - loss: 0.1561 - acc: 0.9476
1216/1283 [===========================>..] - ETA: 0s - loss: 0.1533 - acc: 0.9490
1280/1283 [============================>.] - ETA: 0s - loss: 0.1508 - acc: 0.9508
1283/1283 [==============================] - 1s 1ms/step - loss: 0.1511 - acc: 0.9501 - val_loss: 1.0113 - val_acc: 0.6026

Epoch 00011: val_acc improved from 0.57642 to 0.60262, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_2_ml_15/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_2_ml_15.ckpt
Epoch 12/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0696 - acc: 1.0000
 128/1283 [=>............................] - ETA: 0s - loss: 0.0950 - acc: 0.9766
 192/1283 [===>..........................] - ETA: 0s - loss: 0.1152 - acc: 0.9531
 320/1283 [======>.......................] - ETA: 0s - loss: 0.1295 - acc: 0.9437
 448/1283 [=========>....................] - ETA: 0s - loss: 0.1271 - acc: 0.9487
 512/1283 [==========>...................] - ETA: 0s - loss: 0.1260 - acc: 0.9531
 576/1283 [============>.................] - ETA: 0s - loss: 0.1214 - acc: 0.9583
 640/1283 [=============>................] - ETA: 0s - loss: 0.1287 - acc: 0.9547
 704/1283 [===============>..............] - ETA: 0s - loss: 0.1304 - acc: 0.9517
 832/1283 [==================>...........] - ETA: 0s - loss: 0.1356 - acc: 0.9495
 960/1283 [=====================>........] - ETA: 0s - loss: 0.1337 - acc: 0.9510
1088/1283 [========================>.....] - ETA: 0s - loss: 0.1325 - acc: 0.9522
1216/1283 [===========================>..] - ETA: 0s - loss: 0.1286 - acc: 0.9539
1280/1283 [============================>.] - ETA: 0s - loss: 0.1295 - acc: 0.9547
1283/1283 [==============================] - 2s 1ms/step - loss: 0.1294 - acc: 0.9548 - val_loss: 1.2196 - val_acc: 0.5546

Epoch 00012: val_acc did not improve
Epoch 13/100

  64/1283 [>.............................] - ETA: 2s - loss: 0.0728 - acc: 0.9844
 192/1283 [===>..........................] - ETA: 1s - loss: 0.1298 - acc: 0.9427
 320/1283 [======>.......................] - ETA: 0s - loss: 0.1135 - acc: 0.9625
 448/1283 [=========>....................] - ETA: 0s - loss: 0.1044 - acc: 0.9732
 640/1283 [=============>................] - ETA: 0s - loss: 0.1014 - acc: 0.9734
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0973 - acc: 0.9724
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0936 - acc: 0.9750
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0932 - acc: 0.9746
1152/1283 [=========================>....] - ETA: 0s - loss: 0.0907 - acc: 0.9757
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0896 - acc: 0.9770
1280/1283 [============================>.] - ETA: 0s - loss: 0.0902 - acc: 0.9758
1283/1283 [==============================] - 2s 1ms/step - loss: 0.0905 - acc: 0.9758 - val_loss: 1.2373 - val_acc: 0.5808

Epoch 00013: val_acc did not improve
Epoch 14/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0797 - acc: 0.9688
 192/1283 [===>..........................] - ETA: 0s - loss: 0.0596 - acc: 0.9844
 320/1283 [======>.......................] - ETA: 0s - loss: 0.0641 - acc: 0.9844
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0649 - acc: 0.9799
 512/1283 [==========>...................] - ETA: 0s - loss: 0.0623 - acc: 0.9805
 576/1283 [============>.................] - ETA: 0s - loss: 0.0684 - acc: 0.9774
 640/1283 [=============>................] - ETA: 0s - loss: 0.0722 - acc: 0.9750
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0725 - acc: 0.9759
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0817 - acc: 0.9724
 896/1283 [===================>..........] - ETA: 0s - loss: 0.0819 - acc: 0.9721
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0835 - acc: 0.9708
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0854 - acc: 0.9706
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0850 - acc: 0.9704
1283/1283 [==============================] - 1s 909us/step - loss: 0.0836 - acc: 0.9719 - val_loss: 1.9031 - val_acc: 0.5066

Epoch 00014: val_acc did not improve
Epoch 15/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1212 - acc: 0.9375
 192/1283 [===>..........................] - ETA: 0s - loss: 0.1015 - acc: 0.9583
 384/1283 [=======>......................] - ETA: 0s - loss: 0.0956 - acc: 0.9688
 512/1283 [==========>...................] - ETA: 0s - loss: 0.0855 - acc: 0.9766
 640/1283 [=============>................] - ETA: 0s - loss: 0.0785 - acc: 0.9781
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0830 - acc: 0.9759
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0805 - acc: 0.9784
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0758 - acc: 0.9802
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0786 - acc: 0.9775
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0820 - acc: 0.9752
1152/1283 [=========================>....] - ETA: 0s - loss: 0.0827 - acc: 0.9748
1280/1283 [============================>.] - ETA: 0s - loss: 0.0797 - acc: 0.9758
1283/1283 [==============================] - 1s 828us/step - loss: 0.0796 - acc: 0.9758 - val_loss: 1.4119 - val_acc: 0.5546

Epoch 00015: val_acc did not improve
Epoch 16/100

  64/1283 [>.............................] - ETA: 1s - loss: 0.0473 - acc: 1.0000
 128/1283 [=>............................] - ETA: 1s - loss: 0.0448 - acc: 0.9922
 192/1283 [===>..........................] - ETA: 1s - loss: 0.0432 - acc: 0.9896
 256/1283 [====>.........................] - ETA: 1s - loss: 0.0525 - acc: 0.9844
 384/1283 [=======>......................] - ETA: 1s - loss: 0.0582 - acc: 0.9792
 512/1283 [==========>...................] - ETA: 0s - loss: 0.0584 - acc: 0.9805
 640/1283 [=============>................] - ETA: 0s - loss: 0.0591 - acc: 0.9828
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0556 - acc: 0.9844
 768/1283 [================>.............] - ETA: 0s - loss: 0.0541 - acc: 0.9857
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0541 - acc: 0.9856
 896/1283 [===================>..........] - ETA: 0s - loss: 0.0524 - acc: 0.9866
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0516 - acc: 0.9875
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0510 - acc: 0.9873
1152/1283 [=========================>....] - ETA: 0s - loss: 0.0499 - acc: 0.9878
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0495 - acc: 0.9885
1283/1283 [==============================] - 1s 1ms/step - loss: 0.0493 - acc: 0.9883 - val_loss: 1.4569 - val_acc: 0.5502

Epoch 00016: val_acc did not improve
Epoch 17/100

  64/1283 [>.............................] - ETA: 2s - loss: 0.0607 - acc: 0.9688
 128/1283 [=>............................] - ETA: 1s - loss: 0.0585 - acc: 0.9766
 192/1283 [===>..........................] - ETA: 1s - loss: 0.0519 - acc: 0.9844
 256/1283 [====>.........................] - ETA: 1s - loss: 0.0554 - acc: 0.9805
 320/1283 [======>.......................] - ETA: 1s - loss: 0.0511 - acc: 0.9844
 384/1283 [=======>......................] - ETA: 0s - loss: 0.0461 - acc: 0.9870
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0441 - acc: 0.9866
 512/1283 [==========>...................] - ETA: 0s - loss: 0.0441 - acc: 0.9863
 576/1283 [============>.................] - ETA: 0s - loss: 0.0423 - acc: 0.9861
 640/1283 [=============>................] - ETA: 0s - loss: 0.0407 - acc: 0.9875
 768/1283 [================>.............] - ETA: 0s - loss: 0.0389 - acc: 0.9883
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0400 - acc: 0.9892
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0384 - acc: 0.9906
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0383 - acc: 0.9899
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0393 - acc: 0.9893
1283/1283 [==============================] - 1s 930us/step - loss: 0.0382 - acc: 0.9899 - val_loss: 1.6070 - val_acc: 0.5677

Epoch 00017: val_acc did not improve
Epoch 18/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0439 - acc: 0.9844
 192/1283 [===>..........................] - ETA: 0s - loss: 0.0396 - acc: 0.9896
 384/1283 [=======>......................] - ETA: 0s - loss: 0.0413 - acc: 0.9870
 576/1283 [============>.................] - ETA: 0s - loss: 0.0412 - acc: 0.9878
 768/1283 [================>.............] - ETA: 0s - loss: 0.0410 - acc: 0.9870
 896/1283 [===================>..........] - ETA: 0s - loss: 0.0435 - acc: 0.9855
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0424 - acc: 0.9863
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0417 - acc: 0.9871
1152/1283 [=========================>....] - ETA: 0s - loss: 0.0428 - acc: 0.9878
1280/1283 [============================>.] - ETA: 0s - loss: 0.0424 - acc: 0.9883
1283/1283 [==============================] - 1s 566us/step - loss: 0.0424 - acc: 0.9883 - val_loss: 1.8874 - val_acc: 0.5109

Epoch 00018: val_acc did not improve
Epoch 19/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0400 - acc: 0.9844
 192/1283 [===>..........................] - ETA: 0s - loss: 0.0422 - acc: 0.9896
 320/1283 [======>.......................] - ETA: 0s - loss: 0.0434 - acc: 0.9875
 384/1283 [=======>......................] - ETA: 0s - loss: 0.0396 - acc: 0.9896
 512/1283 [==========>...................] - ETA: 0s - loss: 0.0338 - acc: 0.9922
 576/1283 [============>.................] - ETA: 0s - loss: 0.0395 - acc: 0.9878
 640/1283 [=============>................] - ETA: 0s - loss: 0.0408 - acc: 0.9875
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0412 - acc: 0.9872
 768/1283 [================>.............] - ETA: 0s - loss: 0.0409 - acc: 0.9857
 896/1283 [===================>..........] - ETA: 0s - loss: 0.0394 - acc: 0.9877
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0376 - acc: 0.9893
1152/1283 [=========================>....] - ETA: 0s - loss: 0.0363 - acc: 0.9896
1280/1283 [============================>.] - ETA: 0s - loss: 0.0346 - acc: 0.9906
1283/1283 [==============================] - 1s 736us/step - loss: 0.0346 - acc: 0.9906 - val_loss: 1.6976 - val_acc: 0.5240

Epoch 00019: val_acc did not improve
Epoch 20/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0184 - acc: 1.0000
 192/1283 [===>..........................] - ETA: 0s - loss: 0.0240 - acc: 1.0000
 320/1283 [======>.......................] - ETA: 0s - loss: 0.0262 - acc: 0.9938
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0262 - acc: 0.9933
 512/1283 [==========>...................] - ETA: 0s - loss: 0.0237 - acc: 0.9941
 576/1283 [============>.................] - ETA: 0s - loss: 0.0230 - acc: 0.9948
 640/1283 [=============>................] - ETA: 0s - loss: 0.0236 - acc: 0.9953
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0224 - acc: 0.9957
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0242 - acc: 0.9952
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0245 - acc: 0.9948
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0228 - acc: 0.9954
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0256 - acc: 0.9942
1283/1283 [==============================] - 1s 675us/step - loss: 0.0253 - acc: 0.9945 - val_loss: 1.7232 - val_acc: 0.5633

Epoch 00020: val_acc did not improve
Epoch 21/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0112 - acc: 1.0000
 192/1283 [===>..........................] - ETA: 0s - loss: 0.0130 - acc: 0.9948
 320/1283 [======>.......................] - ETA: 0s - loss: 0.0199 - acc: 0.9906
 384/1283 [=======>......................] - ETA: 0s - loss: 0.0198 - acc: 0.9922
 512/1283 [==========>...................] - ETA: 0s - loss: 0.0198 - acc: 0.9941
 576/1283 [============>.................] - ETA: 0s - loss: 0.0201 - acc: 0.9948
 640/1283 [=============>................] - ETA: 0s - loss: 0.0210 - acc: 0.9953
 768/1283 [================>.............] - ETA: 0s - loss: 0.0194 - acc: 0.9961
 896/1283 [===================>..........] - ETA: 0s - loss: 0.0188 - acc: 0.9967
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0185 - acc: 0.9969
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0194 - acc: 0.9963
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0185 - acc: 0.9967
1283/1283 [==============================] - 1s 693us/step - loss: 0.0190 - acc: 0.9969 - val_loss: 1.7967 - val_acc: 0.5721

Epoch 00021: val_acc did not improve
Epoch 00021: early stopping
batch_size=64
batch_norm=False
dropout_rate=0.1
n_layers=2
max_len=15
nodes=100
mode=A
PCA audio=30
PCA visual=20
PCA text=100
accuracy=0.5131195335276968
best_valid_accuracy=0.5102040816326531
/afs/inf.ed.ac.uk/user/s17/s1738075/.local/lib/python2.7/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
pca_early_fusion_cnn.py:146: RuntimeWarning: invalid value encountered in divide
  train_set_audio = train_set_audio / audio_max
pca_early_fusion_cnn.py:148: RuntimeWarning: invalid value encountered in divide
  test_set_audio = test_set_audio / audio_max
2018-03-28 22:18:33.149535: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
This API will be deprecated in the future versions. Please check the Github page for the current API

Modality facet for video 8qrpnFRGt2A segment 13 is (partially) missing and is thus being replaced by zeros!

Train on 1283 samples, validate on 229 samples
Epoch 1/100

  64/1283 [>.............................] - ETA: 4s - loss: 0.6867 - acc: 0.5000
 192/1283 [===>..........................] - ETA: 1s - loss: 0.7112 - acc: 0.4948
 320/1283 [======>.......................] - ETA: 1s - loss: 0.7090 - acc: 0.5125
 448/1283 [=========>....................] - ETA: 0s - loss: 0.7100 - acc: 0.5179
 576/1283 [============>.................] - ETA: 0s - loss: 0.7063 - acc: 0.5243
 704/1283 [===============>..............] - ETA: 0s - loss: 0.7079 - acc: 0.5227
 832/1283 [==================>...........] - ETA: 0s - loss: 0.7087 - acc: 0.5276
 896/1283 [===================>..........] - ETA: 0s - loss: 0.7079 - acc: 0.5301
1024/1283 [======================>.......] - ETA: 0s - loss: 0.7078 - acc: 0.5303
1152/1283 [=========================>....] - ETA: 0s - loss: 0.7064 - acc: 0.5304
1280/1283 [============================>.] - ETA: 0s - loss: 0.7015 - acc: 0.5367
1283/1283 [==============================] - 1s 917us/step - loss: 0.7017 - acc: 0.5362 - val_loss: 0.7118 - val_acc: 0.5022

Epoch 00001: val_acc improved from -inf to 0.50218, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_2_ml_15/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_2_ml_15.ckpt
Epoch 2/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5852 - acc: 0.7656
 192/1283 [===>..........................] - ETA: 0s - loss: 0.6261 - acc: 0.6875
 320/1283 [======>.......................] - ETA: 0s - loss: 0.6320 - acc: 0.6625
 448/1283 [=========>....................] - ETA: 0s - loss: 0.6335 - acc: 0.6585
 640/1283 [=============>................] - ETA: 0s - loss: 0.6269 - acc: 0.6703
 768/1283 [================>.............] - ETA: 0s - loss: 0.6263 - acc: 0.6654
 896/1283 [===================>..........] - ETA: 0s - loss: 0.6251 - acc: 0.6518
1024/1283 [======================>.......] - ETA: 0s - loss: 0.6296 - acc: 0.6436
1152/1283 [=========================>....] - ETA: 0s - loss: 0.6304 - acc: 0.6406
1280/1283 [============================>.] - ETA: 0s - loss: 0.6279 - acc: 0.6461
1283/1283 [==============================] - 1s 560us/step - loss: 0.6274 - acc: 0.6469 - val_loss: 0.8083 - val_acc: 0.5415

Epoch 00002: val_acc improved from 0.50218 to 0.54148, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_2_ml_15/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_2_ml_15.ckpt
Epoch 3/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.6544 - acc: 0.5781
 256/1283 [====>.........................] - ETA: 0s - loss: 0.7009 - acc: 0.5508
 384/1283 [=======>......................] - ETA: 0s - loss: 0.6752 - acc: 0.5859
 576/1283 [============>.................] - ETA: 0s - loss: 0.6411 - acc: 0.6215
 768/1283 [================>.............] - ETA: 0s - loss: 0.6369 - acc: 0.6237
 960/1283 [=====================>........] - ETA: 0s - loss: 0.6269 - acc: 0.6427
1152/1283 [=========================>....] - ETA: 0s - loss: 0.6153 - acc: 0.6589
1283/1283 [==============================] - 1s 428us/step - loss: 0.6158 - acc: 0.6594 - val_loss: 0.7064 - val_acc: 0.5852

Epoch 00003: val_acc improved from 0.54148 to 0.58515, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_2_ml_15/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_2_ml_15.ckpt
Epoch 4/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5251 - acc: 0.8125
 256/1283 [====>.........................] - ETA: 0s - loss: 0.5473 - acc: 0.7695
 384/1283 [=======>......................] - ETA: 0s - loss: 0.5403 - acc: 0.7969
 512/1283 [==========>...................] - ETA: 0s - loss: 0.5425 - acc: 0.7930
 640/1283 [=============>................] - ETA: 0s - loss: 0.5399 - acc: 0.7781
 768/1283 [================>.............] - ETA: 0s - loss: 0.5390 - acc: 0.7786
 960/1283 [=====================>........] - ETA: 0s - loss: 0.5332 - acc: 0.7771
1088/1283 [========================>.....] - ETA: 0s - loss: 0.5362 - acc: 0.7675
1280/1283 [============================>.] - ETA: 0s - loss: 0.5323 - acc: 0.7719
1283/1283 [==============================] - 1s 456us/step - loss: 0.5326 - acc: 0.7708 - val_loss: 0.7553 - val_acc: 0.4934

Epoch 00004: val_acc did not improve
Epoch 5/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.4410 - acc: 0.8125
 192/1283 [===>..........................] - ETA: 0s - loss: 0.4785 - acc: 0.7865
 320/1283 [======>.......................] - ETA: 0s - loss: 0.4822 - acc: 0.7812
 448/1283 [=========>....................] - ETA: 0s - loss: 0.4865 - acc: 0.7790
 512/1283 [==========>...................] - ETA: 0s - loss: 0.4907 - acc: 0.7793
 640/1283 [=============>................] - ETA: 0s - loss: 0.4925 - acc: 0.7781
 832/1283 [==================>...........] - ETA: 0s - loss: 0.4832 - acc: 0.7957
 960/1283 [=====================>........] - ETA: 0s - loss: 0.4813 - acc: 0.7990
1024/1283 [======================>.......] - ETA: 0s - loss: 0.4814 - acc: 0.7979
1152/1283 [=========================>....] - ETA: 0s - loss: 0.4865 - acc: 0.7873
1280/1283 [============================>.] - ETA: 0s - loss: 0.4887 - acc: 0.7812
1283/1283 [==============================] - 1s 578us/step - loss: 0.4890 - acc: 0.7810 - val_loss: 0.8354 - val_acc: 0.4891

Epoch 00005: val_acc did not improve
Epoch 6/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.4061 - acc: 0.8438
 192/1283 [===>..........................] - ETA: 0s - loss: 0.4470 - acc: 0.7865
 384/1283 [=======>......................] - ETA: 0s - loss: 0.4347 - acc: 0.8021
 576/1283 [============>.................] - ETA: 0s - loss: 0.4394 - acc: 0.8003
 768/1283 [================>.............] - ETA: 0s - loss: 0.4309 - acc: 0.8060
 960/1283 [=====================>........] - ETA: 0s - loss: 0.4325 - acc: 0.8021
1088/1283 [========================>.....] - ETA: 0s - loss: 0.4253 - acc: 0.8088
1216/1283 [===========================>..] - ETA: 0s - loss: 0.4233 - acc: 0.8133
1283/1283 [==============================] - 0s 382us/step - loss: 0.4221 - acc: 0.8153 - val_loss: 0.7940 - val_acc: 0.5066

Epoch 00006: val_acc did not improve
Epoch 7/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.3517 - acc: 0.8750
 320/1283 [======>.......................] - ETA: 0s - loss: 0.4043 - acc: 0.8250
 384/1283 [=======>......................] - ETA: 0s - loss: 0.3943 - acc: 0.8438
 640/1283 [=============>................] - ETA: 0s - loss: 0.3782 - acc: 0.8469
 768/1283 [================>.............] - ETA: 0s - loss: 0.3716 - acc: 0.8568
 960/1283 [=====================>........] - ETA: 0s - loss: 0.3661 - acc: 0.8635
1216/1283 [===========================>..] - ETA: 0s - loss: 0.3605 - acc: 0.8618
1283/1283 [==============================] - 0s 337us/step - loss: 0.3563 - acc: 0.8652 - val_loss: 0.8393 - val_acc: 0.5066

Epoch 00007: val_acc did not improve
Epoch 8/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.2326 - acc: 0.9688
 320/1283 [======>.......................] - ETA: 0s - loss: 0.2602 - acc: 0.9156
 512/1283 [==========>...................] - ETA: 0s - loss: 0.2854 - acc: 0.9004
 640/1283 [=============>................] - ETA: 0s - loss: 0.2813 - acc: 0.8984
 768/1283 [================>.............] - ETA: 0s - loss: 0.2798 - acc: 0.8971
 960/1283 [=====================>........] - ETA: 0s - loss: 0.2797 - acc: 0.8979
1152/1283 [=========================>....] - ETA: 0s - loss: 0.2824 - acc: 0.8950
1283/1283 [==============================] - 0s 370us/step - loss: 0.2787 - acc: 0.8971 - val_loss: 0.8816 - val_acc: 0.5546

Epoch 00008: val_acc did not improve
Epoch 9/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.2827 - acc: 0.8906
 256/1283 [====>.........................] - ETA: 0s - loss: 0.2122 - acc: 0.9336
 384/1283 [=======>......................] - ETA: 0s - loss: 0.2105 - acc: 0.9349
 512/1283 [==========>...................] - ETA: 0s - loss: 0.2064 - acc: 0.9395
 640/1283 [=============>................] - ETA: 0s - loss: 0.2057 - acc: 0.9391
 768/1283 [================>.............] - ETA: 0s - loss: 0.2081 - acc: 0.9388
 896/1283 [===================>..........] - ETA: 0s - loss: 0.2085 - acc: 0.9353
1152/1283 [=========================>....] - ETA: 0s - loss: 0.2056 - acc: 0.9358
1216/1283 [===========================>..] - ETA: 0s - loss: 0.2035 - acc: 0.9375
1283/1283 [==============================] - 1s 456us/step - loss: 0.2026 - acc: 0.9376 - val_loss: 1.0318 - val_acc: 0.5109

Epoch 00009: val_acc did not improve
Epoch 10/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.2163 - acc: 0.8906
 256/1283 [====>.........................] - ETA: 0s - loss: 0.1987 - acc: 0.9141
 448/1283 [=========>....................] - ETA: 0s - loss: 0.1857 - acc: 0.9241
 640/1283 [=============>................] - ETA: 0s - loss: 0.1748 - acc: 0.9391
 768/1283 [================>.............] - ETA: 0s - loss: 0.1727 - acc: 0.9440
 896/1283 [===================>..........] - ETA: 0s - loss: 0.1701 - acc: 0.9420
1088/1283 [========================>.....] - ETA: 0s - loss: 0.1717 - acc: 0.9375
1216/1283 [===========================>..] - ETA: 0s - loss: 0.1743 - acc: 0.9342
1283/1283 [==============================] - 1s 404us/step - loss: 0.1764 - acc: 0.9322 - val_loss: 1.0959 - val_acc: 0.5546

Epoch 00010: val_acc did not improve
Epoch 11/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0978 - acc: 0.9844
 256/1283 [====>.........................] - ETA: 0s - loss: 0.1408 - acc: 0.9648
 448/1283 [=========>....................] - ETA: 0s - loss: 0.1282 - acc: 0.9754
 576/1283 [============>.................] - ETA: 0s - loss: 0.1328 - acc: 0.9705
 768/1283 [================>.............] - ETA: 0s - loss: 0.1431 - acc: 0.9635
 960/1283 [=====================>........] - ETA: 0s - loss: 0.1382 - acc: 0.9656
1088/1283 [========================>.....] - ETA: 0s - loss: 0.1364 - acc: 0.9678
1280/1283 [============================>.] - ETA: 0s - loss: 0.1339 - acc: 0.9680
1283/1283 [==============================] - 1s 404us/step - loss: 0.1339 - acc: 0.9680 - val_loss: 1.3115 - val_acc: 0.5808

Epoch 00011: val_acc did not improve
Epoch 12/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1253 - acc: 0.9375
 256/1283 [====>.........................] - ETA: 0s - loss: 0.1161 - acc: 0.9609
 384/1283 [=======>......................] - ETA: 0s - loss: 0.1108 - acc: 0.9635
 512/1283 [==========>...................] - ETA: 0s - loss: 0.1066 - acc: 0.9707
 640/1283 [=============>................] - ETA: 0s - loss: 0.1033 - acc: 0.9734
 832/1283 [==================>...........] - ETA: 0s - loss: 0.1015 - acc: 0.9748
 960/1283 [=====================>........] - ETA: 0s - loss: 0.1005 - acc: 0.9750
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0989 - acc: 0.9743
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0965 - acc: 0.9745
1283/1283 [==============================] - 1s 456us/step - loss: 0.0954 - acc: 0.9751 - val_loss: 1.3539 - val_acc: 0.5590

Epoch 00012: val_acc did not improve
Epoch 13/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0714 - acc: 0.9844
 128/1283 [=>............................] - ETA: 0s - loss: 0.0814 - acc: 0.9922
 256/1283 [====>.........................] - ETA: 0s - loss: 0.1028 - acc: 0.9766
 384/1283 [=======>......................] - ETA: 0s - loss: 0.1026 - acc: 0.9740
 448/1283 [=========>....................] - ETA: 0s - loss: 0.1033 - acc: 0.9688
 640/1283 [=============>................] - ETA: 0s - loss: 0.1018 - acc: 0.9688
 768/1283 [================>.............] - ETA: 0s - loss: 0.1061 - acc: 0.9635
 896/1283 [===================>..........] - ETA: 0s - loss: 0.1070 - acc: 0.9621
1024/1283 [======================>.......] - ETA: 0s - loss: 0.1039 - acc: 0.9648
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0994 - acc: 0.9688
1283/1283 [==============================] - 1s 604us/step - loss: 0.0980 - acc: 0.9704 - val_loss: 1.4173 - val_acc: 0.5371

Epoch 00013: val_acc did not improve
Epoch 00013: early stopping
batch_size=64
batch_norm=False
dropout_rate=0.1
n_layers=2
max_len=15
nodes=100
mode=A
PCA audio=30
PCA visual=25
PCA text=100
accuracy=0.5087463556851312
best_valid_accuracy=0.46355685131195334
/afs/inf.ed.ac.uk/user/s17/s1738075/.local/lib/python2.7/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
pca_early_fusion_cnn.py:146: RuntimeWarning: invalid value encountered in divide
  train_set_audio = train_set_audio / audio_max
pca_early_fusion_cnn.py:148: RuntimeWarning: invalid value encountered in divide
  test_set_audio = test_set_audio / audio_max
2018-03-28 22:24:07.118437: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
This API will be deprecated in the future versions. Please check the Github page for the current API

Modality facet for video 8qrpnFRGt2A segment 13 is (partially) missing and is thus being replaced by zeros!

Train on 1283 samples, validate on 229 samples
Epoch 1/100

  64/1283 [>.............................] - ETA: 18s - loss: 0.6928 - acc: 0.4844
 192/1283 [===>..........................] - ETA: 5s - loss: 0.7417 - acc: 0.4635 
 384/1283 [=======>......................] - ETA: 2s - loss: 0.7283 - acc: 0.4844
 512/1283 [==========>...................] - ETA: 1s - loss: 0.7203 - acc: 0.4922
 640/1283 [=============>................] - ETA: 1s - loss: 0.7124 - acc: 0.5047
 768/1283 [================>.............] - ETA: 0s - loss: 0.7088 - acc: 0.5000
 896/1283 [===================>..........] - ETA: 0s - loss: 0.7029 - acc: 0.5089
1024/1283 [======================>.......] - ETA: 0s - loss: 0.7003 - acc: 0.5117
1216/1283 [===========================>..] - ETA: 0s - loss: 0.7005 - acc: 0.5123
1283/1283 [==============================] - 2s 1ms/step - loss: 0.6984 - acc: 0.5160 - val_loss: 0.7154 - val_acc: 0.4978

Epoch 00001: val_acc improved from -inf to 0.49782, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_2_ml_15/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_2_ml_15.ckpt
Epoch 2/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.6407 - acc: 0.5938
 192/1283 [===>..........................] - ETA: 0s - loss: 0.6372 - acc: 0.6250
 320/1283 [======>.......................] - ETA: 0s - loss: 0.6342 - acc: 0.6312
 512/1283 [==========>...................] - ETA: 0s - loss: 0.6236 - acc: 0.6621
 640/1283 [=============>................] - ETA: 0s - loss: 0.6356 - acc: 0.6359
 832/1283 [==================>...........] - ETA: 0s - loss: 0.6276 - acc: 0.6550
 960/1283 [=====================>........] - ETA: 0s - loss: 0.6262 - acc: 0.6562
1152/1283 [=========================>....] - ETA: 0s - loss: 0.6182 - acc: 0.6641
1280/1283 [============================>.] - ETA: 0s - loss: 0.6157 - acc: 0.6633
1283/1283 [==============================] - 1s 509us/step - loss: 0.6163 - acc: 0.6625 - val_loss: 0.7628 - val_acc: 0.4585

Epoch 00002: val_acc did not improve
Epoch 3/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5786 - acc: 0.7031
 192/1283 [===>..........................] - ETA: 0s - loss: 0.5723 - acc: 0.7292
 320/1283 [======>.......................] - ETA: 0s - loss: 0.5687 - acc: 0.7156
 384/1283 [=======>......................] - ETA: 0s - loss: 0.5757 - acc: 0.7031
 512/1283 [==========>...................] - ETA: 0s - loss: 0.5736 - acc: 0.7109
 640/1283 [=============>................] - ETA: 0s - loss: 0.5652 - acc: 0.7219
 768/1283 [================>.............] - ETA: 0s - loss: 0.5602 - acc: 0.7318
 896/1283 [===================>..........] - ETA: 0s - loss: 0.5586 - acc: 0.7266
1024/1283 [======================>.......] - ETA: 0s - loss: 0.5589 - acc: 0.7256
1152/1283 [=========================>....] - ETA: 0s - loss: 0.5577 - acc: 0.7222
1280/1283 [============================>.] - ETA: 0s - loss: 0.5586 - acc: 0.7195
1283/1283 [==============================] - 1s 654us/step - loss: 0.5580 - acc: 0.7202 - val_loss: 0.8452 - val_acc: 0.5197

Epoch 00003: val_acc improved from 0.49782 to 0.51965, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_2_ml_15/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_2_ml_15.ckpt
Epoch 4/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5066 - acc: 0.7188
 192/1283 [===>..........................] - ETA: 0s - loss: 0.5055 - acc: 0.7240
 384/1283 [=======>......................] - ETA: 0s - loss: 0.5398 - acc: 0.7005
 512/1283 [==========>...................] - ETA: 0s - loss: 0.5207 - acc: 0.7363
 704/1283 [===============>..............] - ETA: 0s - loss: 0.5192 - acc: 0.7344
 832/1283 [==================>...........] - ETA: 0s - loss: 0.5161 - acc: 0.7404
1024/1283 [======================>.......] - ETA: 0s - loss: 0.5180 - acc: 0.7393
1152/1283 [=========================>....] - ETA: 0s - loss: 0.5154 - acc: 0.7422
1280/1283 [============================>.] - ETA: 0s - loss: 0.5157 - acc: 0.7414
1283/1283 [==============================] - 1s 483us/step - loss: 0.5154 - acc: 0.7420 - val_loss: 0.8684 - val_acc: 0.5022

Epoch 00004: val_acc did not improve
Epoch 5/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5071 - acc: 0.7031
 192/1283 [===>..........................] - ETA: 0s - loss: 0.5104 - acc: 0.7135
 320/1283 [======>.......................] - ETA: 0s - loss: 0.4664 - acc: 0.7688
 448/1283 [=========>....................] - ETA: 0s - loss: 0.4607 - acc: 0.7812
 576/1283 [============>.................] - ETA: 0s - loss: 0.4436 - acc: 0.7969
 768/1283 [================>.............] - ETA: 0s - loss: 0.4447 - acc: 0.7956
 960/1283 [=====================>........] - ETA: 0s - loss: 0.4441 - acc: 0.7927
1088/1283 [========================>.....] - ETA: 0s - loss: 0.4396 - acc: 0.7978
1152/1283 [=========================>....] - ETA: 0s - loss: 0.4366 - acc: 0.7995
1280/1283 [============================>.] - ETA: 0s - loss: 0.4417 - acc: 0.7930
1283/1283 [==============================] - 1s 542us/step - loss: 0.4416 - acc: 0.7935 - val_loss: 0.8484 - val_acc: 0.5109

Epoch 00005: val_acc did not improve
Epoch 6/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.3635 - acc: 0.8438
 192/1283 [===>..........................] - ETA: 0s - loss: 0.3644 - acc: 0.8594
 320/1283 [======>.......................] - ETA: 0s - loss: 0.3951 - acc: 0.8156
 512/1283 [==========>...................] - ETA: 0s - loss: 0.3878 - acc: 0.8164
 640/1283 [=============>................] - ETA: 0s - loss: 0.3905 - acc: 0.8156
 768/1283 [================>.............] - ETA: 0s - loss: 0.3844 - acc: 0.8203
 960/1283 [=====================>........] - ETA: 0s - loss: 0.3743 - acc: 0.8292
1088/1283 [========================>.....] - ETA: 0s - loss: 0.3743 - acc: 0.8346
1216/1283 [===========================>..] - ETA: 0s - loss: 0.3742 - acc: 0.8380
1280/1283 [============================>.] - ETA: 0s - loss: 0.3742 - acc: 0.8359
1283/1283 [==============================] - 1s 592us/step - loss: 0.3749 - acc: 0.8348 - val_loss: 1.0000 - val_acc: 0.5153

Epoch 00006: val_acc did not improve
Epoch 7/100

  64/1283 [>.............................] - ETA: 1s - loss: 0.3216 - acc: 0.8750
 128/1283 [=>............................] - ETA: 0s - loss: 0.3794 - acc: 0.8438
 256/1283 [====>.........................] - ETA: 0s - loss: 0.4131 - acc: 0.7852
 384/1283 [=======>......................] - ETA: 0s - loss: 0.3805 - acc: 0.8255
 512/1283 [==========>...................] - ETA: 0s - loss: 0.3918 - acc: 0.8125
 640/1283 [=============>................] - ETA: 0s - loss: 0.3822 - acc: 0.8203
 768/1283 [================>.............] - ETA: 0s - loss: 0.3618 - acc: 0.8385
 896/1283 [===================>..........] - ETA: 0s - loss: 0.3544 - acc: 0.8426
1024/1283 [======================>.......] - ETA: 0s - loss: 0.3494 - acc: 0.8486
1152/1283 [=========================>....] - ETA: 0s - loss: 0.3456 - acc: 0.8533
1280/1283 [============================>.] - ETA: 0s - loss: 0.3500 - acc: 0.8508
1283/1283 [==============================] - 1s 623us/step - loss: 0.3499 - acc: 0.8511 - val_loss: 0.9253 - val_acc: 0.5546

Epoch 00007: val_acc improved from 0.51965 to 0.55459, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_2_ml_15/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_2_ml_15.ckpt
Epoch 8/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.2692 - acc: 0.9062
 192/1283 [===>..........................] - ETA: 0s - loss: 0.2697 - acc: 0.9115
 256/1283 [====>.........................] - ETA: 0s - loss: 0.2538 - acc: 0.9141
 384/1283 [=======>......................] - ETA: 0s - loss: 0.2339 - acc: 0.9297
 448/1283 [=========>....................] - ETA: 0s - loss: 0.2366 - acc: 0.9308
 576/1283 [============>.................] - ETA: 0s - loss: 0.2475 - acc: 0.9201
 704/1283 [===============>..............] - ETA: 0s - loss: 0.2462 - acc: 0.9190
 832/1283 [==================>...........] - ETA: 0s - loss: 0.2464 - acc: 0.9219
1024/1283 [======================>.......] - ETA: 0s - loss: 0.2474 - acc: 0.9209
1152/1283 [=========================>....] - ETA: 0s - loss: 0.2430 - acc: 0.9253
1280/1283 [============================>.] - ETA: 0s - loss: 0.2399 - acc: 0.9273
1283/1283 [==============================] - 1s 598us/step - loss: 0.2398 - acc: 0.9275 - val_loss: 1.0017 - val_acc: 0.5328

Epoch 00008: val_acc did not improve
Epoch 9/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.2023 - acc: 0.9531
 192/1283 [===>..........................] - ETA: 0s - loss: 0.1821 - acc: 0.9479
 320/1283 [======>.......................] - ETA: 0s - loss: 0.1804 - acc: 0.9500
 512/1283 [==========>...................] - ETA: 0s - loss: 0.1841 - acc: 0.9531
 640/1283 [=============>................] - ETA: 0s - loss: 0.1836 - acc: 0.9547
 768/1283 [================>.............] - ETA: 0s - loss: 0.1783 - acc: 0.9583
 896/1283 [===================>..........] - ETA: 0s - loss: 0.1738 - acc: 0.9609
1024/1283 [======================>.......] - ETA: 0s - loss: 0.1742 - acc: 0.9580
1088/1283 [========================>.....] - ETA: 0s - loss: 0.1737 - acc: 0.9586
1216/1283 [===========================>..] - ETA: 0s - loss: 0.1683 - acc: 0.9622
1283/1283 [==============================] - 1s 524us/step - loss: 0.1688 - acc: 0.9610 - val_loss: 1.1946 - val_acc: 0.5502

Epoch 00009: val_acc did not improve
Epoch 10/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1799 - acc: 0.9375
 256/1283 [====>.........................] - ETA: 0s - loss: 0.1624 - acc: 0.9375
 384/1283 [=======>......................] - ETA: 0s - loss: 0.1593 - acc: 0.9505
 576/1283 [============>.................] - ETA: 0s - loss: 0.1440 - acc: 0.9601
 704/1283 [===============>..............] - ETA: 0s - loss: 0.1379 - acc: 0.9616
 896/1283 [===================>..........] - ETA: 0s - loss: 0.1375 - acc: 0.9632
1088/1283 [========================>.....] - ETA: 0s - loss: 0.1331 - acc: 0.9678
1216/1283 [===========================>..] - ETA: 0s - loss: 0.1314 - acc: 0.9688
1283/1283 [==============================] - 1s 475us/step - loss: 0.1326 - acc: 0.9673 - val_loss: 1.3076 - val_acc: 0.5240

Epoch 00010: val_acc did not improve
Epoch 11/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0761 - acc: 0.9844
 192/1283 [===>..........................] - ETA: 0s - loss: 0.1173 - acc: 0.9792
 320/1283 [======>.......................] - ETA: 0s - loss: 0.1237 - acc: 0.9719
 448/1283 [=========>....................] - ETA: 0s - loss: 0.1186 - acc: 0.9754
 576/1283 [============>.................] - ETA: 0s - loss: 0.1237 - acc: 0.9722
 704/1283 [===============>..............] - ETA: 0s - loss: 0.1212 - acc: 0.9716
 832/1283 [==================>...........] - ETA: 0s - loss: 0.1229 - acc: 0.9688
 960/1283 [=====================>........] - ETA: 0s - loss: 0.1228 - acc: 0.9677
1088/1283 [========================>.....] - ETA: 0s - loss: 0.1252 - acc: 0.9669
1280/1283 [============================>.] - ETA: 0s - loss: 0.1234 - acc: 0.9672
1283/1283 [==============================] - 1s 474us/step - loss: 0.1232 - acc: 0.9673 - val_loss: 1.3275 - val_acc: 0.5240

Epoch 00011: val_acc did not improve
Epoch 12/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0802 - acc: 0.9844
 256/1283 [====>.........................] - ETA: 0s - loss: 0.0716 - acc: 0.9922
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0692 - acc: 0.9888
 640/1283 [=============>................] - ETA: 0s - loss: 0.0706 - acc: 0.9859
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0715 - acc: 0.9856
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0697 - acc: 0.9873
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0696 - acc: 0.9885
1283/1283 [==============================] - 0s 381us/step - loss: 0.0693 - acc: 0.9883 - val_loss: 1.4959 - val_acc: 0.5459

Epoch 00012: val_acc did not improve
Epoch 13/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0312 - acc: 1.0000
 192/1283 [===>..........................] - ETA: 0s - loss: 0.0461 - acc: 1.0000
 320/1283 [======>.......................] - ETA: 0s - loss: 0.0536 - acc: 0.9938
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0533 - acc: 0.9933
 576/1283 [============>.................] - ETA: 0s - loss: 0.0484 - acc: 0.9948
 768/1283 [================>.............] - ETA: 0s - loss: 0.0490 - acc: 0.9948
 896/1283 [===================>..........] - ETA: 0s - loss: 0.0520 - acc: 0.9922
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0559 - acc: 0.9917
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0580 - acc: 0.9901
1283/1283 [==============================] - 1s 504us/step - loss: 0.0601 - acc: 0.9875 - val_loss: 1.5122 - val_acc: 0.5546

Epoch 00013: val_acc did not improve
Epoch 14/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0296 - acc: 1.0000
 256/1283 [====>.........................] - ETA: 0s - loss: 0.0447 - acc: 0.9922
 384/1283 [=======>......................] - ETA: 0s - loss: 0.0406 - acc: 0.9948
 576/1283 [============>.................] - ETA: 0s - loss: 0.0367 - acc: 0.9965
 768/1283 [================>.............] - ETA: 0s - loss: 0.0385 - acc: 0.9935
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0378 - acc: 0.9940
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0373 - acc: 0.9948
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0384 - acc: 0.9936
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0375 - acc: 0.9934
1283/1283 [==============================] - 1s 473us/step - loss: 0.0377 - acc: 0.9938 - val_loss: 1.5642 - val_acc: 0.5240

Epoch 00014: val_acc did not improve
Epoch 15/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0208 - acc: 1.0000
 192/1283 [===>..........................] - ETA: 0s - loss: 0.0279 - acc: 0.9948
 384/1283 [=======>......................] - ETA: 0s - loss: 0.0244 - acc: 0.9974
 576/1283 [============>.................] - ETA: 0s - loss: 0.0228 - acc: 0.9983
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0223 - acc: 0.9986
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0257 - acc: 0.9964
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0276 - acc: 0.9958
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0274 - acc: 0.9954
1280/1283 [============================>.] - ETA: 0s - loss: 0.0265 - acc: 0.9953
1283/1283 [==============================] - 1s 427us/step - loss: 0.0265 - acc: 0.9953 - val_loss: 1.6780 - val_acc: 0.5502

Epoch 00015: val_acc did not improve
Epoch 16/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0086 - acc: 1.0000
 128/1283 [=>............................] - ETA: 0s - loss: 0.0189 - acc: 0.9922
 320/1283 [======>.......................] - ETA: 0s - loss: 0.0264 - acc: 0.9906
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0254 - acc: 0.9933
 576/1283 [============>.................] - ETA: 0s - loss: 0.0241 - acc: 0.9948
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0254 - acc: 0.9943
 896/1283 [===================>..........] - ETA: 0s - loss: 0.0285 - acc: 0.9944
1152/1283 [=========================>....] - ETA: 0s - loss: 0.0261 - acc: 0.9957
1280/1283 [============================>.] - ETA: 0s - loss: 0.0273 - acc: 0.9938
1283/1283 [==============================] - 1s 418us/step - loss: 0.0274 - acc: 0.9938 - val_loss: 1.6750 - val_acc: 0.5328

Epoch 00016: val_acc did not improve
Epoch 17/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0187 - acc: 1.0000
 192/1283 [===>..........................] - ETA: 0s - loss: 0.0295 - acc: 0.9948
 320/1283 [======>.......................] - ETA: 0s - loss: 0.0350 - acc: 0.9906
 512/1283 [==========>...................] - ETA: 0s - loss: 0.0326 - acc: 0.9922
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0316 - acc: 0.9943
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0314 - acc: 0.9952
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0299 - acc: 0.9961
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0299 - acc: 0.9963
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0294 - acc: 0.9959
1283/1283 [==============================] - 1s 471us/step - loss: 0.0299 - acc: 0.9953 - val_loss: 1.7788 - val_acc: 0.5459

Epoch 00017: val_acc did not improve
Epoch 00017: early stopping
batch_size=64
batch_norm=False
dropout_rate=0.1
n_layers=2
max_len=15
nodes=100
mode=A
PCA audio=30
PCA visual=30
PCA text=100
accuracy=0.5189504373177842
best_valid_accuracy=0.48104956268221577
/afs/inf.ed.ac.uk/user/s17/s1738075/.local/lib/python2.7/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
pca_early_fusion_cnn.py:146: RuntimeWarning: invalid value encountered in divide
  train_set_audio = train_set_audio / audio_max
pca_early_fusion_cnn.py:148: RuntimeWarning: invalid value encountered in divide
  test_set_audio = test_set_audio / audio_max
2018-03-28 22:44:42.551047: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
This API will be deprecated in the future versions. Please check the Github page for the current API

Modality facet for video 8qrpnFRGt2A segment 13 is (partially) missing and is thus being replaced by zeros!

Train on 1283 samples, validate on 229 samples
Epoch 1/100

  64/1283 [>.............................] - ETA: 3s - loss: 0.6722 - acc: 0.5938
 384/1283 [=======>......................] - ETA: 0s - loss: 0.7253 - acc: 0.5599
 704/1283 [===============>..............] - ETA: 0s - loss: 0.7293 - acc: 0.5384
1024/1283 [======================>.......] - ETA: 0s - loss: 0.7233 - acc: 0.5342
1283/1283 [==============================] - 0s 372us/step - loss: 0.7185 - acc: 0.5362 - val_loss: 0.7135 - val_acc: 0.4672

Epoch 00001: val_acc improved from -inf to 0.46725, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_2_ml_15/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_2_ml_15.ckpt
Epoch 2/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.6188 - acc: 0.6875
 384/1283 [=======>......................] - ETA: 0s - loss: 0.6444 - acc: 0.6172
 576/1283 [============>.................] - ETA: 0s - loss: 0.6479 - acc: 0.6146
 768/1283 [================>.............] - ETA: 0s - loss: 0.6390 - acc: 0.6393
1024/1283 [======================>.......] - ETA: 0s - loss: 0.6433 - acc: 0.6211
1216/1283 [===========================>..] - ETA: 0s - loss: 0.6384 - acc: 0.6316
1283/1283 [==============================] - 0s 278us/step - loss: 0.6377 - acc: 0.6368 - val_loss: 0.7070 - val_acc: 0.4760

Epoch 00002: val_acc improved from 0.46725 to 0.47598, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_2_ml_15/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_2_ml_15.ckpt
Epoch 3/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5796 - acc: 0.7031
 320/1283 [======>.......................] - ETA: 0s - loss: 0.5826 - acc: 0.7531
 512/1283 [==========>...................] - ETA: 0s - loss: 0.5781 - acc: 0.7559
 768/1283 [================>.............] - ETA: 0s - loss: 0.5772 - acc: 0.7383
 960/1283 [=====================>........] - ETA: 0s - loss: 0.5673 - acc: 0.7438
1152/1283 [=========================>....] - ETA: 0s - loss: 0.5625 - acc: 0.7422
1283/1283 [==============================] - 0s 274us/step - loss: 0.5621 - acc: 0.7412 - val_loss: 0.7470 - val_acc: 0.4891

Epoch 00003: val_acc improved from 0.47598 to 0.48908, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_2_ml_15/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_2_ml_15.ckpt
Epoch 4/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.4954 - acc: 0.7812
 448/1283 [=========>....................] - ETA: 0s - loss: 0.4996 - acc: 0.7746
 704/1283 [===============>..............] - ETA: 0s - loss: 0.4946 - acc: 0.7884
 896/1283 [===================>..........] - ETA: 0s - loss: 0.4875 - acc: 0.7902
1152/1283 [=========================>....] - ETA: 0s - loss: 0.4882 - acc: 0.7839
1283/1283 [==============================] - 0s 253us/step - loss: 0.4867 - acc: 0.7849 - val_loss: 0.7923 - val_acc: 0.5284

Epoch 00004: val_acc improved from 0.48908 to 0.52838, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_2_ml_15/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_2_ml_15.ckpt
Epoch 5/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.4259 - acc: 0.8281
 448/1283 [=========>....................] - ETA: 0s - loss: 0.4056 - acc: 0.8170
 704/1283 [===============>..............] - ETA: 0s - loss: 0.4005 - acc: 0.8267
 832/1283 [==================>...........] - ETA: 0s - loss: 0.3973 - acc: 0.8293
1088/1283 [========================>.....] - ETA: 0s - loss: 0.3999 - acc: 0.8272
1283/1283 [==============================] - 0s 243us/step - loss: 0.4002 - acc: 0.8309 - val_loss: 0.8488 - val_acc: 0.4891

Epoch 00005: val_acc did not improve
Epoch 6/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.3510 - acc: 0.8125
 384/1283 [=======>......................] - ETA: 0s - loss: 0.3901 - acc: 0.7995
 576/1283 [============>.................] - ETA: 0s - loss: 0.3680 - acc: 0.8316
 832/1283 [==================>...........] - ETA: 0s - loss: 0.3649 - acc: 0.8401
1024/1283 [======================>.......] - ETA: 0s - loss: 0.3593 - acc: 0.8447
1283/1283 [==============================] - 0s 228us/step - loss: 0.3552 - acc: 0.8535 - val_loss: 0.8730 - val_acc: 0.5197

Epoch 00006: val_acc did not improve
Epoch 7/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.2555 - acc: 0.9062
 384/1283 [=======>......................] - ETA: 0s - loss: 0.2556 - acc: 0.9349
 576/1283 [============>.................] - ETA: 0s - loss: 0.2471 - acc: 0.9410
 832/1283 [==================>...........] - ETA: 0s - loss: 0.2473 - acc: 0.9363
1024/1283 [======================>.......] - ETA: 0s - loss: 0.2402 - acc: 0.9395
1280/1283 [============================>.] - ETA: 0s - loss: 0.2344 - acc: 0.9375
1283/1283 [==============================] - 0s 288us/step - loss: 0.2344 - acc: 0.9376 - val_loss: 0.9488 - val_acc: 0.5546

Epoch 00007: val_acc improved from 0.52838 to 0.55459, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_2_ml_15/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_2_ml_15.ckpt
Epoch 8/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1784 - acc: 0.9531
 320/1283 [======>.......................] - ETA: 0s - loss: 0.1725 - acc: 0.9594
 576/1283 [============>.................] - ETA: 0s - loss: 0.1766 - acc: 0.9444
 896/1283 [===================>..........] - ETA: 0s - loss: 0.1689 - acc: 0.9487
1216/1283 [===========================>..] - ETA: 0s - loss: 0.1699 - acc: 0.9490
1283/1283 [==============================] - 0s 207us/step - loss: 0.1675 - acc: 0.9509 - val_loss: 1.1229 - val_acc: 0.5459

Epoch 00008: val_acc did not improve
Epoch 9/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1522 - acc: 0.9531
 384/1283 [=======>......................] - ETA: 0s - loss: 0.1840 - acc: 0.9245
 704/1283 [===============>..............] - ETA: 0s - loss: 0.1896 - acc: 0.9190
1024/1283 [======================>.......] - ETA: 0s - loss: 0.1759 - acc: 0.9336
1280/1283 [============================>.] - ETA: 0s - loss: 0.1693 - acc: 0.9398
1283/1283 [==============================] - 0s 207us/step - loss: 0.1691 - acc: 0.9400 - val_loss: 1.1659 - val_acc: 0.5197

Epoch 00009: val_acc did not improve
Epoch 10/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1487 - acc: 0.9531
 320/1283 [======>.......................] - ETA: 0s - loss: 0.1029 - acc: 0.9750
 576/1283 [============>.................] - ETA: 0s - loss: 0.0981 - acc: 0.9809
 896/1283 [===================>..........] - ETA: 0s - loss: 0.0989 - acc: 0.9766
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0953 - acc: 0.9745
1283/1283 [==============================] - 0s 213us/step - loss: 0.0954 - acc: 0.9743 - val_loss: 1.3696 - val_acc: 0.5415

Epoch 00010: val_acc did not improve
Epoch 11/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0572 - acc: 0.9844
 320/1283 [======>.......................] - ETA: 0s - loss: 0.0723 - acc: 0.9844
 576/1283 [============>.................] - ETA: 0s - loss: 0.0772 - acc: 0.9826
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0732 - acc: 0.9844
1152/1283 [=========================>....] - ETA: 0s - loss: 0.0740 - acc: 0.9818
1283/1283 [==============================] - 0s 220us/step - loss: 0.0748 - acc: 0.9805 - val_loss: 1.3483 - val_acc: 0.5371

Epoch 00011: val_acc did not improve
Epoch 12/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0402 - acc: 1.0000
 320/1283 [======>.......................] - ETA: 0s - loss: 0.0465 - acc: 0.9906
 576/1283 [============>.................] - ETA: 0s - loss: 0.0434 - acc: 0.9931
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0402 - acc: 0.9940
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0412 - acc: 0.9941
1152/1283 [=========================>....] - ETA: 0s - loss: 0.0410 - acc: 0.9948
1283/1283 [==============================] - 0s 280us/step - loss: 0.0428 - acc: 0.9938 - val_loss: 1.8035 - val_acc: 0.5415

Epoch 00012: val_acc did not improve
Epoch 13/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0638 - acc: 0.9844
 448/1283 [=========>....................] - ETA: 0s - loss: 0.1011 - acc: 0.9665
 640/1283 [=============>................] - ETA: 0s - loss: 0.0974 - acc: 0.9719
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0896 - acc: 0.9756
1283/1283 [==============================] - 0s 205us/step - loss: 0.0949 - acc: 0.9712 - val_loss: 1.5169 - val_acc: 0.5459

Epoch 00013: val_acc did not improve
Epoch 14/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0279 - acc: 1.0000
 320/1283 [======>.......................] - ETA: 0s - loss: 0.0598 - acc: 0.9875
 576/1283 [============>.................] - ETA: 0s - loss: 0.0489 - acc: 0.9896
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0479 - acc: 0.9904
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0463 - acc: 0.9908
1283/1283 [==============================] - 0s 231us/step - loss: 0.0456 - acc: 0.9914 - val_loss: 1.4837 - val_acc: 0.5371

Epoch 00014: val_acc did not improve
Epoch 15/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0315 - acc: 1.0000
 384/1283 [=======>......................] - ETA: 0s - loss: 0.0300 - acc: 1.0000
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0295 - acc: 0.9957
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0271 - acc: 0.9969
1280/1283 [============================>.] - ETA: 0s - loss: 0.0263 - acc: 0.9945
1283/1283 [==============================] - 0s 205us/step - loss: 0.0263 - acc: 0.9945 - val_loss: 1.6037 - val_acc: 0.5546

Epoch 00015: val_acc did not improve
Epoch 16/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0252 - acc: 1.0000
 384/1283 [=======>......................] - ETA: 0s - loss: 0.0196 - acc: 0.9974
 576/1283 [============>.................] - ETA: 0s - loss: 0.0196 - acc: 0.9948
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0179 - acc: 0.9957
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0181 - acc: 0.9958
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0172 - acc: 0.9967
1283/1283 [==============================] - 0s 256us/step - loss: 0.0178 - acc: 0.9961 - val_loss: 1.6747 - val_acc: 0.5764

Epoch 00016: val_acc improved from 0.55459 to 0.57642, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_2_ml_15/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_2_ml_15.ckpt
Epoch 17/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0071 - acc: 1.0000
 320/1283 [======>.......................] - ETA: 0s - loss: 0.0148 - acc: 0.9969
 576/1283 [============>.................] - ETA: 0s - loss: 0.0180 - acc: 0.9948
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0158 - acc: 0.9952
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0148 - acc: 0.9954
1283/1283 [==============================] - 0s 225us/step - loss: 0.0134 - acc: 0.9961 - val_loss: 1.7750 - val_acc: 0.5415

Epoch 00017: val_acc did not improve
Epoch 18/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0093 - acc: 1.0000
 384/1283 [=======>......................] - ETA: 0s - loss: 0.0139 - acc: 0.9974
 768/1283 [================>.............] - ETA: 0s - loss: 0.0170 - acc: 0.9961
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0151 - acc: 0.9963
1283/1283 [==============================] - 0s 185us/step - loss: 0.0152 - acc: 0.9961 - val_loss: 1.8707 - val_acc: 0.5328

Epoch 00018: val_acc did not improve
Epoch 19/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0140 - acc: 1.0000
 384/1283 [=======>......................] - ETA: 0s - loss: 0.0097 - acc: 1.0000
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0111 - acc: 1.0000
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0120 - acc: 0.9980
1283/1283 [==============================] - 0s 193us/step - loss: 0.0121 - acc: 0.9977 - val_loss: 1.8518 - val_acc: 0.5328

Epoch 00019: val_acc did not improve
Epoch 20/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0036 - acc: 1.0000
 384/1283 [=======>......................] - ETA: 0s - loss: 0.0183 - acc: 0.9974
 640/1283 [=============>................] - ETA: 0s - loss: 0.0152 - acc: 0.9984
 896/1283 [===================>..........] - ETA: 0s - loss: 0.0151 - acc: 0.9967
1152/1283 [=========================>....] - ETA: 0s - loss: 0.0152 - acc: 0.9974
1283/1283 [==============================] - 0s 223us/step - loss: 0.0143 - acc: 0.9977 - val_loss: 1.9552 - val_acc: 0.5328

Epoch 00020: val_acc did not improve
Epoch 21/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0049 - acc: 1.0000
 320/1283 [======>.......................] - ETA: 0s - loss: 0.0088 - acc: 0.9969
 576/1283 [============>.................] - ETA: 0s - loss: 0.0114 - acc: 0.9948
 896/1283 [===================>..........] - ETA: 0s - loss: 0.0120 - acc: 0.9944
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0107 - acc: 0.9959
1283/1283 [==============================] - 0s 212us/step - loss: 0.0106 - acc: 0.9961 - val_loss: 1.9746 - val_acc: 0.5415

Epoch 00021: val_acc did not improve
Epoch 22/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0050 - acc: 1.0000
 320/1283 [======>.......................] - ETA: 0s - loss: 0.0068 - acc: 0.9969
 512/1283 [==========>...................] - ETA: 0s - loss: 0.0091 - acc: 0.9980
 768/1283 [================>.............] - ETA: 0s - loss: 0.0114 - acc: 0.9974
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0111 - acc: 0.9972
1283/1283 [==============================] - 0s 222us/step - loss: 0.0109 - acc: 0.9969 - val_loss: 2.0893 - val_acc: 0.5371

Epoch 00022: val_acc did not improve
Epoch 23/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0031 - acc: 1.0000
 320/1283 [======>.......................] - ETA: 0s - loss: 0.0042 - acc: 1.0000
 640/1283 [=============>................] - ETA: 0s - loss: 0.0065 - acc: 1.0000
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0082 - acc: 0.9990
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0083 - acc: 0.9984
1283/1283 [==============================] - 0s 220us/step - loss: 0.0080 - acc: 0.9984 - val_loss: 2.1269 - val_acc: 0.5284

Epoch 00023: val_acc did not improve
Epoch 24/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0131 - acc: 0.9844
 384/1283 [=======>......................] - ETA: 0s - loss: 0.0051 - acc: 0.9974
 640/1283 [=============>................] - ETA: 0s - loss: 0.0064 - acc: 0.9969
 896/1283 [===================>..........] - ETA: 0s - loss: 0.0083 - acc: 0.9944
1152/1283 [=========================>....] - ETA: 0s - loss: 0.0073 - acc: 0.9957
1283/1283 [==============================] - 0s 227us/step - loss: 0.0073 - acc: 0.9961 - val_loss: 2.0366 - val_acc: 0.5502

Epoch 00024: val_acc did not improve
Epoch 25/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0141 - acc: 0.9844
 320/1283 [======>.......................] - ETA: 0s - loss: 0.0068 - acc: 0.9969
 576/1283 [============>.................] - ETA: 0s - loss: 0.0082 - acc: 0.9948
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0083 - acc: 0.9958
1280/1283 [============================>.] - ETA: 0s - loss: 0.0070 - acc: 0.9969
1283/1283 [==============================] - 0s 199us/step - loss: 0.0070 - acc: 0.9969 - val_loss: 2.1023 - val_acc: 0.5502

Epoch 00025: val_acc did not improve
Epoch 26/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0017 - acc: 1.0000
 384/1283 [=======>......................] - ETA: 0s - loss: 0.0035 - acc: 1.0000
 768/1283 [================>.............] - ETA: 0s - loss: 0.0042 - acc: 0.9987
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0047 - acc: 0.9990
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0055 - acc: 0.9975
1283/1283 [==============================] - 0s 232us/step - loss: 0.0063 - acc: 0.9969 - val_loss: 2.1132 - val_acc: 0.5328

Epoch 00026: val_acc did not improve
Epoch 00026: early stopping
batch_size=64
batch_norm=False
dropout_rate=0.1
n_layers=2
max_len=15
nodes=100
mode=A
PCA audio=30
PCA visual=35
PCA text=100
accuracy=0.5087463556851312
best_valid_accuracy=0.5043731778425656
