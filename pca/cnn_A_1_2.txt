/afs/inf.ed.ac.uk/user/s17/s1738075/.local/lib/python2.7/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
pca_early_fusion_cnn.py:146: RuntimeWarning: invalid value encountered in divide
  train_set_audio = train_set_audio / audio_max
pca_early_fusion_cnn.py:148: RuntimeWarning: invalid value encountered in divide
  test_set_audio = test_set_audio / audio_max
2018-03-28 21:48:18.609251: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
This API will be deprecated in the future versions. Please check the Github page for the current API

Modality facet for video 8qrpnFRGt2A segment 13 is (partially) missing and is thus being replaced by zeros!

Train on 1283 samples, validate on 229 samples
Epoch 1/100

  64/1283 [>.............................] - ETA: 12s - loss: 0.7133 - acc: 0.4688
 192/1283 [===>..........................] - ETA: 3s - loss: 0.7037 - acc: 0.5208 
 320/1283 [======>.......................] - ETA: 2s - loss: 0.7031 - acc: 0.5375
 448/1283 [=========>....................] - ETA: 1s - loss: 0.7106 - acc: 0.5402
 576/1283 [============>.................] - ETA: 1s - loss: 0.7194 - acc: 0.5347
 704/1283 [===============>..............] - ETA: 0s - loss: 0.7168 - acc: 0.5241
 832/1283 [==================>...........] - ETA: 0s - loss: 0.7136 - acc: 0.5312
 960/1283 [=====================>........] - ETA: 0s - loss: 0.7105 - acc: 0.5323
1088/1283 [========================>.....] - ETA: 0s - loss: 0.7069 - acc: 0.5404
1152/1283 [=========================>....] - ETA: 0s - loss: 0.7057 - acc: 0.5434
1283/1283 [==============================] - 1s 1ms/step - loss: 0.7070 - acc: 0.5394 - val_loss: 0.6889 - val_acc: 0.5721

Epoch 00001: val_acc improved from -inf to 0.57205, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20.ckpt
Epoch 2/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.6554 - acc: 0.5312
 256/1283 [====>.........................] - ETA: 0s - loss: 0.6368 - acc: 0.5977
 448/1283 [=========>....................] - ETA: 0s - loss: 0.6362 - acc: 0.6272
 576/1283 [============>.................] - ETA: 0s - loss: 0.6385 - acc: 0.6267
 640/1283 [=============>................] - ETA: 0s - loss: 0.6431 - acc: 0.6203
 768/1283 [================>.............] - ETA: 0s - loss: 0.6362 - acc: 0.6380
 960/1283 [=====================>........] - ETA: 0s - loss: 0.6348 - acc: 0.6396
1088/1283 [========================>.....] - ETA: 0s - loss: 0.6358 - acc: 0.6360
1152/1283 [=========================>....] - ETA: 0s - loss: 0.6364 - acc: 0.6363
1280/1283 [============================>.] - ETA: 0s - loss: 0.6309 - acc: 0.6422
1283/1283 [==============================] - 1s 607us/step - loss: 0.6306 - acc: 0.6430 - val_loss: 0.7098 - val_acc: 0.5502

Epoch 00002: val_acc did not improve
Epoch 3/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5748 - acc: 0.6719
 192/1283 [===>..........................] - ETA: 0s - loss: 0.6254 - acc: 0.6094
 320/1283 [======>.......................] - ETA: 0s - loss: 0.6151 - acc: 0.6469
 384/1283 [=======>......................] - ETA: 0s - loss: 0.6148 - acc: 0.6432
 512/1283 [==========>...................] - ETA: 0s - loss: 0.6160 - acc: 0.6406
 576/1283 [============>.................] - ETA: 0s - loss: 0.6204 - acc: 0.6354
 768/1283 [================>.............] - ETA: 0s - loss: 0.6128 - acc: 0.6445
 896/1283 [===================>..........] - ETA: 0s - loss: 0.6167 - acc: 0.6462
1024/1283 [======================>.......] - ETA: 0s - loss: 0.6162 - acc: 0.6475
1216/1283 [===========================>..] - ETA: 0s - loss: 0.6131 - acc: 0.6571
1283/1283 [==============================] - 1s 623us/step - loss: 0.6149 - acc: 0.6555 - val_loss: 0.6971 - val_acc: 0.5764

Epoch 00003: val_acc improved from 0.57205 to 0.57642, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20.ckpt
Epoch 4/100

  64/1283 [>.............................] - ETA: 1s - loss: 0.5485 - acc: 0.8750
 128/1283 [=>............................] - ETA: 1s - loss: 0.5864 - acc: 0.7734
 256/1283 [====>.........................] - ETA: 0s - loss: 0.6038 - acc: 0.7031
 384/1283 [=======>......................] - ETA: 0s - loss: 0.5814 - acc: 0.7214
 448/1283 [=========>....................] - ETA: 0s - loss: 0.5756 - acc: 0.7254
 512/1283 [==========>...................] - ETA: 0s - loss: 0.5737 - acc: 0.7305
 704/1283 [===============>..............] - ETA: 0s - loss: 0.5767 - acc: 0.7173
 960/1283 [=====================>........] - ETA: 0s - loss: 0.5746 - acc: 0.7146
1216/1283 [===========================>..] - ETA: 0s - loss: 0.5765 - acc: 0.7097
1283/1283 [==============================] - 1s 672us/step - loss: 0.5743 - acc: 0.7124 - val_loss: 0.7052 - val_acc: 0.5808

Epoch 00004: val_acc improved from 0.57642 to 0.58079, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20.ckpt
Epoch 5/100

  64/1283 [>.............................] - ETA: 2s - loss: 0.5314 - acc: 0.7656
 128/1283 [=>............................] - ETA: 2s - loss: 0.5521 - acc: 0.7422
 256/1283 [====>.........................] - ETA: 1s - loss: 0.5714 - acc: 0.7148
 448/1283 [=========>....................] - ETA: 0s - loss: 0.5796 - acc: 0.6763
 640/1283 [=============>................] - ETA: 0s - loss: 0.5706 - acc: 0.6937
 832/1283 [==================>...........] - ETA: 0s - loss: 0.5608 - acc: 0.7031
1024/1283 [======================>.......] - ETA: 0s - loss: 0.5552 - acc: 0.7139
1216/1283 [===========================>..] - ETA: 0s - loss: 0.5522 - acc: 0.7163
1283/1283 [==============================] - 1s 518us/step - loss: 0.5512 - acc: 0.7171 - val_loss: 0.7363 - val_acc: 0.5764

Epoch 00005: val_acc did not improve
Epoch 6/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5437 - acc: 0.7500
 192/1283 [===>..........................] - ETA: 0s - loss: 0.5478 - acc: 0.7292
 320/1283 [======>.......................] - ETA: 0s - loss: 0.5287 - acc: 0.7438
 448/1283 [=========>....................] - ETA: 0s - loss: 0.5284 - acc: 0.7433
 576/1283 [============>.................] - ETA: 0s - loss: 0.5204 - acc: 0.7535
 704/1283 [===============>..............] - ETA: 0s - loss: 0.5169 - acc: 0.7543
 832/1283 [==================>...........] - ETA: 0s - loss: 0.5144 - acc: 0.7512
 960/1283 [=====================>........] - ETA: 0s - loss: 0.5151 - acc: 0.7479
1088/1283 [========================>.....] - ETA: 0s - loss: 0.5187 - acc: 0.7426
1216/1283 [===========================>..] - ETA: 0s - loss: 0.5182 - acc: 0.7434
1283/1283 [==============================] - 1s 807us/step - loss: 0.5199 - acc: 0.7443 - val_loss: 0.7407 - val_acc: 0.6026

Epoch 00006: val_acc improved from 0.58079 to 0.60262, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20.ckpt
Epoch 7/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.6225 - acc: 0.6094
 192/1283 [===>..........................] - ETA: 0s - loss: 0.5306 - acc: 0.7188
 384/1283 [=======>......................] - ETA: 0s - loss: 0.5187 - acc: 0.7552
 512/1283 [==========>...................] - ETA: 0s - loss: 0.5229 - acc: 0.7441
 640/1283 [=============>................] - ETA: 0s - loss: 0.5108 - acc: 0.7500
 768/1283 [================>.............] - ETA: 0s - loss: 0.4991 - acc: 0.7669
 960/1283 [=====================>........] - ETA: 0s - loss: 0.4944 - acc: 0.7729
1088/1283 [========================>.....] - ETA: 0s - loss: 0.4919 - acc: 0.7757
1216/1283 [===========================>..] - ETA: 0s - loss: 0.4900 - acc: 0.7763
1280/1283 [============================>.] - ETA: 0s - loss: 0.4911 - acc: 0.7734
1283/1283 [==============================] - 1s 679us/step - loss: 0.4907 - acc: 0.7740 - val_loss: 0.7331 - val_acc: 0.5895

Epoch 00007: val_acc did not improve
Epoch 8/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.4498 - acc: 0.7812
 192/1283 [===>..........................] - ETA: 0s - loss: 0.4654 - acc: 0.7812
 320/1283 [======>.......................] - ETA: 0s - loss: 0.4585 - acc: 0.7812
 448/1283 [=========>....................] - ETA: 0s - loss: 0.4538 - acc: 0.7812
 576/1283 [============>.................] - ETA: 0s - loss: 0.4420 - acc: 0.7951
 704/1283 [===============>..............] - ETA: 0s - loss: 0.4438 - acc: 0.7912
 768/1283 [================>.............] - ETA: 0s - loss: 0.4445 - acc: 0.7917
 896/1283 [===================>..........] - ETA: 0s - loss: 0.4427 - acc: 0.7913
 960/1283 [=====================>........] - ETA: 0s - loss: 0.4414 - acc: 0.7948
1024/1283 [======================>.......] - ETA: 0s - loss: 0.4436 - acc: 0.7949
1088/1283 [========================>.....] - ETA: 0s - loss: 0.4412 - acc: 0.8006
1216/1283 [===========================>..] - ETA: 0s - loss: 0.4435 - acc: 0.7985
1280/1283 [============================>.] - ETA: 0s - loss: 0.4425 - acc: 0.8000
1283/1283 [==============================] - 1s 736us/step - loss: 0.4424 - acc: 0.8005 - val_loss: 0.7322 - val_acc: 0.5852

Epoch 00008: val_acc did not improve
Epoch 9/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.3689 - acc: 0.8438
 192/1283 [===>..........................] - ETA: 0s - loss: 0.4120 - acc: 0.8125
 320/1283 [======>.......................] - ETA: 0s - loss: 0.4085 - acc: 0.8063
 448/1283 [=========>....................] - ETA: 0s - loss: 0.4071 - acc: 0.8058
 576/1283 [============>.................] - ETA: 0s - loss: 0.4049 - acc: 0.8090
 768/1283 [================>.............] - ETA: 0s - loss: 0.4041 - acc: 0.8203
 896/1283 [===================>..........] - ETA: 0s - loss: 0.4115 - acc: 0.8181
 960/1283 [=====================>........] - ETA: 0s - loss: 0.4074 - acc: 0.8208
1088/1283 [========================>.....] - ETA: 0s - loss: 0.4150 - acc: 0.8180
1152/1283 [=========================>....] - ETA: 0s - loss: 0.4148 - acc: 0.8212
1216/1283 [===========================>..] - ETA: 0s - loss: 0.4170 - acc: 0.8207
1280/1283 [============================>.] - ETA: 0s - loss: 0.4172 - acc: 0.8203
1283/1283 [==============================] - 1s 622us/step - loss: 0.4173 - acc: 0.8200 - val_loss: 0.7454 - val_acc: 0.5983

Epoch 00009: val_acc did not improve
Epoch 10/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.3359 - acc: 0.8750
 192/1283 [===>..........................] - ETA: 0s - loss: 0.3797 - acc: 0.8438
 320/1283 [======>.......................] - ETA: 0s - loss: 0.3802 - acc: 0.8500
 448/1283 [=========>....................] - ETA: 0s - loss: 0.3898 - acc: 0.8415
 576/1283 [============>.................] - ETA: 0s - loss: 0.3932 - acc: 0.8299
 704/1283 [===============>..............] - ETA: 0s - loss: 0.3899 - acc: 0.8366
 832/1283 [==================>...........] - ETA: 0s - loss: 0.3980 - acc: 0.8305
 896/1283 [===================>..........] - ETA: 0s - loss: 0.3949 - acc: 0.8326
1088/1283 [========================>.....] - ETA: 0s - loss: 0.3950 - acc: 0.8300
1216/1283 [===========================>..] - ETA: 0s - loss: 0.3946 - acc: 0.8331
1283/1283 [==============================] - 1s 849us/step - loss: 0.3952 - acc: 0.8309 - val_loss: 0.7691 - val_acc: 0.5764

Epoch 00010: val_acc did not improve
Epoch 11/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.2779 - acc: 0.9375
 256/1283 [====>.........................] - ETA: 0s - loss: 0.3128 - acc: 0.8945
 384/1283 [=======>......................] - ETA: 0s - loss: 0.3285 - acc: 0.8750
 576/1283 [============>.................] - ETA: 0s - loss: 0.3371 - acc: 0.8646
 704/1283 [===============>..............] - ETA: 0s - loss: 0.3437 - acc: 0.8608
 832/1283 [==================>...........] - ETA: 0s - loss: 0.3470 - acc: 0.8558
 960/1283 [=====================>........] - ETA: 0s - loss: 0.3453 - acc: 0.8604
1088/1283 [========================>.....] - ETA: 0s - loss: 0.3479 - acc: 0.8594
1216/1283 [===========================>..] - ETA: 0s - loss: 0.3522 - acc: 0.8586
1283/1283 [==============================] - 1s 482us/step - loss: 0.3498 - acc: 0.8620 - val_loss: 0.8232 - val_acc: 0.6114

Epoch 00011: val_acc improved from 0.60262 to 0.61135, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20.ckpt
Epoch 12/100

  64/1283 [>.............................] - ETA: 1s - loss: 0.2893 - acc: 0.8750
 128/1283 [=>............................] - ETA: 1s - loss: 0.3120 - acc: 0.8672
 256/1283 [====>.........................] - ETA: 1s - loss: 0.3462 - acc: 0.8438
 448/1283 [=========>....................] - ETA: 0s - loss: 0.3482 - acc: 0.8571
 640/1283 [=============>................] - ETA: 0s - loss: 0.3539 - acc: 0.8609
 832/1283 [==================>...........] - ETA: 0s - loss: 0.3559 - acc: 0.8534
1024/1283 [======================>.......] - ETA: 0s - loss: 0.3542 - acc: 0.8525
1152/1283 [=========================>....] - ETA: 0s - loss: 0.3515 - acc: 0.8559
1216/1283 [===========================>..] - ETA: 0s - loss: 0.3525 - acc: 0.8569
1283/1283 [==============================] - 1s 718us/step - loss: 0.3504 - acc: 0.8589 - val_loss: 0.8248 - val_acc: 0.5808

Epoch 00012: val_acc did not improve
Epoch 13/100

  64/1283 [>.............................] - ETA: 1s - loss: 0.3187 - acc: 0.8594
 192/1283 [===>..........................] - ETA: 0s - loss: 0.3067 - acc: 0.8958
 384/1283 [=======>......................] - ETA: 0s - loss: 0.2989 - acc: 0.8958
 512/1283 [==========>...................] - ETA: 0s - loss: 0.2982 - acc: 0.8926
 640/1283 [=============>................] - ETA: 0s - loss: 0.3134 - acc: 0.8766
 704/1283 [===============>..............] - ETA: 0s - loss: 0.3086 - acc: 0.8793
 768/1283 [================>.............] - ETA: 0s - loss: 0.3083 - acc: 0.8750
 896/1283 [===================>..........] - ETA: 0s - loss: 0.3079 - acc: 0.8761
1024/1283 [======================>.......] - ETA: 0s - loss: 0.3087 - acc: 0.8740
1152/1283 [=========================>....] - ETA: 0s - loss: 0.3094 - acc: 0.8733
1280/1283 [============================>.] - ETA: 0s - loss: 0.3081 - acc: 0.8742
1283/1283 [==============================] - 1s 653us/step - loss: 0.3092 - acc: 0.8737 - val_loss: 0.9154 - val_acc: 0.5983

Epoch 00013: val_acc did not improve
Epoch 14/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.2885 - acc: 0.8594
 192/1283 [===>..........................] - ETA: 0s - loss: 0.3645 - acc: 0.8125
 320/1283 [======>.......................] - ETA: 0s - loss: 0.3716 - acc: 0.8250
 384/1283 [=======>......................] - ETA: 0s - loss: 0.3633 - acc: 0.8307
 512/1283 [==========>...................] - ETA: 0s - loss: 0.3703 - acc: 0.8359
 640/1283 [=============>................] - ETA: 0s - loss: 0.3707 - acc: 0.8344
 768/1283 [================>.............] - ETA: 0s - loss: 0.3647 - acc: 0.8359
 960/1283 [=====================>........] - ETA: 0s - loss: 0.3661 - acc: 0.8333
1088/1283 [========================>.....] - ETA: 0s - loss: 0.3735 - acc: 0.8254
1152/1283 [=========================>....] - ETA: 0s - loss: 0.3695 - acc: 0.8307
1280/1283 [============================>.] - ETA: 0s - loss: 0.3686 - acc: 0.8281
1283/1283 [==============================] - 1s 562us/step - loss: 0.3694 - acc: 0.8277 - val_loss: 0.8553 - val_acc: 0.5502

Epoch 00014: val_acc did not improve
Epoch 15/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.2902 - acc: 0.9375
 192/1283 [===>..........................] - ETA: 0s - loss: 0.2732 - acc: 0.9010
 320/1283 [======>.......................] - ETA: 0s - loss: 0.3142 - acc: 0.8719
 448/1283 [=========>....................] - ETA: 0s - loss: 0.3116 - acc: 0.8616
 512/1283 [==========>...................] - ETA: 0s - loss: 0.3085 - acc: 0.8672
 640/1283 [=============>................] - ETA: 0s - loss: 0.3081 - acc: 0.8703
 704/1283 [===============>..............] - ETA: 0s - loss: 0.3110 - acc: 0.8651
 768/1283 [================>.............] - ETA: 0s - loss: 0.3099 - acc: 0.8698
 896/1283 [===================>..........] - ETA: 0s - loss: 0.3065 - acc: 0.8750
1024/1283 [======================>.......] - ETA: 0s - loss: 0.3038 - acc: 0.8760
1152/1283 [=========================>....] - ETA: 0s - loss: 0.3046 - acc: 0.8785
1280/1283 [============================>.] - ETA: 0s - loss: 0.3052 - acc: 0.8758
1283/1283 [==============================] - 1s 984us/step - loss: 0.3049 - acc: 0.8761 - val_loss: 0.8483 - val_acc: 0.5939

Epoch 00015: val_acc did not improve
Epoch 16/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.2486 - acc: 0.9219
 256/1283 [====>.........................] - ETA: 0s - loss: 0.2486 - acc: 0.9297
 448/1283 [=========>....................] - ETA: 0s - loss: 0.2478 - acc: 0.9263
 576/1283 [============>.................] - ETA: 0s - loss: 0.2522 - acc: 0.9201
 704/1283 [===============>..............] - ETA: 0s - loss: 0.2496 - acc: 0.9134
 832/1283 [==================>...........] - ETA: 0s - loss: 0.2491 - acc: 0.9159
 960/1283 [=====================>........] - ETA: 0s - loss: 0.2463 - acc: 0.9187
1024/1283 [======================>.......] - ETA: 0s - loss: 0.2452 - acc: 0.9199
1152/1283 [=========================>....] - ETA: 0s - loss: 0.2457 - acc: 0.9175
1280/1283 [============================>.] - ETA: 0s - loss: 0.2440 - acc: 0.9172
1283/1283 [==============================] - 1s 571us/step - loss: 0.2438 - acc: 0.9174 - val_loss: 0.8946 - val_acc: 0.5895

Epoch 00016: val_acc did not improve
Epoch 17/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1940 - acc: 0.9375
 192/1283 [===>..........................] - ETA: 0s - loss: 0.2101 - acc: 0.9323
 320/1283 [======>.......................] - ETA: 0s - loss: 0.2101 - acc: 0.9375
 448/1283 [=========>....................] - ETA: 0s - loss: 0.2148 - acc: 0.9353
 512/1283 [==========>...................] - ETA: 0s - loss: 0.2128 - acc: 0.9336
 640/1283 [=============>................] - ETA: 0s - loss: 0.2134 - acc: 0.9313
 704/1283 [===============>..............] - ETA: 0s - loss: 0.2131 - acc: 0.9318
 768/1283 [================>.............] - ETA: 0s - loss: 0.2136 - acc: 0.9323
 832/1283 [==================>...........] - ETA: 0s - loss: 0.2168 - acc: 0.9327
 896/1283 [===================>..........] - ETA: 0s - loss: 0.2123 - acc: 0.9353
 960/1283 [=====================>........] - ETA: 0s - loss: 0.2115 - acc: 0.9365
1088/1283 [========================>.....] - ETA: 0s - loss: 0.2130 - acc: 0.9375
1216/1283 [===========================>..] - ETA: 0s - loss: 0.2159 - acc: 0.9342
1283/1283 [==============================] - 1s 824us/step - loss: 0.2181 - acc: 0.9330 - val_loss: 0.9191 - val_acc: 0.5721

Epoch 00017: val_acc did not improve
Epoch 18/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1604 - acc: 0.9844
 192/1283 [===>..........................] - ETA: 0s - loss: 0.1830 - acc: 0.9479
 384/1283 [=======>......................] - ETA: 0s - loss: 0.1908 - acc: 0.9453
 512/1283 [==========>...................] - ETA: 0s - loss: 0.1887 - acc: 0.9473
 640/1283 [=============>................] - ETA: 0s - loss: 0.1918 - acc: 0.9453
 832/1283 [==================>...........] - ETA: 0s - loss: 0.1888 - acc: 0.9507
 960/1283 [=====================>........] - ETA: 0s - loss: 0.1877 - acc: 0.9521
1088/1283 [========================>.....] - ETA: 0s - loss: 0.1883 - acc: 0.9485
1216/1283 [===========================>..] - ETA: 0s - loss: 0.1895 - acc: 0.9457
1283/1283 [==============================] - 1s 628us/step - loss: 0.1914 - acc: 0.9431 - val_loss: 0.9536 - val_acc: 0.5764

Epoch 00018: val_acc did not improve
Epoch 19/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1927 - acc: 0.9688
 192/1283 [===>..........................] - ETA: 0s - loss: 0.1588 - acc: 0.9740
 320/1283 [======>.......................] - ETA: 0s - loss: 0.1595 - acc: 0.9750
 448/1283 [=========>....................] - ETA: 0s - loss: 0.1618 - acc: 0.9688
 576/1283 [============>.................] - ETA: 0s - loss: 0.1672 - acc: 0.9653
 704/1283 [===============>..............] - ETA: 0s - loss: 0.1700 - acc: 0.9645
 832/1283 [==================>...........] - ETA: 0s - loss: 0.1715 - acc: 0.9627
 960/1283 [=====================>........] - ETA: 0s - loss: 0.1716 - acc: 0.9635
1024/1283 [======================>.......] - ETA: 0s - loss: 0.1727 - acc: 0.9609
1088/1283 [========================>.....] - ETA: 0s - loss: 0.1697 - acc: 0.9632
1152/1283 [=========================>....] - ETA: 0s - loss: 0.1687 - acc: 0.9627
1280/1283 [============================>.] - ETA: 0s - loss: 0.1675 - acc: 0.9617
1283/1283 [==============================] - 1s 774us/step - loss: 0.1672 - acc: 0.9618 - val_loss: 1.0334 - val_acc: 0.6026

Epoch 00019: val_acc did not improve
Epoch 20/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1887 - acc: 0.9375
 192/1283 [===>..........................] - ETA: 0s - loss: 0.1874 - acc: 0.9479
 320/1283 [======>.......................] - ETA: 0s - loss: 0.1751 - acc: 0.9594
 448/1283 [=========>....................] - ETA: 0s - loss: 0.1657 - acc: 0.9643
 576/1283 [============>.................] - ETA: 0s - loss: 0.1628 - acc: 0.9635
 704/1283 [===============>..............] - ETA: 0s - loss: 0.1654 - acc: 0.9616
 832/1283 [==================>...........] - ETA: 0s - loss: 0.1644 - acc: 0.9603
 896/1283 [===================>..........] - ETA: 0s - loss: 0.1625 - acc: 0.9598
1024/1283 [======================>.......] - ETA: 0s - loss: 0.1618 - acc: 0.9590
1088/1283 [========================>.....] - ETA: 0s - loss: 0.1605 - acc: 0.9596
1152/1283 [=========================>....] - ETA: 0s - loss: 0.1609 - acc: 0.9592
1280/1283 [============================>.] - ETA: 0s - loss: 0.1602 - acc: 0.9594
1283/1283 [==============================] - 1s 684us/step - loss: 0.1600 - acc: 0.9595 - val_loss: 1.0045 - val_acc: 0.5590

Epoch 00020: val_acc did not improve
Epoch 21/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1443 - acc: 0.9688
 192/1283 [===>..........................] - ETA: 0s - loss: 0.1533 - acc: 0.9583
 320/1283 [======>.......................] - ETA: 0s - loss: 0.1453 - acc: 0.9625
 448/1283 [=========>....................] - ETA: 0s - loss: 0.1416 - acc: 0.9665
 512/1283 [==========>...................] - ETA: 0s - loss: 0.1436 - acc: 0.9668
 640/1283 [=============>................] - ETA: 0s - loss: 0.1420 - acc: 0.9703
 768/1283 [================>.............] - ETA: 0s - loss: 0.1376 - acc: 0.9688
 896/1283 [===================>..........] - ETA: 0s - loss: 0.1375 - acc: 0.9676
1024/1283 [======================>.......] - ETA: 0s - loss: 0.1399 - acc: 0.9658
1216/1283 [===========================>..] - ETA: 0s - loss: 0.1420 - acc: 0.9671
1283/1283 [==============================] - 1s 714us/step - loss: 0.1435 - acc: 0.9665 - val_loss: 1.0553 - val_acc: 0.5590

Epoch 00021: val_acc did not improve
Epoch 00021: early stopping
batch_size=64
batch_norm=False
dropout_rate=0.1
n_layers=1
max_len=20
nodes=100
mode=A
PCA audio=30
PCA visual=10
PCA text=100
accuracy=0.5379008746355685
best_valid_accuracy=0.5102040816326531
/afs/inf.ed.ac.uk/user/s17/s1738075/.local/lib/python2.7/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
pca_early_fusion_cnn.py:146: RuntimeWarning: invalid value encountered in divide
  train_set_audio = train_set_audio / audio_max
pca_early_fusion_cnn.py:148: RuntimeWarning: invalid value encountered in divide
  test_set_audio = test_set_audio / audio_max
2018-03-28 21:55:00.262716: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
This API will be deprecated in the future versions. Please check the Github page for the current API

Modality facet for video 8qrpnFRGt2A segment 13 is (partially) missing and is thus being replaced by zeros!

Train on 1283 samples, validate on 229 samples
Epoch 1/100

  64/1283 [>.............................] - ETA: 11s - loss: 0.8257 - acc: 0.4219
 256/1283 [====>.........................] - ETA: 2s - loss: 0.8090 - acc: 0.4922 
 448/1283 [=========>....................] - ETA: 1s - loss: 0.7795 - acc: 0.5000
 640/1283 [=============>................] - ETA: 0s - loss: 0.7686 - acc: 0.5125
1024/1283 [======================>.......] - ETA: 0s - loss: 0.7398 - acc: 0.5371
1280/1283 [============================>.] - ETA: 0s - loss: 0.7337 - acc: 0.5383
1283/1283 [==============================] - 1s 825us/step - loss: 0.7338 - acc: 0.5378 - val_loss: 0.6830 - val_acc: 0.5721

Epoch 00001: val_acc improved from -inf to 0.57205, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20.ckpt
Epoch 2/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.6785 - acc: 0.5156
 320/1283 [======>.......................] - ETA: 0s - loss: 0.6626 - acc: 0.6000
 640/1283 [=============>................] - ETA: 0s - loss: 0.6582 - acc: 0.6031
 832/1283 [==================>...........] - ETA: 0s - loss: 0.6521 - acc: 0.6166
1024/1283 [======================>.......] - ETA: 0s - loss: 0.6577 - acc: 0.6113
1216/1283 [===========================>..] - ETA: 0s - loss: 0.6545 - acc: 0.6151
1283/1283 [==============================] - 0s 255us/step - loss: 0.6529 - acc: 0.6212 - val_loss: 0.6873 - val_acc: 0.5459

Epoch 00002: val_acc did not improve
Epoch 3/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.6252 - acc: 0.6406
 256/1283 [====>.........................] - ETA: 0s - loss: 0.6214 - acc: 0.6641
 320/1283 [======>.......................] - ETA: 0s - loss: 0.6232 - acc: 0.6594
 512/1283 [==========>...................] - ETA: 0s - loss: 0.6116 - acc: 0.6758
 768/1283 [================>.............] - ETA: 0s - loss: 0.6044 - acc: 0.6888
 832/1283 [==================>...........] - ETA: 0s - loss: 0.6055 - acc: 0.6935
1088/1283 [========================>.....] - ETA: 0s - loss: 0.6178 - acc: 0.6691
1280/1283 [============================>.] - ETA: 0s - loss: 0.6210 - acc: 0.6617
1283/1283 [==============================] - 2s 2ms/step - loss: 0.6205 - acc: 0.6625 - val_loss: 0.7184 - val_acc: 0.5590

Epoch 00003: val_acc did not improve
Epoch 4/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.6427 - acc: 0.5781
 192/1283 [===>..........................] - ETA: 0s - loss: 0.5880 - acc: 0.6719
 256/1283 [====>.........................] - ETA: 1s - loss: 0.5810 - acc: 0.6758
 320/1283 [======>.......................] - ETA: 2s - loss: 0.5727 - acc: 0.6875
 384/1283 [=======>......................] - ETA: 1s - loss: 0.5874 - acc: 0.6771
 512/1283 [==========>...................] - ETA: 1s - loss: 0.5908 - acc: 0.6836
 640/1283 [=============>................] - ETA: 1s - loss: 0.5854 - acc: 0.6859
 704/1283 [===============>..............] - ETA: 0s - loss: 0.5842 - acc: 0.6889
 960/1283 [=====================>........] - ETA: 0s - loss: 0.5848 - acc: 0.6854
1152/1283 [=========================>....] - ETA: 0s - loss: 0.5769 - acc: 0.6979
1283/1283 [==============================] - 2s 1ms/step - loss: 0.5835 - acc: 0.6906 - val_loss: 0.6948 - val_acc: 0.5721

Epoch 00004: val_acc did not improve
Epoch 5/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5446 - acc: 0.7188
 256/1283 [====>.........................] - ETA: 0s - loss: 0.5688 - acc: 0.6797
 512/1283 [==========>...................] - ETA: 0s - loss: 0.5571 - acc: 0.7109
 640/1283 [=============>................] - ETA: 0s - loss: 0.5595 - acc: 0.7203
 768/1283 [================>.............] - ETA: 0s - loss: 0.5624 - acc: 0.7174
 832/1283 [==================>...........] - ETA: 0s - loss: 0.5612 - acc: 0.7212
 896/1283 [===================>..........] - ETA: 0s - loss: 0.5609 - acc: 0.7188
1088/1283 [========================>.....] - ETA: 0s - loss: 0.5569 - acc: 0.7279
1216/1283 [===========================>..] - ETA: 0s - loss: 0.5559 - acc: 0.7303
1283/1283 [==============================] - 2s 1ms/step - loss: 0.5530 - acc: 0.7334 - val_loss: 0.7197 - val_acc: 0.5764

Epoch 00005: val_acc improved from 0.57205 to 0.57642, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20.ckpt
Epoch 6/100

  64/1283 [>.............................] - ETA: 1s - loss: 0.5284 - acc: 0.7188
 128/1283 [=>............................] - ETA: 2s - loss: 0.5353 - acc: 0.6953
 320/1283 [======>.......................] - ETA: 1s - loss: 0.5440 - acc: 0.6969
 384/1283 [=======>......................] - ETA: 2s - loss: 0.5363 - acc: 0.7135
 576/1283 [============>.................] - ETA: 1s - loss: 0.5238 - acc: 0.7326
 640/1283 [=============>................] - ETA: 1s - loss: 0.5282 - acc: 0.7297
 704/1283 [===============>..............] - ETA: 0s - loss: 0.5281 - acc: 0.7287
 960/1283 [=====================>........] - ETA: 0s - loss: 0.5221 - acc: 0.7479
1152/1283 [=========================>....] - ETA: 0s - loss: 0.5194 - acc: 0.7457
1280/1283 [============================>.] - ETA: 0s - loss: 0.5164 - acc: 0.7500
1283/1283 [==============================] - 1s 1ms/step - loss: 0.5170 - acc: 0.7498 - val_loss: 0.7470 - val_acc: 0.5983

Epoch 00006: val_acc improved from 0.57642 to 0.59825, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20.ckpt
Epoch 7/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5216 - acc: 0.7344
 256/1283 [====>.........................] - ETA: 0s - loss: 0.5163 - acc: 0.7227
 512/1283 [==========>...................] - ETA: 0s - loss: 0.5025 - acc: 0.7363
 768/1283 [================>.............] - ETA: 0s - loss: 0.4902 - acc: 0.7604
1088/1283 [========================>.....] - ETA: 0s - loss: 0.4895 - acc: 0.7574
1283/1283 [==============================] - 0s 258us/step - loss: 0.4886 - acc: 0.7631 - val_loss: 0.7242 - val_acc: 0.6026

Epoch 00007: val_acc improved from 0.59825 to 0.60262, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20.ckpt
Epoch 8/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.4539 - acc: 0.8281
 128/1283 [=>............................] - ETA: 0s - loss: 0.4809 - acc: 0.8047
 192/1283 [===>..........................] - ETA: 1s - loss: 0.4692 - acc: 0.8021
 320/1283 [======>.......................] - ETA: 0s - loss: 0.4544 - acc: 0.8187
 448/1283 [=========>....................] - ETA: 0s - loss: 0.4528 - acc: 0.8304
 576/1283 [============>.................] - ETA: 0s - loss: 0.4604 - acc: 0.8160
 768/1283 [================>.............] - ETA: 0s - loss: 0.4468 - acc: 0.8190
 960/1283 [=====================>........] - ETA: 0s - loss: 0.4425 - acc: 0.8156
1152/1283 [=========================>....] - ETA: 0s - loss: 0.4433 - acc: 0.8186
1216/1283 [===========================>..] - ETA: 0s - loss: 0.4426 - acc: 0.8183
1283/1283 [==============================] - 1s 700us/step - loss: 0.4449 - acc: 0.8176 - val_loss: 0.7252 - val_acc: 0.6070

Epoch 00008: val_acc improved from 0.60262 to 0.60699, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20.ckpt
Epoch 9/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.3658 - acc: 0.9219
 192/1283 [===>..........................] - ETA: 2s - loss: 0.4201 - acc: 0.8177
 448/1283 [=========>....................] - ETA: 0s - loss: 0.4195 - acc: 0.8214
 640/1283 [=============>................] - ETA: 0s - loss: 0.4216 - acc: 0.8219
 768/1283 [================>.............] - ETA: 0s - loss: 0.4246 - acc: 0.8164
 896/1283 [===================>..........] - ETA: 0s - loss: 0.4215 - acc: 0.8192
1024/1283 [======================>.......] - ETA: 0s - loss: 0.4197 - acc: 0.8223
1216/1283 [===========================>..] - ETA: 0s - loss: 0.4173 - acc: 0.8224
1280/1283 [============================>.] - ETA: 0s - loss: 0.4152 - acc: 0.8234
1283/1283 [==============================] - 2s 2ms/step - loss: 0.4163 - acc: 0.8215 - val_loss: 0.7781 - val_acc: 0.5502

Epoch 00009: val_acc did not improve
Epoch 10/100

  64/1283 [>.............................] - ETA: 8s - loss: 0.3782 - acc: 0.8906
 128/1283 [=>............................] - ETA: 6s - loss: 0.3735 - acc: 0.8516
 192/1283 [===>..........................] - ETA: 6s - loss: 0.3854 - acc: 0.8385
 448/1283 [=========>....................] - ETA: 2s - loss: 0.3922 - acc: 0.8371
 512/1283 [==========>...................] - ETA: 2s - loss: 0.3862 - acc: 0.8418
 832/1283 [==================>...........] - ETA: 0s - loss: 0.3929 - acc: 0.8389
1024/1283 [======================>.......] - ETA: 0s - loss: 0.4055 - acc: 0.8193
1216/1283 [===========================>..] - ETA: 0s - loss: 0.3993 - acc: 0.8240
1283/1283 [==============================] - 2s 1ms/step - loss: 0.3976 - acc: 0.8277 - val_loss: 0.7608 - val_acc: 0.5983

Epoch 00010: val_acc did not improve
Epoch 11/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.3188 - acc: 0.9219
 256/1283 [====>.........................] - ETA: 0s - loss: 0.3281 - acc: 0.8945
 576/1283 [============>.................] - ETA: 0s - loss: 0.3388 - acc: 0.8889
 640/1283 [=============>................] - ETA: 0s - loss: 0.3380 - acc: 0.8906
 768/1283 [================>.............] - ETA: 0s - loss: 0.3364 - acc: 0.8919
 832/1283 [==================>...........] - ETA: 0s - loss: 0.3370 - acc: 0.8906
 896/1283 [===================>..........] - ETA: 0s - loss: 0.3388 - acc: 0.8895
1088/1283 [========================>.....] - ETA: 0s - loss: 0.3355 - acc: 0.8934
1283/1283 [==============================] - 2s 1ms/step - loss: 0.3369 - acc: 0.8870 - val_loss: 0.8011 - val_acc: 0.5808

Epoch 00011: val_acc did not improve
Epoch 12/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.3485 - acc: 0.8906
 256/1283 [====>.........................] - ETA: 0s - loss: 0.3114 - acc: 0.9023
 512/1283 [==========>...................] - ETA: 0s - loss: 0.3213 - acc: 0.8789
 768/1283 [================>.............] - ETA: 0s - loss: 0.3084 - acc: 0.8919
1024/1283 [======================>.......] - ETA: 0s - loss: 0.3004 - acc: 0.9014
1216/1283 [===========================>..] - ETA: 0s - loss: 0.2969 - acc: 0.9030
1283/1283 [==============================] - 1s 697us/step - loss: 0.2971 - acc: 0.9026 - val_loss: 0.8581 - val_acc: 0.5939

Epoch 00012: val_acc did not improve
Epoch 13/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.3367 - acc: 0.8438
 320/1283 [======>.......................] - ETA: 0s - loss: 0.3004 - acc: 0.8719
 448/1283 [=========>....................] - ETA: 0s - loss: 0.3002 - acc: 0.8750
 512/1283 [==========>...................] - ETA: 0s - loss: 0.3034 - acc: 0.8789
 576/1283 [============>.................] - ETA: 1s - loss: 0.2957 - acc: 0.8872
 768/1283 [================>.............] - ETA: 0s - loss: 0.2904 - acc: 0.8932
 832/1283 [==================>...........] - ETA: 0s - loss: 0.2908 - acc: 0.8930
1024/1283 [======================>.......] - ETA: 0s - loss: 0.2903 - acc: 0.8926
1088/1283 [========================>.....] - ETA: 0s - loss: 0.2898 - acc: 0.8943
1152/1283 [=========================>....] - ETA: 0s - loss: 0.2864 - acc: 0.8976
1216/1283 [===========================>..] - ETA: 0s - loss: 0.2849 - acc: 0.8980
1280/1283 [============================>.] - ETA: 0s - loss: 0.2843 - acc: 0.8977
1283/1283 [==============================] - 2s 2ms/step - loss: 0.2844 - acc: 0.8971 - val_loss: 0.8296 - val_acc: 0.5852

Epoch 00013: val_acc did not improve
Epoch 14/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.2281 - acc: 0.9375
 320/1283 [======>.......................] - ETA: 0s - loss: 0.2388 - acc: 0.9469
 576/1283 [============>.................] - ETA: 0s - loss: 0.2288 - acc: 0.9444
 768/1283 [================>.............] - ETA: 0s - loss: 0.2335 - acc: 0.9388
 960/1283 [=====================>........] - ETA: 0s - loss: 0.2379 - acc: 0.9333
1088/1283 [========================>.....] - ETA: 0s - loss: 0.2385 - acc: 0.9311
1216/1283 [===========================>..] - ETA: 0s - loss: 0.2424 - acc: 0.9285
1283/1283 [==============================] - 1s 466us/step - loss: 0.2441 - acc: 0.9275 - val_loss: 0.9030 - val_acc: 0.5502

Epoch 00014: val_acc did not improve
Epoch 15/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1816 - acc: 0.9531
 256/1283 [====>.........................] - ETA: 0s - loss: 0.2237 - acc: 0.9453
 448/1283 [=========>....................] - ETA: 0s - loss: 0.2272 - acc: 0.9330
 640/1283 [=============>................] - ETA: 0s - loss: 0.2403 - acc: 0.9109
 768/1283 [================>.............] - ETA: 0s - loss: 0.2411 - acc: 0.9115
1024/1283 [======================>.......] - ETA: 0s - loss: 0.2558 - acc: 0.9043
1216/1283 [===========================>..] - ETA: 0s - loss: 0.2540 - acc: 0.9095
1283/1283 [==============================] - 1s 403us/step - loss: 0.2537 - acc: 0.9119 - val_loss: 0.9810 - val_acc: 0.5983

Epoch 00015: val_acc did not improve
Epoch 16/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1798 - acc: 0.9219
 192/1283 [===>..........................] - ETA: 0s - loss: 0.2126 - acc: 0.9219
 256/1283 [====>.........................] - ETA: 1s - loss: 0.2101 - acc: 0.9258
 448/1283 [=========>....................] - ETA: 0s - loss: 0.2060 - acc: 0.9375
 640/1283 [=============>................] - ETA: 0s - loss: 0.2084 - acc: 0.9359
 832/1283 [==================>...........] - ETA: 0s - loss: 0.2157 - acc: 0.9291
1088/1283 [========================>.....] - ETA: 0s - loss: 0.2052 - acc: 0.9375
1280/1283 [============================>.] - ETA: 0s - loss: 0.2004 - acc: 0.9383
1283/1283 [==============================] - 1s 583us/step - loss: 0.2002 - acc: 0.9384 - val_loss: 1.0350 - val_acc: 0.5284

Epoch 00016: val_acc did not improve
Epoch 17/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.2105 - acc: 0.9375
 320/1283 [======>.......................] - ETA: 0s - loss: 0.1875 - acc: 0.9406
 512/1283 [==========>...................] - ETA: 0s - loss: 0.1712 - acc: 0.9531
 704/1283 [===============>..............] - ETA: 0s - loss: 0.1731 - acc: 0.9545
 832/1283 [==================>...........] - ETA: 0s - loss: 0.1687 - acc: 0.9567
 960/1283 [=====================>........] - ETA: 0s - loss: 0.1683 - acc: 0.9594
1152/1283 [=========================>....] - ETA: 0s - loss: 0.1641 - acc: 0.9618
1216/1283 [===========================>..] - ETA: 0s - loss: 0.1643 - acc: 0.9613
1283/1283 [==============================] - 1s 929us/step - loss: 0.1618 - acc: 0.9618 - val_loss: 1.0639 - val_acc: 0.5459

Epoch 00017: val_acc did not improve
Epoch 18/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1163 - acc: 1.0000
 256/1283 [====>.........................] - ETA: 0s - loss: 0.1846 - acc: 0.9453
 384/1283 [=======>......................] - ETA: 0s - loss: 0.2158 - acc: 0.9245
 448/1283 [=========>....................] - ETA: 1s - loss: 0.2057 - acc: 0.9353
 512/1283 [==========>...................] - ETA: 2s - loss: 0.1986 - acc: 0.9395
 576/1283 [============>.................] - ETA: 1s - loss: 0.1993 - acc: 0.9358
 768/1283 [================>.............] - ETA: 1s - loss: 0.2019 - acc: 0.9323
1024/1283 [======================>.......] - ETA: 0s - loss: 0.1909 - acc: 0.9404
1152/1283 [=========================>....] - ETA: 0s - loss: 0.1955 - acc: 0.9375
1280/1283 [============================>.] - ETA: 0s - loss: 0.1920 - acc: 0.9398
1283/1283 [==============================] - 2s 2ms/step - loss: 0.1919 - acc: 0.9400 - val_loss: 1.0647 - val_acc: 0.5721

Epoch 00018: val_acc did not improve
Epoch 00018: early stopping
batch_size=64
batch_norm=False
dropout_rate=0.1
n_layers=1
max_len=20
nodes=100
mode=A
PCA audio=30
PCA visual=15
PCA text=100
accuracy=0.5116618075801749
best_valid_accuracy=0.543731778425656
/afs/inf.ed.ac.uk/user/s17/s1738075/.local/lib/python2.7/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
pca_early_fusion_cnn.py:146: RuntimeWarning: invalid value encountered in divide
  train_set_audio = train_set_audio / audio_max
pca_early_fusion_cnn.py:148: RuntimeWarning: invalid value encountered in divide
  test_set_audio = test_set_audio / audio_max
2018-03-28 22:09:13.635385: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
This API will be deprecated in the future versions. Please check the Github page for the current API

Modality facet for video 8qrpnFRGt2A segment 13 is (partially) missing and is thus being replaced by zeros!

Train on 1283 samples, validate on 229 samples
Epoch 1/100

  64/1283 [>.............................] - ETA: 8s - loss: 0.7398 - acc: 0.4531
 128/1283 [=>............................] - ETA: 4s - loss: 0.7171 - acc: 0.5156
 192/1283 [===>..........................] - ETA: 3s - loss: 0.7385 - acc: 0.5156
 256/1283 [====>.........................] - ETA: 2s - loss: 0.7320 - acc: 0.5234
 384/1283 [=======>......................] - ETA: 1s - loss: 0.7312 - acc: 0.5339
 512/1283 [==========>...................] - ETA: 1s - loss: 0.7195 - acc: 0.5410
 640/1283 [=============>................] - ETA: 0s - loss: 0.7348 - acc: 0.5219
 768/1283 [================>.............] - ETA: 0s - loss: 0.7262 - acc: 0.5273
 896/1283 [===================>..........] - ETA: 0s - loss: 0.7186 - acc: 0.5458
 960/1283 [=====================>........] - ETA: 0s - loss: 0.7179 - acc: 0.5490
1024/1283 [======================>.......] - ETA: 0s - loss: 0.7232 - acc: 0.5469
1152/1283 [=========================>....] - ETA: 0s - loss: 0.7218 - acc: 0.5486
1280/1283 [============================>.] - ETA: 0s - loss: 0.7192 - acc: 0.5500
1283/1283 [==============================] - 1s 1ms/step - loss: 0.7189 - acc: 0.5503 - val_loss: 0.7053 - val_acc: 0.5590

Epoch 00001: val_acc improved from -inf to 0.55895, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20.ckpt
Epoch 2/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.6255 - acc: 0.6094
 192/1283 [===>..........................] - ETA: 0s - loss: 0.6395 - acc: 0.6042
 384/1283 [=======>......................] - ETA: 0s - loss: 0.6403 - acc: 0.5964
 512/1283 [==========>...................] - ETA: 0s - loss: 0.6346 - acc: 0.6055
 640/1283 [=============>................] - ETA: 0s - loss: 0.6317 - acc: 0.6188
 768/1283 [================>.............] - ETA: 0s - loss: 0.6356 - acc: 0.6133
 896/1283 [===================>..........] - ETA: 0s - loss: 0.6326 - acc: 0.6261
1024/1283 [======================>.......] - ETA: 0s - loss: 0.6314 - acc: 0.6279
1152/1283 [=========================>....] - ETA: 0s - loss: 0.6288 - acc: 0.6363
1280/1283 [============================>.] - ETA: 0s - loss: 0.6293 - acc: 0.6414
1283/1283 [==============================] - 1s 686us/step - loss: 0.6293 - acc: 0.6415 - val_loss: 0.7048 - val_acc: 0.5328

Epoch 00002: val_acc did not improve
Epoch 3/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5374 - acc: 0.7500
 256/1283 [====>.........................] - ETA: 0s - loss: 0.5442 - acc: 0.7656
 384/1283 [=======>......................] - ETA: 0s - loss: 0.5431 - acc: 0.7526
 448/1283 [=========>....................] - ETA: 0s - loss: 0.5478 - acc: 0.7388
 576/1283 [============>.................] - ETA: 0s - loss: 0.5498 - acc: 0.7378
 704/1283 [===============>..............] - ETA: 0s - loss: 0.5556 - acc: 0.7330
 832/1283 [==================>...........] - ETA: 0s - loss: 0.5588 - acc: 0.7248
 896/1283 [===================>..........] - ETA: 0s - loss: 0.5635 - acc: 0.7188
 960/1283 [=====================>........] - ETA: 0s - loss: 0.5618 - acc: 0.7208
1088/1283 [========================>.....] - ETA: 0s - loss: 0.5626 - acc: 0.7215
1216/1283 [===========================>..] - ETA: 0s - loss: 0.5698 - acc: 0.7138
1283/1283 [==============================] - 1s 678us/step - loss: 0.5693 - acc: 0.7147 - val_loss: 0.7215 - val_acc: 0.5633

Epoch 00003: val_acc improved from 0.55895 to 0.56332, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20.ckpt
Epoch 4/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.6000 - acc: 0.6562
 192/1283 [===>..........................] - ETA: 0s - loss: 0.5459 - acc: 0.7135
 256/1283 [====>.........................] - ETA: 0s - loss: 0.5489 - acc: 0.7148
 384/1283 [=======>......................] - ETA: 0s - loss: 0.5423 - acc: 0.7214
 448/1283 [=========>....................] - ETA: 0s - loss: 0.5337 - acc: 0.7366
 512/1283 [==========>...................] - ETA: 0s - loss: 0.5329 - acc: 0.7422
 576/1283 [============>.................] - ETA: 0s - loss: 0.5305 - acc: 0.7448
 768/1283 [================>.............] - ETA: 0s - loss: 0.5286 - acc: 0.7487
 960/1283 [=====================>........] - ETA: 0s - loss: 0.5230 - acc: 0.7531
1152/1283 [=========================>....] - ETA: 0s - loss: 0.5251 - acc: 0.7500
1280/1283 [============================>.] - ETA: 0s - loss: 0.5222 - acc: 0.7562
1283/1283 [==============================] - 1s 730us/step - loss: 0.5224 - acc: 0.7560 - val_loss: 0.7278 - val_acc: 0.5197

Epoch 00004: val_acc did not improve
Epoch 5/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.4289 - acc: 0.8594
 192/1283 [===>..........................] - ETA: 0s - loss: 0.4604 - acc: 0.8125
 320/1283 [======>.......................] - ETA: 0s - loss: 0.4653 - acc: 0.7969
 448/1283 [=========>....................] - ETA: 0s - loss: 0.4662 - acc: 0.7991
 640/1283 [=============>................] - ETA: 0s - loss: 0.4802 - acc: 0.7781
 768/1283 [================>.............] - ETA: 0s - loss: 0.4812 - acc: 0.7708
 832/1283 [==================>...........] - ETA: 0s - loss: 0.4765 - acc: 0.7752
 960/1283 [=====================>........] - ETA: 0s - loss: 0.4760 - acc: 0.7740
1088/1283 [========================>.....] - ETA: 0s - loss: 0.4711 - acc: 0.7822
1216/1283 [===========================>..] - ETA: 0s - loss: 0.4722 - acc: 0.7812
1283/1283 [==============================] - 1s 937us/step - loss: 0.4741 - acc: 0.7794 - val_loss: 0.7595 - val_acc: 0.5939

Epoch 00005: val_acc improved from 0.56332 to 0.59389, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20.ckpt
Epoch 6/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.4840 - acc: 0.7500
 128/1283 [=>............................] - ETA: 0s - loss: 0.4283 - acc: 0.8047
 256/1283 [====>.........................] - ETA: 0s - loss: 0.4407 - acc: 0.7969
 320/1283 [======>.......................] - ETA: 0s - loss: 0.4268 - acc: 0.8219
 448/1283 [=========>....................] - ETA: 0s - loss: 0.4280 - acc: 0.8214
 576/1283 [============>.................] - ETA: 0s - loss: 0.4286 - acc: 0.8177
 704/1283 [===============>..............] - ETA: 0s - loss: 0.4379 - acc: 0.8082
 832/1283 [==================>...........] - ETA: 0s - loss: 0.4364 - acc: 0.8113
 960/1283 [=====================>........] - ETA: 0s - loss: 0.4318 - acc: 0.8167
1088/1283 [========================>.....] - ETA: 0s - loss: 0.4293 - acc: 0.8217
1216/1283 [===========================>..] - ETA: 0s - loss: 0.4272 - acc: 0.8224
1283/1283 [==============================] - 1s 643us/step - loss: 0.4258 - acc: 0.8239 - val_loss: 0.7463 - val_acc: 0.5590

Epoch 00006: val_acc did not improve
Epoch 7/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.3549 - acc: 0.8906
 128/1283 [=>............................] - ETA: 1s - loss: 0.3427 - acc: 0.8828
 256/1283 [====>.........................] - ETA: 0s - loss: 0.3872 - acc: 0.8320
 384/1283 [=======>......................] - ETA: 0s - loss: 0.3887 - acc: 0.8359
 512/1283 [==========>...................] - ETA: 0s - loss: 0.3936 - acc: 0.8320
 640/1283 [=============>................] - ETA: 0s - loss: 0.3968 - acc: 0.8313
 768/1283 [================>.............] - ETA: 0s - loss: 0.3897 - acc: 0.8385
 896/1283 [===================>..........] - ETA: 0s - loss: 0.3816 - acc: 0.8460
1024/1283 [======================>.......] - ETA: 0s - loss: 0.3793 - acc: 0.8467
1088/1283 [========================>.....] - ETA: 0s - loss: 0.3752 - acc: 0.8502
1152/1283 [=========================>....] - ETA: 0s - loss: 0.3756 - acc: 0.8516
1216/1283 [===========================>..] - ETA: 0s - loss: 0.3758 - acc: 0.8495
1283/1283 [==============================] - 1s 800us/step - loss: 0.3760 - acc: 0.8496 - val_loss: 0.7859 - val_acc: 0.5546

Epoch 00007: val_acc did not improve
Epoch 8/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.2963 - acc: 0.8906
 192/1283 [===>..........................] - ETA: 0s - loss: 0.3138 - acc: 0.8802
 320/1283 [======>.......................] - ETA: 0s - loss: 0.3162 - acc: 0.8844
 448/1283 [=========>....................] - ETA: 0s - loss: 0.3261 - acc: 0.8705
 512/1283 [==========>...................] - ETA: 0s - loss: 0.3275 - acc: 0.8711
 640/1283 [=============>................] - ETA: 0s - loss: 0.3321 - acc: 0.8719
 704/1283 [===============>..............] - ETA: 0s - loss: 0.3361 - acc: 0.8665
 768/1283 [================>.............] - ETA: 0s - loss: 0.3365 - acc: 0.8672
 832/1283 [==================>...........] - ETA: 0s - loss: 0.3342 - acc: 0.8690
 960/1283 [=====================>........] - ETA: 0s - loss: 0.3360 - acc: 0.8688
1088/1283 [========================>.....] - ETA: 0s - loss: 0.3306 - acc: 0.8741
1216/1283 [===========================>..] - ETA: 0s - loss: 0.3325 - acc: 0.8692
1283/1283 [==============================] - 1s 799us/step - loss: 0.3319 - acc: 0.8706 - val_loss: 0.7842 - val_acc: 0.5852

Epoch 00008: val_acc did not improve
Epoch 9/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.3359 - acc: 0.8594
 192/1283 [===>..........................] - ETA: 0s - loss: 0.2797 - acc: 0.9219
 320/1283 [======>.......................] - ETA: 0s - loss: 0.2720 - acc: 0.9281
 384/1283 [=======>......................] - ETA: 0s - loss: 0.2775 - acc: 0.9219
 512/1283 [==========>...................] - ETA: 0s - loss: 0.2748 - acc: 0.9160
 640/1283 [=============>................] - ETA: 0s - loss: 0.2715 - acc: 0.9172
 768/1283 [================>.............] - ETA: 0s - loss: 0.2688 - acc: 0.9206
 832/1283 [==================>...........] - ETA: 0s - loss: 0.2680 - acc: 0.9207
 896/1283 [===================>..........] - ETA: 0s - loss: 0.2695 - acc: 0.9185
 960/1283 [=====================>........] - ETA: 0s - loss: 0.2701 - acc: 0.9146
1024/1283 [======================>.......] - ETA: 0s - loss: 0.2725 - acc: 0.9092
1088/1283 [========================>.....] - ETA: 0s - loss: 0.2724 - acc: 0.9118
1216/1283 [===========================>..] - ETA: 0s - loss: 0.2726 - acc: 0.9137
1283/1283 [==============================] - 1s 992us/step - loss: 0.2746 - acc: 0.9119 - val_loss: 0.8490 - val_acc: 0.5721

Epoch 00009: val_acc did not improve
Epoch 10/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.2475 - acc: 0.9531
 192/1283 [===>..........................] - ETA: 0s - loss: 0.2675 - acc: 0.9219
 320/1283 [======>.......................] - ETA: 0s - loss: 0.2593 - acc: 0.9187
 384/1283 [=======>......................] - ETA: 0s - loss: 0.2719 - acc: 0.9062
 448/1283 [=========>....................] - ETA: 0s - loss: 0.2801 - acc: 0.8996
 576/1283 [============>.................] - ETA: 0s - loss: 0.2749 - acc: 0.9028
 704/1283 [===============>..............] - ETA: 0s - loss: 0.2704 - acc: 0.9105
 832/1283 [==================>...........] - ETA: 0s - loss: 0.2721 - acc: 0.9099
 960/1283 [=====================>........] - ETA: 0s - loss: 0.2740 - acc: 0.9062
1024/1283 [======================>.......] - ETA: 0s - loss: 0.2734 - acc: 0.9072
1088/1283 [========================>.....] - ETA: 0s - loss: 0.2720 - acc: 0.9081
1152/1283 [=========================>....] - ETA: 0s - loss: 0.2710 - acc: 0.9080
1280/1283 [============================>.] - ETA: 0s - loss: 0.2675 - acc: 0.9125
1283/1283 [==============================] - 1s 825us/step - loss: 0.2677 - acc: 0.9127 - val_loss: 0.8826 - val_acc: 0.5677

Epoch 00010: val_acc did not improve
Epoch 11/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.2438 - acc: 0.9531
 256/1283 [====>.........................] - ETA: 0s - loss: 0.2601 - acc: 0.9375
 448/1283 [=========>....................] - ETA: 0s - loss: 0.2513 - acc: 0.9286
 640/1283 [=============>................] - ETA: 0s - loss: 0.2512 - acc: 0.9187
 832/1283 [==================>...........] - ETA: 0s - loss: 0.2580 - acc: 0.9099
 960/1283 [=====================>........] - ETA: 0s - loss: 0.2635 - acc: 0.9062
1024/1283 [======================>.......] - ETA: 0s - loss: 0.2622 - acc: 0.9053
1088/1283 [========================>.....] - ETA: 0s - loss: 0.2598 - acc: 0.9072
1152/1283 [=========================>....] - ETA: 0s - loss: 0.2606 - acc: 0.9045
1280/1283 [============================>.] - ETA: 0s - loss: 0.2572 - acc: 0.9047
1283/1283 [==============================] - 1s 549us/step - loss: 0.2573 - acc: 0.9049 - val_loss: 0.8679 - val_acc: 0.5546

Epoch 00011: val_acc did not improve
Epoch 12/100

  64/1283 [>.............................] - ETA: 1s - loss: 0.2120 - acc: 0.9531
 192/1283 [===>..........................] - ETA: 0s - loss: 0.2058 - acc: 0.9531
 320/1283 [======>.......................] - ETA: 0s - loss: 0.2003 - acc: 0.9500
 448/1283 [=========>....................] - ETA: 0s - loss: 0.1946 - acc: 0.9531
 576/1283 [============>.................] - ETA: 0s - loss: 0.1951 - acc: 0.9514
 704/1283 [===============>..............] - ETA: 0s - loss: 0.1974 - acc: 0.9474
 832/1283 [==================>...........] - ETA: 0s - loss: 0.1959 - acc: 0.9435
1024/1283 [======================>.......] - ETA: 0s - loss: 0.1920 - acc: 0.9492
1088/1283 [========================>.....] - ETA: 0s - loss: 0.1932 - acc: 0.9485
1216/1283 [===========================>..] - ETA: 0s - loss: 0.1919 - acc: 0.9498
1283/1283 [==============================] - 1s 642us/step - loss: 0.1911 - acc: 0.9501 - val_loss: 1.0001 - val_acc: 0.6026

Epoch 00012: val_acc improved from 0.59389 to 0.60262, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20.ckpt
Epoch 13/100

  64/1283 [>.............................] - ETA: 5s - loss: 0.1543 - acc: 0.9844
 128/1283 [=>............................] - ETA: 2s - loss: 0.1416 - acc: 0.9922
 192/1283 [===>..........................] - ETA: 2s - loss: 0.1480 - acc: 0.9844
 320/1283 [======>.......................] - ETA: 1s - loss: 0.1575 - acc: 0.9625
 384/1283 [=======>......................] - ETA: 1s - loss: 0.1666 - acc: 0.9583
 512/1283 [==========>...................] - ETA: 0s - loss: 0.1645 - acc: 0.9570
 704/1283 [===============>..............] - ETA: 0s - loss: 0.1698 - acc: 0.9574
 832/1283 [==================>...........] - ETA: 0s - loss: 0.1661 - acc: 0.9603
1024/1283 [======================>.......] - ETA: 0s - loss: 0.1652 - acc: 0.9600
1152/1283 [=========================>....] - ETA: 0s - loss: 0.1633 - acc: 0.9592
1283/1283 [==============================] - 1s 783us/step - loss: 0.1614 - acc: 0.9610 - val_loss: 0.9423 - val_acc: 0.5677

Epoch 00013: val_acc did not improve
Epoch 14/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1235 - acc: 0.9688
 256/1283 [====>.........................] - ETA: 0s - loss: 0.1245 - acc: 0.9844
 448/1283 [=========>....................] - ETA: 0s - loss: 0.1350 - acc: 0.9710
 512/1283 [==========>...................] - ETA: 0s - loss: 0.1309 - acc: 0.9727
 576/1283 [============>.................] - ETA: 0s - loss: 0.1307 - acc: 0.9740
 704/1283 [===============>..............] - ETA: 0s - loss: 0.1278 - acc: 0.9773
 896/1283 [===================>..........] - ETA: 0s - loss: 0.1272 - acc: 0.9777
1024/1283 [======================>.......] - ETA: 0s - loss: 0.1286 - acc: 0.9785
1088/1283 [========================>.....] - ETA: 0s - loss: 0.1298 - acc: 0.9789
1216/1283 [===========================>..] - ETA: 0s - loss: 0.1301 - acc: 0.9762
1283/1283 [==============================] - 1s 620us/step - loss: 0.1287 - acc: 0.9766 - val_loss: 0.9823 - val_acc: 0.5939

Epoch 00014: val_acc did not improve
Epoch 15/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0991 - acc: 0.9844
 192/1283 [===>..........................] - ETA: 0s - loss: 0.0991 - acc: 0.9896
 448/1283 [=========>....................] - ETA: 0s - loss: 0.1068 - acc: 0.9888
 640/1283 [=============>................] - ETA: 0s - loss: 0.1093 - acc: 0.9875
 832/1283 [==================>...........] - ETA: 0s - loss: 0.1056 - acc: 0.9868
 960/1283 [=====================>........] - ETA: 0s - loss: 0.1076 - acc: 0.9854
1088/1283 [========================>.....] - ETA: 0s - loss: 0.1100 - acc: 0.9825
1216/1283 [===========================>..] - ETA: 0s - loss: 0.1074 - acc: 0.9819
1283/1283 [==============================] - 1s 609us/step - loss: 0.1064 - acc: 0.9821 - val_loss: 1.0676 - val_acc: 0.5721

Epoch 00015: val_acc did not improve
Epoch 16/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1146 - acc: 0.9688
 192/1283 [===>..........................] - ETA: 0s - loss: 0.1018 - acc: 0.9792
 256/1283 [====>.........................] - ETA: 1s - loss: 0.0955 - acc: 0.9805
 384/1283 [=======>......................] - ETA: 1s - loss: 0.0922 - acc: 0.9870
 512/1283 [==========>...................] - ETA: 0s - loss: 0.0934 - acc: 0.9863
 640/1283 [=============>................] - ETA: 0s - loss: 0.0935 - acc: 0.9891
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0925 - acc: 0.9880
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0919 - acc: 0.9883
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0926 - acc: 0.9868
1283/1283 [==============================] - 1s 645us/step - loss: 0.0917 - acc: 0.9875 - val_loss: 1.0654 - val_acc: 0.5590

Epoch 00016: val_acc did not improve
Epoch 17/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0917 - acc: 0.9844
 192/1283 [===>..........................] - ETA: 0s - loss: 0.0660 - acc: 0.9948
 320/1283 [======>.......................] - ETA: 0s - loss: 0.0673 - acc: 0.9938
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0718 - acc: 0.9933
 576/1283 [============>.................] - ETA: 0s - loss: 0.0750 - acc: 0.9931
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0749 - acc: 0.9901
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0753 - acc: 0.9904
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0751 - acc: 0.9917
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0741 - acc: 0.9926
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0746 - acc: 0.9901
1283/1283 [==============================] - 1s 598us/step - loss: 0.0746 - acc: 0.9899 - val_loss: 1.1412 - val_acc: 0.5895

Epoch 00017: val_acc did not improve
Epoch 18/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0675 - acc: 0.9688
 128/1283 [=>............................] - ETA: 1s - loss: 0.0619 - acc: 0.9844
 256/1283 [====>.........................] - ETA: 0s - loss: 0.0707 - acc: 0.9805
 384/1283 [=======>......................] - ETA: 0s - loss: 0.0655 - acc: 0.9844
 512/1283 [==========>...................] - ETA: 0s - loss: 0.0658 - acc: 0.9844
 640/1283 [=============>................] - ETA: 0s - loss: 0.0658 - acc: 0.9859
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0645 - acc: 0.9858
 768/1283 [================>.............] - ETA: 0s - loss: 0.0638 - acc: 0.9857
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0641 - acc: 0.9856
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0628 - acc: 0.9875
1152/1283 [=========================>....] - ETA: 0s - loss: 0.0609 - acc: 0.9896
1283/1283 [==============================] - 1s 911us/step - loss: 0.0604 - acc: 0.9906 - val_loss: 1.1932 - val_acc: 0.5677

Epoch 00018: val_acc did not improve
Epoch 19/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0439 - acc: 1.0000
 256/1283 [====>.........................] - ETA: 0s - loss: 0.0482 - acc: 1.0000
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0470 - acc: 1.0000
 640/1283 [=============>................] - ETA: 0s - loss: 0.0489 - acc: 0.9984
 768/1283 [================>.............] - ETA: 0s - loss: 0.0492 - acc: 0.9987
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0511 - acc: 0.9976
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0509 - acc: 0.9979
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0493 - acc: 0.9982
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0509 - acc: 0.9967
1283/1283 [==============================] - 1s 608us/step - loss: 0.0506 - acc: 0.9969 - val_loss: 1.2094 - val_acc: 0.5633

Epoch 00019: val_acc did not improve
Epoch 20/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0493 - acc: 1.0000
 192/1283 [===>..........................] - ETA: 0s - loss: 0.0440 - acc: 1.0000
 320/1283 [======>.......................] - ETA: 0s - loss: 0.0468 - acc: 0.9969
 384/1283 [=======>......................] - ETA: 0s - loss: 0.0431 - acc: 0.9974
 512/1283 [==========>...................] - ETA: 0s - loss: 0.0430 - acc: 0.9961
 576/1283 [============>.................] - ETA: 0s - loss: 0.0427 - acc: 0.9948
 640/1283 [=============>................] - ETA: 0s - loss: 0.0430 - acc: 0.9953
 768/1283 [================>.............] - ETA: 0s - loss: 0.0433 - acc: 0.9961
 896/1283 [===================>..........] - ETA: 0s - loss: 0.0440 - acc: 0.9955
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0439 - acc: 0.9951
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0424 - acc: 0.9959
1283/1283 [==============================] - 1s 644us/step - loss: 0.0432 - acc: 0.9961 - val_loss: 1.2711 - val_acc: 0.5590

Epoch 00020: val_acc did not improve
Epoch 21/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0310 - acc: 1.0000
 256/1283 [====>.........................] - ETA: 0s - loss: 0.0374 - acc: 0.9922
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0368 - acc: 0.9955
 576/1283 [============>.................] - ETA: 0s - loss: 0.0394 - acc: 0.9948
 768/1283 [================>.............] - ETA: 0s - loss: 0.0417 - acc: 0.9948
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0398 - acc: 0.9948
1152/1283 [=========================>....] - ETA: 0s - loss: 0.0389 - acc: 0.9957
1280/1283 [============================>.] - ETA: 0s - loss: 0.0379 - acc: 0.9961
1283/1283 [==============================] - 0s 386us/step - loss: 0.0389 - acc: 0.9953 - val_loss: 1.3007 - val_acc: 0.5546

Epoch 00021: val_acc did not improve
Epoch 22/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0324 - acc: 1.0000
 256/1283 [====>.........................] - ETA: 0s - loss: 0.0469 - acc: 1.0000
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0562 - acc: 0.9978
 576/1283 [============>.................] - ETA: 0s - loss: 0.0631 - acc: 0.9931
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0617 - acc: 0.9929
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0587 - acc: 0.9940
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0572 - acc: 0.9941
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0581 - acc: 0.9910
1283/1283 [==============================] - 1s 426us/step - loss: 0.0586 - acc: 0.9914 - val_loss: 1.2926 - val_acc: 0.5546

Epoch 00022: val_acc did not improve
Epoch 00022: early stopping
batch_size=64
batch_norm=False
dropout_rate=0.1
n_layers=1
max_len=20
nodes=100
mode=A
PCA audio=30
PCA visual=20
PCA text=100
accuracy=0.5364431486880467
best_valid_accuracy=0.5
/afs/inf.ed.ac.uk/user/s17/s1738075/.local/lib/python2.7/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
pca_early_fusion_cnn.py:146: RuntimeWarning: invalid value encountered in divide
  train_set_audio = train_set_audio / audio_max
pca_early_fusion_cnn.py:148: RuntimeWarning: invalid value encountered in divide
  test_set_audio = test_set_audio / audio_max
2018-03-28 22:19:20.221864: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
This API will be deprecated in the future versions. Please check the Github page for the current API

Modality facet for video 8qrpnFRGt2A segment 13 is (partially) missing and is thus being replaced by zeros!

Train on 1283 samples, validate on 229 samples
Epoch 1/100

  64/1283 [>.............................] - ETA: 3s - loss: 0.7602 - acc: 0.4531
 256/1283 [====>.........................] - ETA: 1s - loss: 0.7315 - acc: 0.5703
 448/1283 [=========>....................] - ETA: 0s - loss: 0.7381 - acc: 0.5558
 576/1283 [============>.................] - ETA: 0s - loss: 0.7386 - acc: 0.5590
 704/1283 [===============>..............] - ETA: 0s - loss: 0.7361 - acc: 0.5611
 896/1283 [===================>..........] - ETA: 0s - loss: 0.7365 - acc: 0.5513
1088/1283 [========================>.....] - ETA: 0s - loss: 0.7269 - acc: 0.5506
1216/1283 [===========================>..] - ETA: 0s - loss: 0.7233 - acc: 0.5469
1283/1283 [==============================] - 1s 650us/step - loss: 0.7265 - acc: 0.5440 - val_loss: 0.7198 - val_acc: 0.5284

Epoch 00001: val_acc improved from -inf to 0.52838, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20.ckpt
Epoch 2/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.6720 - acc: 0.5938
 256/1283 [====>.........................] - ETA: 0s - loss: 0.6587 - acc: 0.5898
 448/1283 [=========>....................] - ETA: 0s - loss: 0.6437 - acc: 0.6384
 640/1283 [=============>................] - ETA: 0s - loss: 0.6380 - acc: 0.6469
 832/1283 [==================>...........] - ETA: 0s - loss: 0.6396 - acc: 0.6538
1088/1283 [========================>.....] - ETA: 0s - loss: 0.6339 - acc: 0.6664
1283/1283 [==============================] - 0s 320us/step - loss: 0.6325 - acc: 0.6610 - val_loss: 0.6951 - val_acc: 0.5677

Epoch 00002: val_acc improved from 0.52838 to 0.56769, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20.ckpt
Epoch 3/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5691 - acc: 0.7031
 192/1283 [===>..........................] - ETA: 0s - loss: 0.5830 - acc: 0.6979
 448/1283 [=========>....................] - ETA: 0s - loss: 0.5832 - acc: 0.7076
 704/1283 [===============>..............] - ETA: 0s - loss: 0.5819 - acc: 0.6974
1024/1283 [======================>.......] - ETA: 0s - loss: 0.5728 - acc: 0.7207
1283/1283 [==============================] - 0s 242us/step - loss: 0.5746 - acc: 0.7108 - val_loss: 0.7224 - val_acc: 0.5546

Epoch 00003: val_acc did not improve
Epoch 4/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.6171 - acc: 0.6875
 320/1283 [======>.......................] - ETA: 0s - loss: 0.5601 - acc: 0.7094
 576/1283 [============>.................] - ETA: 0s - loss: 0.5445 - acc: 0.7309
 832/1283 [==================>...........] - ETA: 0s - loss: 0.5338 - acc: 0.7512
1152/1283 [=========================>....] - ETA: 0s - loss: 0.5316 - acc: 0.7500
1283/1283 [==============================] - 0s 242us/step - loss: 0.5324 - acc: 0.7443 - val_loss: 0.7013 - val_acc: 0.5546

Epoch 00004: val_acc did not improve
Epoch 5/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5082 - acc: 0.7344
 256/1283 [====>.........................] - ETA: 0s - loss: 0.5002 - acc: 0.7617
 448/1283 [=========>....................] - ETA: 0s - loss: 0.4887 - acc: 0.7857
 576/1283 [============>.................] - ETA: 0s - loss: 0.4795 - acc: 0.7899
 768/1283 [================>.............] - ETA: 0s - loss: 0.4857 - acc: 0.7747
 960/1283 [=====================>........] - ETA: 0s - loss: 0.4928 - acc: 0.7635
1152/1283 [=========================>....] - ETA: 0s - loss: 0.4825 - acc: 0.7769
1283/1283 [==============================] - 0s 329us/step - loss: 0.4808 - acc: 0.7810 - val_loss: 0.7199 - val_acc: 0.5546

Epoch 00005: val_acc did not improve
Epoch 6/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5124 - acc: 0.7344
 256/1283 [====>.........................] - ETA: 0s - loss: 0.4722 - acc: 0.7734
 448/1283 [=========>....................] - ETA: 0s - loss: 0.4353 - acc: 0.8281
 640/1283 [=============>................] - ETA: 0s - loss: 0.4363 - acc: 0.8125
 832/1283 [==================>...........] - ETA: 0s - loss: 0.4369 - acc: 0.8065
1088/1283 [========================>.....] - ETA: 0s - loss: 0.4491 - acc: 0.7904
1280/1283 [============================>.] - ETA: 0s - loss: 0.4447 - acc: 0.7922
1283/1283 [==============================] - 0s 345us/step - loss: 0.4441 - acc: 0.7927 - val_loss: 0.7316 - val_acc: 0.5764

Epoch 00006: val_acc improved from 0.56769 to 0.57642, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20.ckpt
Epoch 7/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.3968 - acc: 0.8281
 192/1283 [===>..........................] - ETA: 0s - loss: 0.3735 - acc: 0.8385
 384/1283 [=======>......................] - ETA: 0s - loss: 0.3632 - acc: 0.8646
 576/1283 [============>.................] - ETA: 0s - loss: 0.3588 - acc: 0.8646
 768/1283 [================>.............] - ETA: 0s - loss: 0.3616 - acc: 0.8581
 960/1283 [=====================>........] - ETA: 0s - loss: 0.3624 - acc: 0.8562
1152/1283 [=========================>....] - ETA: 0s - loss: 0.3651 - acc: 0.8550
1283/1283 [==============================] - 1s 404us/step - loss: 0.3737 - acc: 0.8449 - val_loss: 0.8254 - val_acc: 0.5721

Epoch 00007: val_acc did not improve
Epoch 8/100

  64/1283 [>.............................] - ETA: 1s - loss: 0.3478 - acc: 0.8594
 256/1283 [====>.........................] - ETA: 0s - loss: 0.3869 - acc: 0.8359
 320/1283 [======>.......................] - ETA: 0s - loss: 0.3810 - acc: 0.8406
 512/1283 [==========>...................] - ETA: 0s - loss: 0.3672 - acc: 0.8613
 704/1283 [===============>..............] - ETA: 0s - loss: 0.3616 - acc: 0.8679
 896/1283 [===================>..........] - ETA: 0s - loss: 0.3502 - acc: 0.8761
1088/1283 [========================>.....] - ETA: 0s - loss: 0.3449 - acc: 0.8787
1280/1283 [============================>.] - ETA: 0s - loss: 0.3376 - acc: 0.8836
1283/1283 [==============================] - 1s 411us/step - loss: 0.3387 - acc: 0.8831 - val_loss: 0.7776 - val_acc: 0.5415

Epoch 00008: val_acc did not improve
Epoch 9/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.2506 - acc: 0.9688
 192/1283 [===>..........................] - ETA: 0s - loss: 0.2675 - acc: 0.9271
 448/1283 [=========>....................] - ETA: 0s - loss: 0.2819 - acc: 0.9062
 640/1283 [=============>................] - ETA: 0s - loss: 0.2887 - acc: 0.9094
 832/1283 [==================>...........] - ETA: 0s - loss: 0.2909 - acc: 0.9123
 960/1283 [=====================>........] - ETA: 0s - loss: 0.2963 - acc: 0.9052
1152/1283 [=========================>....] - ETA: 0s - loss: 0.2983 - acc: 0.9036
1280/1283 [============================>.] - ETA: 0s - loss: 0.2958 - acc: 0.9062
1283/1283 [==============================] - 0s 383us/step - loss: 0.2959 - acc: 0.9057 - val_loss: 0.8168 - val_acc: 0.5939

Epoch 00009: val_acc improved from 0.57642 to 0.59389, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20.ckpt
Epoch 10/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.2429 - acc: 0.9375
 192/1283 [===>..........................] - ETA: 0s - loss: 0.2396 - acc: 0.9271
 256/1283 [====>.........................] - ETA: 0s - loss: 0.2431 - acc: 0.9258
 384/1283 [=======>......................] - ETA: 0s - loss: 0.2422 - acc: 0.9219
 576/1283 [============>.................] - ETA: 0s - loss: 0.2446 - acc: 0.9219
 704/1283 [===============>..............] - ETA: 0s - loss: 0.2520 - acc: 0.9091
 896/1283 [===================>..........] - ETA: 0s - loss: 0.2487 - acc: 0.9152
1088/1283 [========================>.....] - ETA: 0s - loss: 0.2473 - acc: 0.9182
1216/1283 [===========================>..] - ETA: 0s - loss: 0.2452 - acc: 0.9186
1283/1283 [==============================] - 1s 434us/step - loss: 0.2475 - acc: 0.9158 - val_loss: 0.8483 - val_acc: 0.5764

Epoch 00010: val_acc did not improve
Epoch 11/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1636 - acc: 0.9688
 192/1283 [===>..........................] - ETA: 0s - loss: 0.2142 - acc: 0.9427
 448/1283 [=========>....................] - ETA: 0s - loss: 0.2193 - acc: 0.9397
 640/1283 [=============>................] - ETA: 0s - loss: 0.2124 - acc: 0.9484
 896/1283 [===================>..........] - ETA: 0s - loss: 0.2223 - acc: 0.9386
1216/1283 [===========================>..] - ETA: 0s - loss: 0.2178 - acc: 0.9383
1283/1283 [==============================] - 0s 273us/step - loss: 0.2195 - acc: 0.9369 - val_loss: 0.8616 - val_acc: 0.5721

Epoch 00011: val_acc did not improve
Epoch 12/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1941 - acc: 0.9531
 256/1283 [====>.........................] - ETA: 0s - loss: 0.1959 - acc: 0.9531
 512/1283 [==========>...................] - ETA: 0s - loss: 0.1761 - acc: 0.9629
 768/1283 [================>.............] - ETA: 0s - loss: 0.1855 - acc: 0.9544
1088/1283 [========================>.....] - ETA: 0s - loss: 0.1873 - acc: 0.9504
1280/1283 [============================>.] - ETA: 0s - loss: 0.1927 - acc: 0.9461
1283/1283 [==============================] - 0s 275us/step - loss: 0.1924 - acc: 0.9462 - val_loss: 0.9338 - val_acc: 0.5633

Epoch 00012: val_acc did not improve
Epoch 13/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1741 - acc: 0.9375
 384/1283 [=======>......................] - ETA: 0s - loss: 0.1617 - acc: 0.9557
 640/1283 [=============>................] - ETA: 0s - loss: 0.1530 - acc: 0.9594
 896/1283 [===================>..........] - ETA: 0s - loss: 0.1471 - acc: 0.9621
1088/1283 [========================>.....] - ETA: 0s - loss: 0.1454 - acc: 0.9669
1280/1283 [============================>.] - ETA: 0s - loss: 0.1429 - acc: 0.9680
1283/1283 [==============================] - 0s 286us/step - loss: 0.1430 - acc: 0.9680 - val_loss: 1.0086 - val_acc: 0.5633

Epoch 00013: val_acc did not improve
Epoch 14/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0889 - acc: 1.0000
 256/1283 [====>.........................] - ETA: 0s - loss: 0.1146 - acc: 0.9805
 448/1283 [=========>....................] - ETA: 0s - loss: 0.1149 - acc: 0.9732
 576/1283 [============>.................] - ETA: 0s - loss: 0.1154 - acc: 0.9757
 704/1283 [===============>..............] - ETA: 0s - loss: 0.1205 - acc: 0.9759
 960/1283 [=====================>........] - ETA: 0s - loss: 0.1197 - acc: 0.9719
1152/1283 [=========================>....] - ETA: 0s - loss: 0.1172 - acc: 0.9714
1283/1283 [==============================] - 0s 376us/step - loss: 0.1164 - acc: 0.9727 - val_loss: 1.0619 - val_acc: 0.5852

Epoch 00014: val_acc did not improve
Epoch 15/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0794 - acc: 1.0000
 256/1283 [====>.........................] - ETA: 0s - loss: 0.1164 - acc: 0.9844
 448/1283 [=========>....................] - ETA: 0s - loss: 0.1090 - acc: 0.9888
 640/1283 [=============>................] - ETA: 0s - loss: 0.1143 - acc: 0.9812
 832/1283 [==================>...........] - ETA: 0s - loss: 0.1110 - acc: 0.9832
 960/1283 [=====================>........] - ETA: 0s - loss: 0.1108 - acc: 0.9823
1152/1283 [=========================>....] - ETA: 0s - loss: 0.1128 - acc: 0.9792
1283/1283 [==============================] - 0s 343us/step - loss: 0.1123 - acc: 0.9805 - val_loss: 1.0787 - val_acc: 0.5502

Epoch 00015: val_acc did not improve
Epoch 16/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0700 - acc: 1.0000
 256/1283 [====>.........................] - ETA: 0s - loss: 0.0888 - acc: 0.9961
 576/1283 [============>.................] - ETA: 0s - loss: 0.0903 - acc: 0.9931
 768/1283 [================>.............] - ETA: 0s - loss: 0.0943 - acc: 0.9896
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0919 - acc: 0.9906
1280/1283 [============================>.] - ETA: 0s - loss: 0.0905 - acc: 0.9891
1283/1283 [==============================] - 0s 238us/step - loss: 0.0903 - acc: 0.9891 - val_loss: 1.1708 - val_acc: 0.5808

Epoch 00016: val_acc did not improve
Epoch 17/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0605 - acc: 1.0000
 384/1283 [=======>......................] - ETA: 0s - loss: 0.0614 - acc: 0.9948
 768/1283 [================>.............] - ETA: 0s - loss: 0.0642 - acc: 0.9961
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0632 - acc: 0.9945
1283/1283 [==============================] - 0s 176us/step - loss: 0.0629 - acc: 0.9938 - val_loss: 1.2698 - val_acc: 0.5590

Epoch 00017: val_acc did not improve
Epoch 18/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0344 - acc: 1.0000
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0475 - acc: 0.9978
 768/1283 [================>.............] - ETA: 0s - loss: 0.0483 - acc: 0.9974
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0496 - acc: 0.9963
1283/1283 [==============================] - 0s 177us/step - loss: 0.0531 - acc: 0.9945 - val_loss: 1.2802 - val_acc: 0.5459

Epoch 00018: val_acc did not improve
Epoch 19/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0353 - acc: 1.0000
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0798 - acc: 0.9821
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0777 - acc: 0.9856
1280/1283 [============================>.] - ETA: 0s - loss: 0.0772 - acc: 0.9844
1283/1283 [==============================] - 0s 147us/step - loss: 0.0776 - acc: 0.9836 - val_loss: 1.3353 - val_acc: 0.5633

Epoch 00019: val_acc did not improve
Epoch 00019: early stopping
batch_size=64
batch_norm=False
dropout_rate=0.1
n_layers=1
max_len=20
nodes=100
mode=A
PCA audio=30
PCA visual=25
PCA text=100
accuracy=0.5233236151603499
best_valid_accuracy=0.4752186588921283
/afs/inf.ed.ac.uk/user/s17/s1738075/.local/lib/python2.7/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
pca_early_fusion_cnn.py:146: RuntimeWarning: invalid value encountered in divide
  train_set_audio = train_set_audio / audio_max
pca_early_fusion_cnn.py:148: RuntimeWarning: invalid value encountered in divide
  test_set_audio = test_set_audio / audio_max
2018-03-28 22:24:33.555130: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
This API will be deprecated in the future versions. Please check the Github page for the current API

Modality facet for video 8qrpnFRGt2A segment 13 is (partially) missing and is thus being replaced by zeros!

Train on 1283 samples, validate on 229 samples
Epoch 1/100

  64/1283 [>.............................] - ETA: 4s - loss: 0.7456 - acc: 0.5000
 320/1283 [======>.......................] - ETA: 0s - loss: 0.7410 - acc: 0.5312
 640/1283 [=============>................] - ETA: 0s - loss: 0.7432 - acc: 0.5375
 960/1283 [=====================>........] - ETA: 0s - loss: 0.7380 - acc: 0.5375
1283/1283 [==============================] - 0s 380us/step - loss: 0.7306 - acc: 0.5401 - val_loss: 0.7066 - val_acc: 0.5502

Epoch 00001: val_acc improved from -inf to 0.55022, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20.ckpt
Epoch 2/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.6192 - acc: 0.7031
 320/1283 [======>.......................] - ETA: 0s - loss: 0.6249 - acc: 0.6781
 576/1283 [============>.................] - ETA: 0s - loss: 0.6190 - acc: 0.6771
 832/1283 [==================>...........] - ETA: 0s - loss: 0.6158 - acc: 0.6791
1088/1283 [========================>.....] - ETA: 0s - loss: 0.6100 - acc: 0.6783
1283/1283 [==============================] - 0s 259us/step - loss: 0.6031 - acc: 0.6797 - val_loss: 0.7293 - val_acc: 0.5153

Epoch 00002: val_acc did not improve
Epoch 3/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5466 - acc: 0.7344
 256/1283 [====>.........................] - ETA: 0s - loss: 0.5518 - acc: 0.7305
 448/1283 [=========>....................] - ETA: 0s - loss: 0.5505 - acc: 0.7388
 640/1283 [=============>................] - ETA: 0s - loss: 0.5419 - acc: 0.7406
 832/1283 [==================>...........] - ETA: 0s - loss: 0.5416 - acc: 0.7356
1024/1283 [======================>.......] - ETA: 0s - loss: 0.5366 - acc: 0.7344
1216/1283 [===========================>..] - ETA: 0s - loss: 0.5433 - acc: 0.7245
1283/1283 [==============================] - 0s 343us/step - loss: 0.5468 - acc: 0.7210 - val_loss: 0.7342 - val_acc: 0.5371

Epoch 00003: val_acc did not improve
Epoch 4/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.4930 - acc: 0.8125
 256/1283 [====>.........................] - ETA: 0s - loss: 0.5285 - acc: 0.7148
 448/1283 [=========>....................] - ETA: 0s - loss: 0.5029 - acc: 0.7500
 640/1283 [=============>................] - ETA: 0s - loss: 0.5029 - acc: 0.7578
 768/1283 [================>.............] - ETA: 0s - loss: 0.5046 - acc: 0.7552
 960/1283 [=====================>........] - ETA: 0s - loss: 0.5008 - acc: 0.7562
1152/1283 [=========================>....] - ETA: 0s - loss: 0.4964 - acc: 0.7639
1283/1283 [==============================] - 0s 384us/step - loss: 0.4977 - acc: 0.7654 - val_loss: 0.8422 - val_acc: 0.5066

Epoch 00004: val_acc did not improve
Epoch 5/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5043 - acc: 0.7344
 256/1283 [====>.........................] - ETA: 0s - loss: 0.5201 - acc: 0.7109
 448/1283 [=========>....................] - ETA: 0s - loss: 0.4776 - acc: 0.7567
 640/1283 [=============>................] - ETA: 0s - loss: 0.4742 - acc: 0.7531
 896/1283 [===================>..........] - ETA: 0s - loss: 0.4708 - acc: 0.7623
1088/1283 [========================>.....] - ETA: 0s - loss: 0.4746 - acc: 0.7610
1280/1283 [============================>.] - ETA: 0s - loss: 0.4667 - acc: 0.7695
1283/1283 [==============================] - 0s 322us/step - loss: 0.4666 - acc: 0.7693 - val_loss: 0.7459 - val_acc: 0.5459

Epoch 00005: val_acc did not improve
Epoch 6/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.4474 - acc: 0.8281
 256/1283 [====>.........................] - ETA: 0s - loss: 0.3776 - acc: 0.8789
 384/1283 [=======>......................] - ETA: 0s - loss: 0.3873 - acc: 0.8620
 576/1283 [============>.................] - ETA: 0s - loss: 0.3784 - acc: 0.8715
 768/1283 [================>.............] - ETA: 0s - loss: 0.3783 - acc: 0.8698
 960/1283 [=====================>........] - ETA: 0s - loss: 0.3831 - acc: 0.8656
1152/1283 [=========================>....] - ETA: 0s - loss: 0.3847 - acc: 0.8637
1283/1283 [==============================] - 0s 360us/step - loss: 0.3809 - acc: 0.8644 - val_loss: 0.8387 - val_acc: 0.5022

Epoch 00006: val_acc did not improve
Epoch 7/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.3503 - acc: 0.9062
 256/1283 [====>.........................] - ETA: 0s - loss: 0.3591 - acc: 0.8359
 448/1283 [=========>....................] - ETA: 0s - loss: 0.3622 - acc: 0.8482
 640/1283 [=============>................] - ETA: 0s - loss: 0.3575 - acc: 0.8516
 832/1283 [==================>...........] - ETA: 0s - loss: 0.3475 - acc: 0.8666
1088/1283 [========================>.....] - ETA: 0s - loss: 0.3483 - acc: 0.8667
1283/1283 [==============================] - 0s 324us/step - loss: 0.3456 - acc: 0.8675 - val_loss: 0.8055 - val_acc: 0.5546

Epoch 00007: val_acc improved from 0.55022 to 0.55459, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20.ckpt
Epoch 8/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.3461 - acc: 0.8594
 256/1283 [====>.........................] - ETA: 0s - loss: 0.2831 - acc: 0.9180
 448/1283 [=========>....................] - ETA: 0s - loss: 0.2876 - acc: 0.9174
 640/1283 [=============>................] - ETA: 0s - loss: 0.2886 - acc: 0.9125
 832/1283 [==================>...........] - ETA: 0s - loss: 0.2864 - acc: 0.9111
1024/1283 [======================>.......] - ETA: 0s - loss: 0.2828 - acc: 0.9102
1216/1283 [===========================>..] - ETA: 0s - loss: 0.2824 - acc: 0.9104
1283/1283 [==============================] - 0s 365us/step - loss: 0.2783 - acc: 0.9119 - val_loss: 0.8508 - val_acc: 0.5590

Epoch 00008: val_acc improved from 0.55459 to 0.55895, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20.ckpt
Epoch 9/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.2189 - acc: 0.9375
 192/1283 [===>..........................] - ETA: 0s - loss: 0.2961 - acc: 0.8854
 384/1283 [=======>......................] - ETA: 0s - loss: 0.2824 - acc: 0.8984
 576/1283 [============>.................] - ETA: 0s - loss: 0.2685 - acc: 0.9132
 832/1283 [==================>...........] - ETA: 0s - loss: 0.2607 - acc: 0.9171
 960/1283 [=====================>........] - ETA: 0s - loss: 0.2589 - acc: 0.9187
1152/1283 [=========================>....] - ETA: 0s - loss: 0.2573 - acc: 0.9201
1280/1283 [============================>.] - ETA: 0s - loss: 0.2567 - acc: 0.9211
1283/1283 [==============================] - 0s 390us/step - loss: 0.2569 - acc: 0.9213 - val_loss: 0.8510 - val_acc: 0.5590

Epoch 00009: val_acc did not improve
Epoch 10/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1627 - acc: 0.9844
 320/1283 [======>.......................] - ETA: 0s - loss: 0.2650 - acc: 0.9031
 576/1283 [============>.................] - ETA: 0s - loss: 0.2662 - acc: 0.9080
 832/1283 [==================>...........] - ETA: 0s - loss: 0.2558 - acc: 0.9147
1088/1283 [========================>.....] - ETA: 0s - loss: 0.2463 - acc: 0.9182
1280/1283 [============================>.] - ETA: 0s - loss: 0.2409 - acc: 0.9219
1283/1283 [==============================] - 0s 271us/step - loss: 0.2409 - acc: 0.9221 - val_loss: 0.9025 - val_acc: 0.5764

Epoch 00010: val_acc improved from 0.55895 to 0.57642, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20.ckpt
Epoch 11/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.2373 - acc: 0.8750
 256/1283 [====>.........................] - ETA: 0s - loss: 0.1899 - acc: 0.9492
 448/1283 [=========>....................] - ETA: 0s - loss: 0.1773 - acc: 0.9531
 576/1283 [============>.................] - ETA: 0s - loss: 0.1854 - acc: 0.9444
 768/1283 [================>.............] - ETA: 0s - loss: 0.1785 - acc: 0.9466
 960/1283 [=====================>........] - ETA: 0s - loss: 0.1722 - acc: 0.9510
1216/1283 [===========================>..] - ETA: 0s - loss: 0.1712 - acc: 0.9523
1283/1283 [==============================] - 0s 324us/step - loss: 0.1711 - acc: 0.9532 - val_loss: 0.9239 - val_acc: 0.5590

Epoch 00011: val_acc did not improve
Epoch 12/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1297 - acc: 0.9844
 256/1283 [====>.........................] - ETA: 0s - loss: 0.1772 - acc: 0.9297
 448/1283 [=========>....................] - ETA: 0s - loss: 0.1649 - acc: 0.9464
 640/1283 [=============>................] - ETA: 0s - loss: 0.1614 - acc: 0.9500
 896/1283 [===================>..........] - ETA: 0s - loss: 0.1532 - acc: 0.9554
1088/1283 [========================>.....] - ETA: 0s - loss: 0.1526 - acc: 0.9559
1280/1283 [============================>.] - ETA: 0s - loss: 0.1488 - acc: 0.9602
1283/1283 [==============================] - 0s 329us/step - loss: 0.1485 - acc: 0.9602 - val_loss: 0.9489 - val_acc: 0.5677

Epoch 00012: val_acc did not improve
Epoch 13/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1415 - acc: 0.9844
 256/1283 [====>.........................] - ETA: 0s - loss: 0.1186 - acc: 0.9883
 448/1283 [=========>....................] - ETA: 0s - loss: 0.1104 - acc: 0.9888
 640/1283 [=============>................] - ETA: 0s - loss: 0.1125 - acc: 0.9844
 832/1283 [==================>...........] - ETA: 0s - loss: 0.1117 - acc: 0.9856
1088/1283 [========================>.....] - ETA: 0s - loss: 0.1091 - acc: 0.9844
1280/1283 [============================>.] - ETA: 0s - loss: 0.1103 - acc: 0.9852
1283/1283 [==============================] - 0s 333us/step - loss: 0.1101 - acc: 0.9852 - val_loss: 0.9791 - val_acc: 0.5502

Epoch 00013: val_acc did not improve
Epoch 14/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0910 - acc: 0.9844
 320/1283 [======>.......................] - ETA: 0s - loss: 0.0958 - acc: 0.9812
 576/1283 [============>.................] - ETA: 0s - loss: 0.0896 - acc: 0.9878
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0863 - acc: 0.9880
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0850 - acc: 0.9899
1280/1283 [============================>.] - ETA: 0s - loss: 0.0848 - acc: 0.9906
1283/1283 [==============================] - 0s 269us/step - loss: 0.0851 - acc: 0.9906 - val_loss: 1.0383 - val_acc: 0.5502

Epoch 00014: val_acc did not improve
Epoch 15/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0744 - acc: 1.0000
 256/1283 [====>.........................] - ETA: 0s - loss: 0.0903 - acc: 0.9844
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0905 - acc: 0.9844
 576/1283 [============>.................] - ETA: 0s - loss: 0.0860 - acc: 0.9878
 768/1283 [================>.............] - ETA: 0s - loss: 0.0884 - acc: 0.9831
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0897 - acc: 0.9805
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0896 - acc: 0.9803
1283/1283 [==============================] - 0s 366us/step - loss: 0.0887 - acc: 0.9813 - val_loss: 1.1839 - val_acc: 0.5677

Epoch 00015: val_acc did not improve
Epoch 16/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0835 - acc: 0.9688
 256/1283 [====>.........................] - ETA: 0s - loss: 0.0862 - acc: 0.9844
 384/1283 [=======>......................] - ETA: 0s - loss: 0.0799 - acc: 0.9870
 576/1283 [============>.................] - ETA: 0s - loss: 0.0785 - acc: 0.9878
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0746 - acc: 0.9892
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0710 - acc: 0.9902
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0706 - acc: 0.9901
1283/1283 [==============================] - 0s 329us/step - loss: 0.0695 - acc: 0.9906 - val_loss: 1.1063 - val_acc: 0.5677

Epoch 00016: val_acc did not improve
Epoch 17/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0648 - acc: 1.0000
 256/1283 [====>.........................] - ETA: 0s - loss: 0.0552 - acc: 1.0000
 512/1283 [==========>...................] - ETA: 0s - loss: 0.0515 - acc: 0.9980
 768/1283 [================>.............] - ETA: 0s - loss: 0.0508 - acc: 0.9987
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0493 - acc: 0.9961
1280/1283 [============================>.] - ETA: 0s - loss: 0.0481 - acc: 0.9969
1283/1283 [==============================] - 0s 288us/step - loss: 0.0480 - acc: 0.9969 - val_loss: 1.1495 - val_acc: 0.5459

Epoch 00017: val_acc did not improve
Epoch 18/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0324 - acc: 1.0000
 320/1283 [======>.......................] - ETA: 0s - loss: 0.0411 - acc: 1.0000
 512/1283 [==========>...................] - ETA: 0s - loss: 0.0400 - acc: 1.0000
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0376 - acc: 1.0000
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0384 - acc: 0.9990
1152/1283 [=========================>....] - ETA: 0s - loss: 0.0361 - acc: 0.9991
1283/1283 [==============================] - 0s 286us/step - loss: 0.0367 - acc: 0.9984 - val_loss: 1.2128 - val_acc: 0.5633

Epoch 00018: val_acc did not improve
Epoch 19/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0298 - acc: 1.0000
 192/1283 [===>..........................] - ETA: 0s - loss: 0.0291 - acc: 1.0000
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0282 - acc: 1.0000
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0302 - acc: 0.9986
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0294 - acc: 0.9990
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0289 - acc: 0.9990
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0291 - acc: 0.9992
1283/1283 [==============================] - 1s 405us/step - loss: 0.0291 - acc: 0.9984 - val_loss: 1.2368 - val_acc: 0.5590

Epoch 00019: val_acc did not improve
Epoch 20/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0307 - acc: 1.0000
 256/1283 [====>.........................] - ETA: 0s - loss: 0.0222 - acc: 1.0000
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0252 - acc: 0.9978
 640/1283 [=============>................] - ETA: 0s - loss: 0.0253 - acc: 0.9969
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0265 - acc: 0.9964
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0256 - acc: 0.9972
1280/1283 [============================>.] - ETA: 0s - loss: 0.0253 - acc: 0.9977
1283/1283 [==============================] - 0s 339us/step - loss: 0.0255 - acc: 0.9977 - val_loss: 1.2696 - val_acc: 0.5808

Epoch 00020: val_acc improved from 0.57642 to 0.58079, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20.ckpt
Epoch 21/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0141 - acc: 1.0000
 256/1283 [====>.........................] - ETA: 0s - loss: 0.0245 - acc: 0.9961
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0261 - acc: 0.9978
 640/1283 [=============>................] - ETA: 0s - loss: 0.0246 - acc: 0.9984
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0250 - acc: 0.9988
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0259 - acc: 0.9990
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0249 - acc: 0.9992
1283/1283 [==============================] - 0s 354us/step - loss: 0.0255 - acc: 0.9984 - val_loss: 1.2988 - val_acc: 0.5852

Epoch 00021: val_acc improved from 0.58079 to 0.58515, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20.ckpt
Epoch 22/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0206 - acc: 1.0000
 256/1283 [====>.........................] - ETA: 0s - loss: 0.0205 - acc: 1.0000
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0211 - acc: 0.9978
 640/1283 [=============>................] - ETA: 0s - loss: 0.0220 - acc: 0.9984
 896/1283 [===================>..........] - ETA: 0s - loss: 0.0245 - acc: 0.9978
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0254 - acc: 0.9982
1280/1283 [============================>.] - ETA: 0s - loss: 0.0255 - acc: 0.9984
1283/1283 [==============================] - 0s 324us/step - loss: 0.0255 - acc: 0.9984 - val_loss: 1.3104 - val_acc: 0.5983

Epoch 00022: val_acc improved from 0.58515 to 0.59825, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20.ckpt
Epoch 23/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0226 - acc: 1.0000
 256/1283 [====>.........................] - ETA: 0s - loss: 0.0177 - acc: 1.0000
 384/1283 [=======>......................] - ETA: 0s - loss: 0.0186 - acc: 1.0000
 512/1283 [==========>...................] - ETA: 0s - loss: 0.0180 - acc: 1.0000
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0176 - acc: 1.0000
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0171 - acc: 1.0000
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0177 - acc: 0.9990
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0174 - acc: 0.9991
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0172 - acc: 0.9992
1283/1283 [==============================] - 1s 418us/step - loss: 0.0176 - acc: 0.9992 - val_loss: 1.3358 - val_acc: 0.5590

Epoch 00023: val_acc did not improve
Epoch 24/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0136 - acc: 1.0000
 192/1283 [===>..........................] - ETA: 0s - loss: 0.0204 - acc: 1.0000
 384/1283 [=======>......................] - ETA: 0s - loss: 0.0269 - acc: 0.9974
 640/1283 [=============>................] - ETA: 0s - loss: 0.0254 - acc: 0.9969
 896/1283 [===================>..........] - ETA: 0s - loss: 0.0248 - acc: 0.9967
1152/1283 [=========================>....] - ETA: 0s - loss: 0.0243 - acc: 0.9974
1283/1283 [==============================] - 0s 266us/step - loss: 0.0244 - acc: 0.9977 - val_loss: 1.4931 - val_acc: 0.5721

Epoch 00024: val_acc did not improve
Epoch 25/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0262 - acc: 1.0000
 384/1283 [=======>......................] - ETA: 0s - loss: 0.0186 - acc: 0.9974
 640/1283 [=============>................] - ETA: 0s - loss: 0.0175 - acc: 0.9984
 896/1283 [===================>..........] - ETA: 0s - loss: 0.0175 - acc: 0.9989
1152/1283 [=========================>....] - ETA: 0s - loss: 0.0173 - acc: 0.9991
1283/1283 [==============================] - 0s 220us/step - loss: 0.0177 - acc: 0.9992 - val_loss: 1.3830 - val_acc: 0.5808

Epoch 00025: val_acc did not improve
Epoch 26/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0138 - acc: 1.0000
 320/1283 [======>.......................] - ETA: 0s - loss: 0.0133 - acc: 1.0000
 576/1283 [============>.................] - ETA: 0s - loss: 0.0129 - acc: 1.0000
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0144 - acc: 0.9988
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0154 - acc: 0.9990
1280/1283 [============================>.] - ETA: 0s - loss: 0.0142 - acc: 0.9992
1283/1283 [==============================] - 0s 256us/step - loss: 0.0142 - acc: 0.9992 - val_loss: 1.3857 - val_acc: 0.5939

Epoch 00026: val_acc did not improve
Epoch 27/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0116 - acc: 1.0000
 320/1283 [======>.......................] - ETA: 0s - loss: 0.0095 - acc: 1.0000
 576/1283 [============>.................] - ETA: 0s - loss: 0.0096 - acc: 1.0000
 768/1283 [================>.............] - ETA: 0s - loss: 0.0092 - acc: 1.0000
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0092 - acc: 1.0000
1283/1283 [==============================] - 0s 247us/step - loss: 0.0095 - acc: 0.9992 - val_loss: 1.4665 - val_acc: 0.5895

Epoch 00027: val_acc did not improve
Epoch 28/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0113 - acc: 1.0000
 384/1283 [=======>......................] - ETA: 0s - loss: 0.0079 - acc: 1.0000
 640/1283 [=============>................] - ETA: 0s - loss: 0.0070 - acc: 1.0000
 896/1283 [===================>..........] - ETA: 0s - loss: 0.0075 - acc: 0.9989
1152/1283 [=========================>....] - ETA: 0s - loss: 0.0080 - acc: 0.9991
1283/1283 [==============================] - 0s 254us/step - loss: 0.0078 - acc: 0.9992 - val_loss: 1.5083 - val_acc: 0.5808

Epoch 00028: val_acc did not improve
Epoch 29/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0055 - acc: 1.0000
 256/1283 [====>.........................] - ETA: 0s - loss: 0.0059 - acc: 1.0000
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0078 - acc: 1.0000
 640/1283 [=============>................] - ETA: 0s - loss: 0.0070 - acc: 1.0000
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0066 - acc: 1.0000
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0063 - acc: 1.0000
1280/1283 [============================>.] - ETA: 0s - loss: 0.0068 - acc: 0.9992
1283/1283 [==============================] - 0s 323us/step - loss: 0.0068 - acc: 0.9992 - val_loss: 1.5423 - val_acc: 0.5895

Epoch 00029: val_acc did not improve
Epoch 30/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0036 - acc: 1.0000
 384/1283 [=======>......................] - ETA: 0s - loss: 0.0062 - acc: 1.0000
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0057 - acc: 1.0000
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0052 - acc: 1.0000
1280/1283 [============================>.] - ETA: 0s - loss: 0.0059 - acc: 0.9992
1283/1283 [==============================] - 0s 218us/step - loss: 0.0059 - acc: 0.9992 - val_loss: 1.5699 - val_acc: 0.5852

Epoch 00030: val_acc did not improve
Epoch 31/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0047 - acc: 1.0000
 384/1283 [=======>......................] - ETA: 0s - loss: 0.0040 - acc: 1.0000
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0044 - acc: 1.0000
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0049 - acc: 1.0000
1280/1283 [============================>.] - ETA: 0s - loss: 0.0049 - acc: 1.0000
1283/1283 [==============================] - 0s 206us/step - loss: 0.0050 - acc: 1.0000 - val_loss: 1.5746 - val_acc: 0.5852

Epoch 00031: val_acc did not improve
Epoch 32/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0137 - acc: 1.0000
 384/1283 [=======>......................] - ETA: 0s - loss: 0.0068 - acc: 1.0000
 768/1283 [================>.............] - ETA: 0s - loss: 0.0066 - acc: 1.0000
1152/1283 [=========================>....] - ETA: 0s - loss: 0.0058 - acc: 1.0000
1283/1283 [==============================] - 0s 187us/step - loss: 0.0056 - acc: 1.0000 - val_loss: 1.5996 - val_acc: 0.5721

Epoch 00032: val_acc did not improve
Epoch 00032: early stopping
batch_size=64
batch_norm=False
dropout_rate=0.1
n_layers=1
max_len=20
nodes=100
mode=A
PCA audio=30
PCA visual=30
PCA text=100
accuracy=0.5145772594752187
best_valid_accuracy=0.5189504373177842
/afs/inf.ed.ac.uk/user/s17/s1738075/.local/lib/python2.7/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
pca_early_fusion_cnn.py:146: RuntimeWarning: invalid value encountered in divide
  train_set_audio = train_set_audio / audio_max
pca_early_fusion_cnn.py:148: RuntimeWarning: invalid value encountered in divide
  test_set_audio = test_set_audio / audio_max
2018-03-28 22:43:46.451421: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
This API will be deprecated in the future versions. Please check the Github page for the current API

Modality facet for video 8qrpnFRGt2A segment 13 is (partially) missing and is thus being replaced by zeros!

Train on 1283 samples, validate on 229 samples
Epoch 1/100

  64/1283 [>.............................] - ETA: 8s - loss: 0.8074 - acc: 0.4844
 320/1283 [======>.......................] - ETA: 1s - loss: 0.7801 - acc: 0.5156
 512/1283 [==========>...................] - ETA: 0s - loss: 0.7904 - acc: 0.5020
 704/1283 [===============>..............] - ETA: 0s - loss: 0.7769 - acc: 0.5142
 896/1283 [===================>..........] - ETA: 0s - loss: 0.7652 - acc: 0.5179
1088/1283 [========================>.....] - ETA: 0s - loss: 0.7492 - acc: 0.5322
1280/1283 [============================>.] - ETA: 0s - loss: 0.7448 - acc: 0.5336
1283/1283 [==============================] - 1s 700us/step - loss: 0.7446 - acc: 0.5339 - val_loss: 0.7208 - val_acc: 0.4891

Epoch 00001: val_acc improved from -inf to 0.48908, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20.ckpt
Epoch 2/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.6206 - acc: 0.6250
 448/1283 [=========>....................] - ETA: 0s - loss: 0.6185 - acc: 0.6518
 704/1283 [===============>..............] - ETA: 0s - loss: 0.6180 - acc: 0.6605
1024/1283 [======================>.......] - ETA: 0s - loss: 0.6111 - acc: 0.6729
1283/1283 [==============================] - 0s 194us/step - loss: 0.6176 - acc: 0.6594 - val_loss: 0.7158 - val_acc: 0.5328

Epoch 00002: val_acc improved from 0.48908 to 0.53275, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20.ckpt
Epoch 3/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5526 - acc: 0.7188
 448/1283 [=========>....................] - ETA: 0s - loss: 0.5422 - acc: 0.7411
 768/1283 [================>.............] - ETA: 0s - loss: 0.5629 - acc: 0.7174
1088/1283 [========================>.....] - ETA: 0s - loss: 0.5635 - acc: 0.7086
1283/1283 [==============================] - 0s 175us/step - loss: 0.5672 - acc: 0.7054 - val_loss: 0.7339 - val_acc: 0.5066

Epoch 00003: val_acc did not improve
Epoch 4/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.4628 - acc: 0.8594
 256/1283 [====>.........................] - ETA: 0s - loss: 0.4976 - acc: 0.7891
 448/1283 [=========>....................] - ETA: 0s - loss: 0.4948 - acc: 0.7835
 640/1283 [=============>................] - ETA: 0s - loss: 0.4990 - acc: 0.7781
 832/1283 [==================>...........] - ETA: 0s - loss: 0.4970 - acc: 0.7909
1088/1283 [========================>.....] - ETA: 0s - loss: 0.4958 - acc: 0.7923
1283/1283 [==============================] - 0s 302us/step - loss: 0.4959 - acc: 0.7927 - val_loss: 0.7849 - val_acc: 0.5197

Epoch 00004: val_acc did not improve
Epoch 5/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.4223 - acc: 0.8594
 512/1283 [==========>...................] - ETA: 0s - loss: 0.4329 - acc: 0.8242
 832/1283 [==================>...........] - ETA: 0s - loss: 0.4339 - acc: 0.8233
1152/1283 [=========================>....] - ETA: 0s - loss: 0.4421 - acc: 0.8151
1283/1283 [==============================] - 0s 197us/step - loss: 0.4408 - acc: 0.8161 - val_loss: 0.7970 - val_acc: 0.5328

Epoch 00005: val_acc did not improve
Epoch 6/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.3721 - acc: 0.8594
 128/1283 [=>............................] - ETA: 0s - loss: 0.3685 - acc: 0.8750
 512/1283 [==========>...................] - ETA: 0s - loss: 0.3548 - acc: 0.8809
 832/1283 [==================>...........] - ETA: 0s - loss: 0.3755 - acc: 0.8570
1216/1283 [===========================>..] - ETA: 0s - loss: 0.3716 - acc: 0.8577
1283/1283 [==============================] - 0s 209us/step - loss: 0.3697 - acc: 0.8581 - val_loss: 0.8408 - val_acc: 0.5240

Epoch 00006: val_acc did not improve
Epoch 7/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.3786 - acc: 0.8438
 320/1283 [======>.......................] - ETA: 0s - loss: 0.3124 - acc: 0.8969
 768/1283 [================>.............] - ETA: 0s - loss: 0.3319 - acc: 0.8802
1088/1283 [========================>.....] - ETA: 0s - loss: 0.3252 - acc: 0.8934
1283/1283 [==============================] - 0s 181us/step - loss: 0.3263 - acc: 0.8917 - val_loss: 0.9207 - val_acc: 0.5415

Epoch 00007: val_acc improved from 0.53275 to 0.54148, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20.ckpt
Epoch 8/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.3092 - acc: 0.8750
 384/1283 [=======>......................] - ETA: 0s - loss: 0.2721 - acc: 0.9089
 640/1283 [=============>................] - ETA: 0s - loss: 0.2841 - acc: 0.9078
1024/1283 [======================>.......] - ETA: 0s - loss: 0.2993 - acc: 0.8926
1283/1283 [==============================] - 0s 191us/step - loss: 0.3013 - acc: 0.8901 - val_loss: 0.8841 - val_acc: 0.5415

Epoch 00008: val_acc did not improve
Epoch 9/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1859 - acc: 0.9688
 448/1283 [=========>....................] - ETA: 0s - loss: 0.2423 - acc: 0.9196
 768/1283 [================>.............] - ETA: 0s - loss: 0.2440 - acc: 0.9180
1088/1283 [========================>.....] - ETA: 0s - loss: 0.2471 - acc: 0.9127
1283/1283 [==============================] - 0s 172us/step - loss: 0.2452 - acc: 0.9158 - val_loss: 0.9459 - val_acc: 0.5284

Epoch 00009: val_acc did not improve
Epoch 10/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.2059 - acc: 0.9688
 448/1283 [=========>....................] - ETA: 0s - loss: 0.1895 - acc: 0.9554
 704/1283 [===============>..............] - ETA: 0s - loss: 0.1895 - acc: 0.9574
1152/1283 [=========================>....] - ETA: 0s - loss: 0.1872 - acc: 0.9575
1283/1283 [==============================] - 0s 188us/step - loss: 0.1865 - acc: 0.9595 - val_loss: 1.0140 - val_acc: 0.5415

Epoch 00010: val_acc did not improve
Epoch 11/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1170 - acc: 0.9844
 320/1283 [======>.......................] - ETA: 0s - loss: 0.1320 - acc: 0.9844
 576/1283 [============>.................] - ETA: 0s - loss: 0.1335 - acc: 0.9878
 960/1283 [=====================>........] - ETA: 0s - loss: 0.1415 - acc: 0.9792
1280/1283 [============================>.] - ETA: 0s - loss: 0.1449 - acc: 0.9734
1283/1283 [==============================] - 0s 201us/step - loss: 0.1450 - acc: 0.9735 - val_loss: 1.0861 - val_acc: 0.5459

Epoch 00011: val_acc improved from 0.54148 to 0.54585, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20.ckpt
Epoch 12/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1047 - acc: 1.0000
 320/1283 [======>.......................] - ETA: 0s - loss: 0.1049 - acc: 0.9906
 768/1283 [================>.............] - ETA: 0s - loss: 0.1182 - acc: 0.9857
1152/1283 [=========================>....] - ETA: 0s - loss: 0.1204 - acc: 0.9792
1283/1283 [==============================] - 0s 163us/step - loss: 0.1206 - acc: 0.9797 - val_loss: 1.1174 - val_acc: 0.5502

Epoch 00012: val_acc improved from 0.54585 to 0.55022, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20.ckpt
Epoch 13/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0822 - acc: 0.9844
 512/1283 [==========>...................] - ETA: 0s - loss: 0.0950 - acc: 0.9844
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0927 - acc: 0.9868
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0917 - acc: 0.9890
1283/1283 [==============================] - 0s 172us/step - loss: 0.0921 - acc: 0.9891 - val_loss: 1.1655 - val_acc: 0.5284

Epoch 00013: val_acc did not improve
Epoch 14/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0860 - acc: 1.0000
 384/1283 [=======>......................] - ETA: 0s - loss: 0.0735 - acc: 0.9974
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0746 - acc: 0.9957
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0765 - acc: 0.9917
1283/1283 [==============================] - 0s 162us/step - loss: 0.0780 - acc: 0.9922 - val_loss: 1.3301 - val_acc: 0.5371

Epoch 00014: val_acc did not improve
Epoch 15/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0632 - acc: 1.0000
 512/1283 [==========>...................] - ETA: 0s - loss: 0.0576 - acc: 0.9941
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0560 - acc: 0.9958
1283/1283 [==============================] - 0s 131us/step - loss: 0.0584 - acc: 0.9938 - val_loss: 1.2469 - val_acc: 0.5721

Epoch 00015: val_acc improved from 0.55022 to 0.57205, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_20.ckpt
Epoch 16/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0529 - acc: 1.0000
 512/1283 [==========>...................] - ETA: 0s - loss: 0.0541 - acc: 1.0000
 896/1283 [===================>..........] - ETA: 0s - loss: 0.0525 - acc: 1.0000
1280/1283 [============================>.] - ETA: 0s - loss: 0.0507 - acc: 0.9992
1283/1283 [==============================] - 0s 146us/step - loss: 0.0507 - acc: 0.9992 - val_loss: 1.4732 - val_acc: 0.5459

Epoch 00016: val_acc did not improve
Epoch 17/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0270 - acc: 1.0000
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0359 - acc: 1.0000
 768/1283 [================>.............] - ETA: 0s - loss: 0.0370 - acc: 0.9987
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0366 - acc: 0.9992
1283/1283 [==============================] - 0s 156us/step - loss: 0.0366 - acc: 0.9984 - val_loss: 1.4385 - val_acc: 0.5459

Epoch 00017: val_acc did not improve
Epoch 18/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0160 - acc: 1.0000
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0248 - acc: 1.0000
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0281 - acc: 0.9976
1152/1283 [=========================>....] - ETA: 0s - loss: 0.0269 - acc: 0.9983
1283/1283 [==============================] - 0s 172us/step - loss: 0.0274 - acc: 0.9984 - val_loss: 1.4763 - val_acc: 0.5502

Epoch 00018: val_acc did not improve
Epoch 19/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0244 - acc: 1.0000
 320/1283 [======>.......................] - ETA: 0s - loss: 0.0431 - acc: 0.9969
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0374 - acc: 0.9972
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0340 - acc: 0.9982
1283/1283 [==============================] - 0s 175us/step - loss: 0.0333 - acc: 0.9977 - val_loss: 1.5937 - val_acc: 0.5197

Epoch 00019: val_acc did not improve
Epoch 20/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0242 - acc: 1.0000
 512/1283 [==========>...................] - ETA: 0s - loss: 0.0204 - acc: 1.0000
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0228 - acc: 0.9988
1152/1283 [=========================>....] - ETA: 0s - loss: 0.0241 - acc: 0.9983
1283/1283 [==============================] - 0s 171us/step - loss: 0.0244 - acc: 0.9984 - val_loss: 1.8419 - val_acc: 0.5153

Epoch 00020: val_acc did not improve
Epoch 21/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0242 - acc: 1.0000
 384/1283 [=======>......................] - ETA: 0s - loss: 0.0913 - acc: 0.9661
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0893 - acc: 0.9716
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0819 - acc: 0.9766
1283/1283 [==============================] - 0s 183us/step - loss: 0.0766 - acc: 0.9797 - val_loss: 1.4966 - val_acc: 0.5415

Epoch 00021: val_acc did not improve
Epoch 22/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0416 - acc: 0.9844
 512/1283 [==========>...................] - ETA: 0s - loss: 0.0330 - acc: 0.9961
 896/1283 [===================>..........] - ETA: 0s - loss: 0.0284 - acc: 0.9978
1283/1283 [==============================] - 0s 142us/step - loss: 0.0274 - acc: 0.9977 - val_loss: 1.7091 - val_acc: 0.5022

Epoch 00022: val_acc did not improve
Epoch 23/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0097 - acc: 1.0000
 512/1283 [==========>...................] - ETA: 0s - loss: 0.0203 - acc: 1.0000
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0183 - acc: 1.0000
1283/1283 [==============================] - 0s 146us/step - loss: 0.0182 - acc: 0.9992 - val_loss: 1.7559 - val_acc: 0.5371

Epoch 00023: val_acc did not improve
Epoch 24/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0075 - acc: 1.0000
 512/1283 [==========>...................] - ETA: 0s - loss: 0.0125 - acc: 0.9980
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0109 - acc: 0.9990
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0108 - acc: 0.9992
1283/1283 [==============================] - 0s 156us/step - loss: 0.0109 - acc: 0.9992 - val_loss: 1.7957 - val_acc: 0.5415

Epoch 00024: val_acc did not improve
Epoch 25/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0088 - acc: 1.0000
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0100 - acc: 0.9978
 896/1283 [===================>..........] - ETA: 0s - loss: 0.0087 - acc: 0.9989
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0091 - acc: 0.9984
1283/1283 [==============================] - 0s 177us/step - loss: 0.0090 - acc: 0.9984 - val_loss: 1.8920 - val_acc: 0.5371

Epoch 00025: val_acc did not improve
Epoch 00025: early stopping
batch_size=64
batch_norm=False
dropout_rate=0.1
n_layers=1
max_len=20
nodes=100
mode=A
PCA audio=30
PCA visual=35
PCA text=100
accuracy=0.4956268221574344
best_valid_accuracy=0.5233236151603499
