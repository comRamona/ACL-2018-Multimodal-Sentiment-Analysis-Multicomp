/afs/inf.ed.ac.uk/user/s17/s1738075/.local/lib/python2.7/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
pca_early_fusion_cnn.py:146: RuntimeWarning: invalid value encountered in divide
  train_set_audio = train_set_audio / audio_max
pca_early_fusion_cnn.py:148: RuntimeWarning: invalid value encountered in divide
  test_set_audio = test_set_audio / audio_max
2018-03-28 21:48:19.718995: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
This API will be deprecated in the future versions. Please check the Github page for the current API

Modality facet for video 8qrpnFRGt2A segment 13 is (partially) missing and is thus being replaced by zeros!

Train on 1283 samples, validate on 229 samples
Epoch 1/100

  64/1283 [>.............................] - ETA: 8s - loss: 0.7150 - acc: 0.5312
 192/1283 [===>..........................] - ETA: 3s - loss: 0.6913 - acc: 0.5781
 256/1283 [====>.........................] - ETA: 2s - loss: 0.6960 - acc: 0.5547
 320/1283 [======>.......................] - ETA: 2s - loss: 0.6929 - acc: 0.5594
 384/1283 [=======>......................] - ETA: 1s - loss: 0.6950 - acc: 0.5547
 448/1283 [=========>....................] - ETA: 1s - loss: 0.6977 - acc: 0.5446
 576/1283 [============>.................] - ETA: 1s - loss: 0.6982 - acc: 0.5451
 704/1283 [===============>..............] - ETA: 0s - loss: 0.6979 - acc: 0.5526
 832/1283 [==================>...........] - ETA: 0s - loss: 0.6985 - acc: 0.5505
 960/1283 [=====================>........] - ETA: 0s - loss: 0.6961 - acc: 0.5531
1088/1283 [========================>.....] - ETA: 0s - loss: 0.6957 - acc: 0.5561
1152/1283 [=========================>....] - ETA: 0s - loss: 0.6952 - acc: 0.5599
1280/1283 [============================>.] - ETA: 0s - loss: 0.6955 - acc: 0.5586
1283/1283 [==============================] - 2s 1ms/step - loss: 0.6957 - acc: 0.5581 - val_loss: 0.6934 - val_acc: 0.5502

Epoch 00001: val_acc improved from -inf to 0.55022, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_2_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_2_ml_20.ckpt
Epoch 2/100

  64/1283 [>.............................] - ETA: 1s - loss: 0.6810 - acc: 0.5625
 192/1283 [===>..........................] - ETA: 0s - loss: 0.6598 - acc: 0.6354
 320/1283 [======>.......................] - ETA: 0s - loss: 0.6613 - acc: 0.6250
 384/1283 [=======>......................] - ETA: 0s - loss: 0.6629 - acc: 0.6224
 512/1283 [==========>...................] - ETA: 0s - loss: 0.6644 - acc: 0.6211
 576/1283 [============>.................] - ETA: 0s - loss: 0.6639 - acc: 0.6215
 640/1283 [=============>................] - ETA: 0s - loss: 0.6663 - acc: 0.6141
 768/1283 [================>.............] - ETA: 0s - loss: 0.6643 - acc: 0.6185
 832/1283 [==================>...........] - ETA: 0s - loss: 0.6625 - acc: 0.6202
 960/1283 [=====================>........] - ETA: 0s - loss: 0.6614 - acc: 0.6219
1024/1283 [======================>.......] - ETA: 0s - loss: 0.6603 - acc: 0.6260
1152/1283 [=========================>....] - ETA: 0s - loss: 0.6574 - acc: 0.6311
1216/1283 [===========================>..] - ETA: 0s - loss: 0.6590 - acc: 0.6242
1283/1283 [==============================] - 1s 1ms/step - loss: 0.6572 - acc: 0.6259 - val_loss: 0.6861 - val_acc: 0.5590

Epoch 00002: val_acc improved from 0.55022 to 0.55895, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_2_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_2_ml_20.ckpt
Epoch 3/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5891 - acc: 0.7344
 192/1283 [===>..........................] - ETA: 0s - loss: 0.6332 - acc: 0.6302
 384/1283 [=======>......................] - ETA: 0s - loss: 0.6284 - acc: 0.6328
 448/1283 [=========>....................] - ETA: 0s - loss: 0.6243 - acc: 0.6406
 512/1283 [==========>...................] - ETA: 0s - loss: 0.6256 - acc: 0.6406
 576/1283 [============>.................] - ETA: 0s - loss: 0.6231 - acc: 0.6476
 704/1283 [===============>..............] - ETA: 0s - loss: 0.6240 - acc: 0.6477
 832/1283 [==================>...........] - ETA: 0s - loss: 0.6237 - acc: 0.6562
 896/1283 [===================>..........] - ETA: 0s - loss: 0.6225 - acc: 0.6607
 960/1283 [=====================>........] - ETA: 0s - loss: 0.6252 - acc: 0.6583
1024/1283 [======================>.......] - ETA: 0s - loss: 0.6244 - acc: 0.6572
1088/1283 [========================>.....] - ETA: 0s - loss: 0.6270 - acc: 0.6517
1216/1283 [===========================>..] - ETA: 0s - loss: 0.6287 - acc: 0.6497
1283/1283 [==============================] - 1s 911us/step - loss: 0.6292 - acc: 0.6500 - val_loss: 0.6860 - val_acc: 0.5371

Epoch 00003: val_acc did not improve
Epoch 4/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.6216 - acc: 0.6094
 192/1283 [===>..........................] - ETA: 0s - loss: 0.5955 - acc: 0.6823
 320/1283 [======>.......................] - ETA: 0s - loss: 0.5795 - acc: 0.7250
 384/1283 [=======>......................] - ETA: 0s - loss: 0.5800 - acc: 0.7188
 448/1283 [=========>....................] - ETA: 0s - loss: 0.5833 - acc: 0.7098
 576/1283 [============>.................] - ETA: 0s - loss: 0.5946 - acc: 0.6858
 704/1283 [===============>..............] - ETA: 0s - loss: 0.5954 - acc: 0.6889
 832/1283 [==================>...........] - ETA: 0s - loss: 0.5960 - acc: 0.6923
 960/1283 [=====================>........] - ETA: 0s - loss: 0.5954 - acc: 0.6948
1088/1283 [========================>.....] - ETA: 0s - loss: 0.5943 - acc: 0.6967
1152/1283 [=========================>....] - ETA: 0s - loss: 0.5936 - acc: 0.6944
1280/1283 [============================>.] - ETA: 0s - loss: 0.5940 - acc: 0.6898
1283/1283 [==============================] - 1s 995us/step - loss: 0.5946 - acc: 0.6882 - val_loss: 0.7014 - val_acc: 0.5371

Epoch 00004: val_acc did not improve
Epoch 5/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5661 - acc: 0.7031
 192/1283 [===>..........................] - ETA: 0s - loss: 0.5582 - acc: 0.6927
 320/1283 [======>.......................] - ETA: 0s - loss: 0.5860 - acc: 0.6469
 448/1283 [=========>....................] - ETA: 0s - loss: 0.5709 - acc: 0.6719
 640/1283 [=============>................] - ETA: 0s - loss: 0.5634 - acc: 0.6937
 768/1283 [================>.............] - ETA: 0s - loss: 0.5642 - acc: 0.6940
 896/1283 [===================>..........] - ETA: 0s - loss: 0.5633 - acc: 0.6998
1024/1283 [======================>.......] - ETA: 0s - loss: 0.5654 - acc: 0.6982
1152/1283 [=========================>....] - ETA: 0s - loss: 0.5659 - acc: 0.7023
1280/1283 [============================>.] - ETA: 0s - loss: 0.5659 - acc: 0.7055
1283/1283 [==============================] - 1s 810us/step - loss: 0.5657 - acc: 0.7062 - val_loss: 0.6965 - val_acc: 0.5808

Epoch 00005: val_acc improved from 0.55895 to 0.58079, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_2_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_2_ml_20.ckpt
Epoch 6/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.4702 - acc: 0.8125
 192/1283 [===>..........................] - ETA: 1s - loss: 0.4955 - acc: 0.7917
 320/1283 [======>.......................] - ETA: 0s - loss: 0.5121 - acc: 0.7688
 448/1283 [=========>....................] - ETA: 0s - loss: 0.5238 - acc: 0.7589
 576/1283 [============>.................] - ETA: 0s - loss: 0.5151 - acc: 0.7674
 640/1283 [=============>................] - ETA: 0s - loss: 0.5097 - acc: 0.7719
 704/1283 [===============>..............] - ETA: 0s - loss: 0.5098 - acc: 0.7741
 768/1283 [================>.............] - ETA: 0s - loss: 0.5110 - acc: 0.7708
 896/1283 [===================>..........] - ETA: 0s - loss: 0.5107 - acc: 0.7734
1024/1283 [======================>.......] - ETA: 0s - loss: 0.5140 - acc: 0.7666
1088/1283 [========================>.....] - ETA: 0s - loss: 0.5168 - acc: 0.7638
1216/1283 [===========================>..] - ETA: 0s - loss: 0.5142 - acc: 0.7640
1283/1283 [==============================] - 1s 944us/step - loss: 0.5127 - acc: 0.7654 - val_loss: 0.7929 - val_acc: 0.5633

Epoch 00006: val_acc did not improve
Epoch 7/100

  64/1283 [>.............................] - ETA: 1s - loss: 0.5189 - acc: 0.7031
 192/1283 [===>..........................] - ETA: 0s - loss: 0.5617 - acc: 0.7031
 256/1283 [====>.........................] - ETA: 0s - loss: 0.5545 - acc: 0.7031
 384/1283 [=======>......................] - ETA: 0s - loss: 0.5206 - acc: 0.7396
 512/1283 [==========>...................] - ETA: 0s - loss: 0.5276 - acc: 0.7363
 576/1283 [============>.................] - ETA: 0s - loss: 0.5378 - acc: 0.7222
 640/1283 [=============>................] - ETA: 0s - loss: 0.5325 - acc: 0.7234
 768/1283 [================>.............] - ETA: 0s - loss: 0.5167 - acc: 0.7487
 832/1283 [==================>...........] - ETA: 0s - loss: 0.5145 - acc: 0.7476
 960/1283 [=====================>........] - ETA: 0s - loss: 0.5185 - acc: 0.7344
1088/1283 [========================>.....] - ETA: 0s - loss: 0.5093 - acc: 0.7408
1152/1283 [=========================>....] - ETA: 0s - loss: 0.5054 - acc: 0.7457
1216/1283 [===========================>..] - ETA: 0s - loss: 0.5036 - acc: 0.7484
1283/1283 [==============================] - 1s 1ms/step - loss: 0.5044 - acc: 0.7490 - val_loss: 0.7592 - val_acc: 0.5371

Epoch 00007: val_acc did not improve
Epoch 8/100

  64/1283 [>.............................] - ETA: 1s - loss: 0.5296 - acc: 0.6719
 256/1283 [====>.........................] - ETA: 0s - loss: 0.4174 - acc: 0.8203
 384/1283 [=======>......................] - ETA: 0s - loss: 0.4319 - acc: 0.7917
 512/1283 [==========>...................] - ETA: 0s - loss: 0.4335 - acc: 0.7969
 640/1283 [=============>................] - ETA: 0s - loss: 0.4226 - acc: 0.8141
 768/1283 [================>.............] - ETA: 0s - loss: 0.4277 - acc: 0.8138
 832/1283 [==================>...........] - ETA: 0s - loss: 0.4202 - acc: 0.8221
 896/1283 [===================>..........] - ETA: 0s - loss: 0.4161 - acc: 0.8259
1024/1283 [======================>.......] - ETA: 0s - loss: 0.4128 - acc: 0.8320
1152/1283 [=========================>....] - ETA: 0s - loss: 0.4119 - acc: 0.8307
1216/1283 [===========================>..] - ETA: 0s - loss: 0.4089 - acc: 0.8339
1280/1283 [============================>.] - ETA: 0s - loss: 0.4091 - acc: 0.8328
1283/1283 [==============================] - 1s 925us/step - loss: 0.4091 - acc: 0.8324 - val_loss: 0.7795 - val_acc: 0.5677

Epoch 00008: val_acc did not improve
Epoch 9/100

  64/1283 [>.............................] - ETA: 1s - loss: 0.3211 - acc: 0.9062
 128/1283 [=>............................] - ETA: 0s - loss: 0.3659 - acc: 0.8359
 256/1283 [====>.........................] - ETA: 0s - loss: 0.3897 - acc: 0.8008
 320/1283 [======>.......................] - ETA: 0s - loss: 0.3863 - acc: 0.8031
 448/1283 [=========>....................] - ETA: 0s - loss: 0.3882 - acc: 0.8080
 576/1283 [============>.................] - ETA: 0s - loss: 0.3838 - acc: 0.8142
 640/1283 [=============>................] - ETA: 0s - loss: 0.3831 - acc: 0.8125
 704/1283 [===============>..............] - ETA: 0s - loss: 0.3724 - acc: 0.8210
 768/1283 [================>.............] - ETA: 0s - loss: 0.3708 - acc: 0.8229
 896/1283 [===================>..........] - ETA: 0s - loss: 0.3729 - acc: 0.8192
 960/1283 [=====================>........] - ETA: 0s - loss: 0.3731 - acc: 0.8198
1024/1283 [======================>.......] - ETA: 0s - loss: 0.3743 - acc: 0.8193
1088/1283 [========================>.....] - ETA: 0s - loss: 0.3722 - acc: 0.8208
1152/1283 [=========================>....] - ETA: 0s - loss: 0.3703 - acc: 0.8247
1216/1283 [===========================>..] - ETA: 0s - loss: 0.3730 - acc: 0.8248
1280/1283 [============================>.] - ETA: 0s - loss: 0.3746 - acc: 0.8234
1283/1283 [==============================] - 2s 1ms/step - loss: 0.3754 - acc: 0.8223 - val_loss: 0.8045 - val_acc: 0.5590

Epoch 00009: val_acc did not improve
Epoch 10/100

  64/1283 [>.............................] - ETA: 1s - loss: 0.2966 - acc: 0.8750
 128/1283 [=>............................] - ETA: 1s - loss: 0.3274 - acc: 0.8828
 256/1283 [====>.........................] - ETA: 0s - loss: 0.3406 - acc: 0.8633
 384/1283 [=======>......................] - ETA: 0s - loss: 0.3354 - acc: 0.8464
 512/1283 [==========>...................] - ETA: 0s - loss: 0.3471 - acc: 0.8359
 640/1283 [=============>................] - ETA: 0s - loss: 0.3438 - acc: 0.8422
 768/1283 [================>.............] - ETA: 0s - loss: 0.3351 - acc: 0.8490
 896/1283 [===================>..........] - ETA: 0s - loss: 0.3301 - acc: 0.8527
1024/1283 [======================>.......] - ETA: 0s - loss: 0.3324 - acc: 0.8486
1088/1283 [========================>.....] - ETA: 0s - loss: 0.3372 - acc: 0.8428
1152/1283 [=========================>....] - ETA: 0s - loss: 0.3353 - acc: 0.8455
1280/1283 [============================>.] - ETA: 0s - loss: 0.3349 - acc: 0.8453
1283/1283 [==============================] - 1s 770us/step - loss: 0.3354 - acc: 0.8457 - val_loss: 0.8437 - val_acc: 0.5633

Epoch 00010: val_acc did not improve
Epoch 11/100

  64/1283 [>.............................] - ETA: 1s - loss: 0.2833 - acc: 0.8906
 128/1283 [=>............................] - ETA: 1s - loss: 0.2742 - acc: 0.8984
 256/1283 [====>.........................] - ETA: 0s - loss: 0.3340 - acc: 0.8672
 320/1283 [======>.......................] - ETA: 0s - loss: 0.3493 - acc: 0.8594
 384/1283 [=======>......................] - ETA: 1s - loss: 0.3420 - acc: 0.8542
 448/1283 [=========>....................] - ETA: 1s - loss: 0.3374 - acc: 0.8594
 576/1283 [============>.................] - ETA: 1s - loss: 0.3346 - acc: 0.8559
 704/1283 [===============>..............] - ETA: 0s - loss: 0.3358 - acc: 0.8537
 768/1283 [================>.............] - ETA: 0s - loss: 0.3333 - acc: 0.8542
 832/1283 [==================>...........] - ETA: 0s - loss: 0.3330 - acc: 0.8522
 960/1283 [=====================>........] - ETA: 0s - loss: 0.3304 - acc: 0.8521
1024/1283 [======================>.......] - ETA: 0s - loss: 0.3270 - acc: 0.8545
1152/1283 [=========================>....] - ETA: 0s - loss: 0.3272 - acc: 0.8542
1216/1283 [===========================>..] - ETA: 0s - loss: 0.3286 - acc: 0.8536
1280/1283 [============================>.] - ETA: 0s - loss: 0.3303 - acc: 0.8508
1283/1283 [==============================] - 2s 1ms/step - loss: 0.3305 - acc: 0.8504 - val_loss: 0.9682 - val_acc: 0.4978

Epoch 00011: val_acc did not improve
Epoch 12/100

  64/1283 [>.............................] - ETA: 1s - loss: 0.2811 - acc: 0.8906
 128/1283 [=>............................] - ETA: 1s - loss: 0.3528 - acc: 0.8438
 256/1283 [====>.........................] - ETA: 0s - loss: 0.3272 - acc: 0.8438
 384/1283 [=======>......................] - ETA: 0s - loss: 0.3378 - acc: 0.8385
 512/1283 [==========>...................] - ETA: 0s - loss: 0.3333 - acc: 0.8398
 576/1283 [============>.................] - ETA: 0s - loss: 0.3340 - acc: 0.8385
 640/1283 [=============>................] - ETA: 0s - loss: 0.3287 - acc: 0.8422
 704/1283 [===============>..............] - ETA: 0s - loss: 0.3240 - acc: 0.8494
 768/1283 [================>.............] - ETA: 0s - loss: 0.3176 - acc: 0.8542
 832/1283 [==================>...........] - ETA: 0s - loss: 0.3131 - acc: 0.8570
 896/1283 [===================>..........] - ETA: 0s - loss: 0.3087 - acc: 0.8594
1024/1283 [======================>.......] - ETA: 0s - loss: 0.3070 - acc: 0.8613
1152/1283 [=========================>....] - ETA: 0s - loss: 0.3111 - acc: 0.8594
1216/1283 [===========================>..] - ETA: 0s - loss: 0.3123 - acc: 0.8561
1280/1283 [============================>.] - ETA: 0s - loss: 0.3092 - acc: 0.8578
1283/1283 [==============================] - 1s 1ms/step - loss: 0.3086 - acc: 0.8581 - val_loss: 0.8940 - val_acc: 0.5939

Epoch 00012: val_acc improved from 0.58079 to 0.59389, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_2_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_2_ml_20.ckpt
Epoch 13/100

  64/1283 [>.............................] - ETA: 1s - loss: 0.2635 - acc: 0.9219
 128/1283 [=>............................] - ETA: 1s - loss: 0.2313 - acc: 0.9297
 192/1283 [===>..........................] - ETA: 1s - loss: 0.2334 - acc: 0.9271
 256/1283 [====>.........................] - ETA: 1s - loss: 0.2267 - acc: 0.9336
 384/1283 [=======>......................] - ETA: 0s - loss: 0.2497 - acc: 0.9115
 448/1283 [=========>....................] - ETA: 0s - loss: 0.2495 - acc: 0.9085
 512/1283 [==========>...................] - ETA: 0s - loss: 0.2523 - acc: 0.9043
 576/1283 [============>.................] - ETA: 0s - loss: 0.2540 - acc: 0.8976
 640/1283 [=============>................] - ETA: 0s - loss: 0.2501 - acc: 0.8984
 704/1283 [===============>..............] - ETA: 0s - loss: 0.2488 - acc: 0.8977
 768/1283 [================>.............] - ETA: 0s - loss: 0.2523 - acc: 0.8932
 832/1283 [==================>...........] - ETA: 0s - loss: 0.2495 - acc: 0.8942
 960/1283 [=====================>........] - ETA: 0s - loss: 0.2469 - acc: 0.8979
1088/1283 [========================>.....] - ETA: 0s - loss: 0.2451 - acc: 0.8989
1152/1283 [=========================>....] - ETA: 0s - loss: 0.2465 - acc: 0.8984
1280/1283 [============================>.] - ETA: 0s - loss: 0.2442 - acc: 0.9016
1283/1283 [==============================] - 2s 2ms/step - loss: 0.2453 - acc: 0.9010 - val_loss: 0.9993 - val_acc: 0.5939

Epoch 00013: val_acc did not improve
Epoch 14/100

  64/1283 [>.............................] - ETA: 2s - loss: 0.1691 - acc: 0.9375
 128/1283 [=>............................] - ETA: 2s - loss: 0.2122 - acc: 0.9219
 256/1283 [====>.........................] - ETA: 1s - loss: 0.2310 - acc: 0.8984
 384/1283 [=======>......................] - ETA: 1s - loss: 0.2352 - acc: 0.9010
 512/1283 [==========>...................] - ETA: 0s - loss: 0.2287 - acc: 0.9082
 576/1283 [============>.................] - ETA: 0s - loss: 0.2324 - acc: 0.9028
 640/1283 [=============>................] - ETA: 0s - loss: 0.2390 - acc: 0.8984
 768/1283 [================>.............] - ETA: 0s - loss: 0.2328 - acc: 0.9049
 832/1283 [==================>...........] - ETA: 0s - loss: 0.2324 - acc: 0.9062
 896/1283 [===================>..........] - ETA: 0s - loss: 0.2356 - acc: 0.9018
1024/1283 [======================>.......] - ETA: 0s - loss: 0.2372 - acc: 0.9023
1152/1283 [=========================>....] - ETA: 0s - loss: 0.2396 - acc: 0.9010
1216/1283 [===========================>..] - ETA: 0s - loss: 0.2403 - acc: 0.8997
1280/1283 [============================>.] - ETA: 0s - loss: 0.2405 - acc: 0.9000
1283/1283 [==============================] - 2s 1ms/step - loss: 0.2400 - acc: 0.9002 - val_loss: 0.9953 - val_acc: 0.5677

Epoch 00014: val_acc did not improve
Epoch 15/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1780 - acc: 0.9375
 192/1283 [===>..........................] - ETA: 0s - loss: 0.1755 - acc: 0.9427
 320/1283 [======>.......................] - ETA: 0s - loss: 0.1691 - acc: 0.9500
 384/1283 [=======>......................] - ETA: 0s - loss: 0.1746 - acc: 0.9453
 448/1283 [=========>....................] - ETA: 0s - loss: 0.1772 - acc: 0.9442
 512/1283 [==========>...................] - ETA: 0s - loss: 0.1769 - acc: 0.9434
 640/1283 [=============>................] - ETA: 0s - loss: 0.1818 - acc: 0.9391
 704/1283 [===============>..............] - ETA: 0s - loss: 0.1823 - acc: 0.9375
 832/1283 [==================>...........] - ETA: 0s - loss: 0.1808 - acc: 0.9351
 960/1283 [=====================>........] - ETA: 0s - loss: 0.1819 - acc: 0.9354
1024/1283 [======================>.......] - ETA: 0s - loss: 0.1831 - acc: 0.9346
1088/1283 [========================>.....] - ETA: 0s - loss: 0.1807 - acc: 0.9366
1216/1283 [===========================>..] - ETA: 0s - loss: 0.1856 - acc: 0.9309
1280/1283 [============================>.] - ETA: 0s - loss: 0.1858 - acc: 0.9313
1283/1283 [==============================] - 1s 1ms/step - loss: 0.1855 - acc: 0.9314 - val_loss: 1.1275 - val_acc: 0.5764

Epoch 00015: val_acc did not improve
Epoch 16/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1411 - acc: 0.9531
 192/1283 [===>..........................] - ETA: 1s - loss: 0.1487 - acc: 0.9427
 320/1283 [======>.......................] - ETA: 1s - loss: 0.1629 - acc: 0.9406
 448/1283 [=========>....................] - ETA: 0s - loss: 0.1685 - acc: 0.9263
 576/1283 [============>.................] - ETA: 0s - loss: 0.1647 - acc: 0.9306
 704/1283 [===============>..............] - ETA: 0s - loss: 0.1580 - acc: 0.9375
 768/1283 [================>.............] - ETA: 0s - loss: 0.1579 - acc: 0.9375
 896/1283 [===================>..........] - ETA: 0s - loss: 0.1620 - acc: 0.9364
 960/1283 [=====================>........] - ETA: 0s - loss: 0.1595 - acc: 0.9365
1024/1283 [======================>.......] - ETA: 0s - loss: 0.1588 - acc: 0.9365
1088/1283 [========================>.....] - ETA: 0s - loss: 0.1593 - acc: 0.9357
1152/1283 [=========================>....] - ETA: 0s - loss: 0.1574 - acc: 0.9366
1216/1283 [===========================>..] - ETA: 0s - loss: 0.1569 - acc: 0.9383
1280/1283 [============================>.] - ETA: 0s - loss: 0.1574 - acc: 0.9391
1283/1283 [==============================] - 1s 1ms/step - loss: 0.1581 - acc: 0.9384 - val_loss: 1.1741 - val_acc: 0.5371

Epoch 00016: val_acc did not improve
Epoch 17/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1091 - acc: 0.9844
 192/1283 [===>..........................] - ETA: 0s - loss: 0.1328 - acc: 0.9531
 256/1283 [====>.........................] - ETA: 0s - loss: 0.1605 - acc: 0.9375
 320/1283 [======>.......................] - ETA: 1s - loss: 0.1566 - acc: 0.9375
 384/1283 [=======>......................] - ETA: 0s - loss: 0.1435 - acc: 0.9427
 512/1283 [==========>...................] - ETA: 0s - loss: 0.1432 - acc: 0.9434
 576/1283 [============>.................] - ETA: 0s - loss: 0.1436 - acc: 0.9410
 640/1283 [=============>................] - ETA: 0s - loss: 0.1424 - acc: 0.9422
 704/1283 [===============>..............] - ETA: 0s - loss: 0.1374 - acc: 0.9474
 768/1283 [================>.............] - ETA: 0s - loss: 0.1365 - acc: 0.9492
 832/1283 [==================>...........] - ETA: 0s - loss: 0.1366 - acc: 0.9495
 896/1283 [===================>..........] - ETA: 0s - loss: 0.1378 - acc: 0.9475
 960/1283 [=====================>........] - ETA: 0s - loss: 0.1352 - acc: 0.9490
1024/1283 [======================>.......] - ETA: 0s - loss: 0.1383 - acc: 0.9453
1088/1283 [========================>.....] - ETA: 0s - loss: 0.1388 - acc: 0.9467
1216/1283 [===========================>..] - ETA: 0s - loss: 0.1342 - acc: 0.9507
1280/1283 [============================>.] - ETA: 0s - loss: 0.1350 - acc: 0.9500
1283/1283 [==============================] - 2s 1ms/step - loss: 0.1348 - acc: 0.9501 - val_loss: 1.2751 - val_acc: 0.5677

Epoch 00017: val_acc did not improve
Epoch 18/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0946 - acc: 0.9688
 128/1283 [=>............................] - ETA: 0s - loss: 0.1204 - acc: 0.9453
 192/1283 [===>..........................] - ETA: 2s - loss: 0.1323 - acc: 0.9375
 320/1283 [======>.......................] - ETA: 1s - loss: 0.1206 - acc: 0.9469
 384/1283 [=======>......................] - ETA: 1s - loss: 0.1244 - acc: 0.9479
 512/1283 [==========>...................] - ETA: 1s - loss: 0.1203 - acc: 0.9473
 640/1283 [=============>................] - ETA: 0s - loss: 0.1218 - acc: 0.9531
 704/1283 [===============>..............] - ETA: 0s - loss: 0.1245 - acc: 0.9474
 832/1283 [==================>...........] - ETA: 0s - loss: 0.1187 - acc: 0.9507
 896/1283 [===================>..........] - ETA: 0s - loss: 0.1170 - acc: 0.9531
 960/1283 [=====================>........] - ETA: 0s - loss: 0.1162 - acc: 0.9542
1024/1283 [======================>.......] - ETA: 0s - loss: 0.1136 - acc: 0.9570
1088/1283 [========================>.....] - ETA: 0s - loss: 0.1136 - acc: 0.9568
1152/1283 [=========================>....] - ETA: 0s - loss: 0.1101 - acc: 0.9592
1216/1283 [===========================>..] - ETA: 0s - loss: 0.1130 - acc: 0.9581
1283/1283 [==============================] - 2s 1ms/step - loss: 0.1138 - acc: 0.9579 - val_loss: 1.3224 - val_acc: 0.5590

Epoch 00018: val_acc did not improve
Epoch 19/100

  64/1283 [>.............................] - ETA: 4s - loss: 0.1401 - acc: 0.9531
 192/1283 [===>..........................] - ETA: 1s - loss: 0.1513 - acc: 0.9427
 320/1283 [======>.......................] - ETA: 1s - loss: 0.1316 - acc: 0.9625
 448/1283 [=========>....................] - ETA: 0s - loss: 0.1373 - acc: 0.9576
 576/1283 [============>.................] - ETA: 0s - loss: 0.1458 - acc: 0.9531
 704/1283 [===============>..............] - ETA: 0s - loss: 0.1530 - acc: 0.9531
 832/1283 [==================>...........] - ETA: 0s - loss: 0.1544 - acc: 0.9507
 896/1283 [===================>..........] - ETA: 0s - loss: 0.1602 - acc: 0.9464
 960/1283 [=====================>........] - ETA: 0s - loss: 0.1611 - acc: 0.9427
1024/1283 [======================>.......] - ETA: 0s - loss: 0.1586 - acc: 0.9453
1088/1283 [========================>.....] - ETA: 0s - loss: 0.1549 - acc: 0.9467
1216/1283 [===========================>..] - ETA: 0s - loss: 0.1538 - acc: 0.9449
1283/1283 [==============================] - 1s 957us/step - loss: 0.1527 - acc: 0.9447 - val_loss: 1.4341 - val_acc: 0.5284

Epoch 00019: val_acc did not improve
Epoch 20/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1347 - acc: 0.9531
 128/1283 [=>............................] - ETA: 0s - loss: 0.1792 - acc: 0.9375
 192/1283 [===>..........................] - ETA: 0s - loss: 0.1605 - acc: 0.9427
 320/1283 [======>.......................] - ETA: 0s - loss: 0.1529 - acc: 0.9406
 384/1283 [=======>......................] - ETA: 1s - loss: 0.1450 - acc: 0.9453
 512/1283 [==========>...................] - ETA: 0s - loss: 0.1371 - acc: 0.9512
 576/1283 [============>.................] - ETA: 0s - loss: 0.1295 - acc: 0.9566
 704/1283 [===============>..............] - ETA: 0s - loss: 0.1265 - acc: 0.9574
 832/1283 [==================>...........] - ETA: 0s - loss: 0.1277 - acc: 0.9555
 896/1283 [===================>..........] - ETA: 0s - loss: 0.1293 - acc: 0.9554
 960/1283 [=====================>........] - ETA: 0s - loss: 0.1282 - acc: 0.9563
1024/1283 [======================>.......] - ETA: 0s - loss: 0.1269 - acc: 0.9551
1088/1283 [========================>.....] - ETA: 0s - loss: 0.1289 - acc: 0.9550
1152/1283 [=========================>....] - ETA: 0s - loss: 0.1292 - acc: 0.9557
1216/1283 [===========================>..] - ETA: 0s - loss: 0.1302 - acc: 0.9539
1280/1283 [============================>.] - ETA: 0s - loss: 0.1298 - acc: 0.9539
1283/1283 [==============================] - 2s 1ms/step - loss: 0.1300 - acc: 0.9540 - val_loss: 1.4010 - val_acc: 0.5197

Epoch 00020: val_acc did not improve
Epoch 21/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1279 - acc: 0.9219
 192/1283 [===>..........................] - ETA: 0s - loss: 0.1590 - acc: 0.9583
 320/1283 [======>.......................] - ETA: 0s - loss: 0.1528 - acc: 0.9563
 448/1283 [=========>....................] - ETA: 0s - loss: 0.1425 - acc: 0.9554
 512/1283 [==========>...................] - ETA: 0s - loss: 0.1599 - acc: 0.9492
 576/1283 [============>.................] - ETA: 0s - loss: 0.1565 - acc: 0.9531
 640/1283 [=============>................] - ETA: 0s - loss: 0.1550 - acc: 0.9500
 704/1283 [===============>..............] - ETA: 0s - loss: 0.1537 - acc: 0.9503
 768/1283 [================>.............] - ETA: 0s - loss: 0.1550 - acc: 0.9479
 832/1283 [==================>...........] - ETA: 0s - loss: 0.1554 - acc: 0.9459
 896/1283 [===================>..........] - ETA: 0s - loss: 0.1528 - acc: 0.9464
1024/1283 [======================>.......] - ETA: 0s - loss: 0.1479 - acc: 0.9492
1088/1283 [========================>.....] - ETA: 0s - loss: 0.1455 - acc: 0.9494
1152/1283 [=========================>....] - ETA: 0s - loss: 0.1438 - acc: 0.9505
1216/1283 [===========================>..] - ETA: 0s - loss: 0.1402 - acc: 0.9523
1283/1283 [==============================] - 1s 1ms/step - loss: 0.1419 - acc: 0.9501 - val_loss: 1.4433 - val_acc: 0.5153

Epoch 00021: val_acc did not improve
Epoch 22/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1093 - acc: 0.9688
 192/1283 [===>..........................] - ETA: 0s - loss: 0.1110 - acc: 0.9635
 320/1283 [======>.......................] - ETA: 0s - loss: 0.1216 - acc: 0.9563
 384/1283 [=======>......................] - ETA: 1s - loss: 0.1111 - acc: 0.9609
 448/1283 [=========>....................] - ETA: 0s - loss: 0.1169 - acc: 0.9554
 512/1283 [==========>...................] - ETA: 0s - loss: 0.1155 - acc: 0.9590
 640/1283 [=============>................] - ETA: 0s - loss: 0.1206 - acc: 0.9563
 768/1283 [================>.............] - ETA: 0s - loss: 0.1339 - acc: 0.9479
 832/1283 [==================>...........] - ETA: 0s - loss: 0.1363 - acc: 0.9459
 960/1283 [=====================>........] - ETA: 0s - loss: 0.1339 - acc: 0.9469
1024/1283 [======================>.......] - ETA: 0s - loss: 0.1320 - acc: 0.9492
1152/1283 [=========================>....] - ETA: 0s - loss: 0.1316 - acc: 0.9479
1216/1283 [===========================>..] - ETA: 0s - loss: 0.1283 - acc: 0.9498
1280/1283 [============================>.] - ETA: 0s - loss: 0.1256 - acc: 0.9516
1283/1283 [==============================] - 2s 1ms/step - loss: 0.1254 - acc: 0.9517 - val_loss: 1.5041 - val_acc: 0.5590

Epoch 00022: val_acc did not improve
Epoch 00022: early stopping
batch_size=64
batch_norm=False
dropout_rate=0.2
n_layers=2
max_len=20
nodes=100
mode=A
PCA audio=30
PCA visual=10
PCA text=100
accuracy=0.543731778425656
best_valid_accuracy=0.5466472303206997
/afs/inf.ed.ac.uk/user/s17/s1738075/.local/lib/python2.7/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
pca_early_fusion_cnn.py:146: RuntimeWarning: invalid value encountered in divide
  train_set_audio = train_set_audio / audio_max
pca_early_fusion_cnn.py:148: RuntimeWarning: invalid value encountered in divide
  test_set_audio = test_set_audio / audio_max
2018-03-28 21:55:05.565897: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
This API will be deprecated in the future versions. Please check the Github page for the current API

Modality facet for video 8qrpnFRGt2A segment 13 is (partially) missing and is thus being replaced by zeros!

Train on 1283 samples, validate on 229 samples
Epoch 1/100

  64/1283 [>.............................] - ETA: 6s - loss: 0.7672 - acc: 0.4375
 256/1283 [====>.........................] - ETA: 1s - loss: 0.7264 - acc: 0.5312
 384/1283 [=======>......................] - ETA: 1s - loss: 0.7226 - acc: 0.5339
 512/1283 [==========>...................] - ETA: 0s - loss: 0.7112 - acc: 0.5449
 640/1283 [=============>................] - ETA: 0s - loss: 0.7054 - acc: 0.5578
 768/1283 [================>.............] - ETA: 0s - loss: 0.7091 - acc: 0.5560
 960/1283 [=====================>........] - ETA: 0s - loss: 0.7035 - acc: 0.5573
1216/1283 [===========================>..] - ETA: 0s - loss: 0.7007 - acc: 0.5592
1283/1283 [==============================] - 1s 751us/step - loss: 0.7004 - acc: 0.5604 - val_loss: 0.6871 - val_acc: 0.5590

Epoch 00001: val_acc improved from -inf to 0.55895, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_2_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_2_ml_20.ckpt
Epoch 2/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.6667 - acc: 0.6562
 256/1283 [====>.........................] - ETA: 0s - loss: 0.6638 - acc: 0.6211
 448/1283 [=========>....................] - ETA: 0s - loss: 0.6599 - acc: 0.6183
 704/1283 [===============>..............] - ETA: 0s - loss: 0.6615 - acc: 0.6065
 960/1283 [=====================>........] - ETA: 0s - loss: 0.6607 - acc: 0.6073
1152/1283 [=========================>....] - ETA: 0s - loss: 0.6582 - acc: 0.6155
1216/1283 [===========================>..] - ETA: 0s - loss: 0.6580 - acc: 0.6151
1283/1283 [==============================] - 0s 323us/step - loss: 0.6589 - acc: 0.6134 - val_loss: 0.6903 - val_acc: 0.5459

Epoch 00002: val_acc did not improve
Epoch 3/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.6056 - acc: 0.7031
 320/1283 [======>.......................] - ETA: 0s - loss: 0.6314 - acc: 0.6687
 576/1283 [============>.................] - ETA: 0s - loss: 0.6257 - acc: 0.6823
 832/1283 [==================>...........] - ETA: 0s - loss: 0.6224 - acc: 0.6839
1088/1283 [========================>.....] - ETA: 0s - loss: 0.6190 - acc: 0.6829
1283/1283 [==============================] - 0s 275us/step - loss: 0.6242 - acc: 0.6687 - val_loss: 0.6896 - val_acc: 0.5721

Epoch 00003: val_acc improved from 0.55895 to 0.57205, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_2_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_2_ml_20.ckpt
Epoch 4/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5515 - acc: 0.7344
 320/1283 [======>.......................] - ETA: 0s - loss: 0.5940 - acc: 0.6813
 576/1283 [============>.................] - ETA: 0s - loss: 0.5830 - acc: 0.7014
 832/1283 [==================>...........] - ETA: 0s - loss: 0.5861 - acc: 0.7031
1152/1283 [=========================>....] - ETA: 0s - loss: 0.5853 - acc: 0.6936
1283/1283 [==============================] - 0s 271us/step - loss: 0.5883 - acc: 0.6921 - val_loss: 0.6928 - val_acc: 0.5633

Epoch 00004: val_acc did not improve
Epoch 5/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5721 - acc: 0.7188
 320/1283 [======>.......................] - ETA: 0s - loss: 0.5459 - acc: 0.7375
 576/1283 [============>.................] - ETA: 0s - loss: 0.5281 - acc: 0.7535
 832/1283 [==================>...........] - ETA: 0s - loss: 0.5287 - acc: 0.7464
1024/1283 [======================>.......] - ETA: 0s - loss: 0.5279 - acc: 0.7451
1216/1283 [===========================>..] - ETA: 0s - loss: 0.5261 - acc: 0.7500
1283/1283 [==============================] - 0s 302us/step - loss: 0.5246 - acc: 0.7506 - val_loss: 0.7060 - val_acc: 0.5590

Epoch 00005: val_acc did not improve
Epoch 6/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.3897 - acc: 0.9062
 256/1283 [====>.........................] - ETA: 0s - loss: 0.4912 - acc: 0.7500
 512/1283 [==========>...................] - ETA: 0s - loss: 0.4913 - acc: 0.7637
 704/1283 [===============>..............] - ETA: 0s - loss: 0.4825 - acc: 0.7741
 832/1283 [==================>...........] - ETA: 0s - loss: 0.4869 - acc: 0.7716
 960/1283 [=====================>........] - ETA: 0s - loss: 0.4791 - acc: 0.7771
1088/1283 [========================>.....] - ETA: 0s - loss: 0.4802 - acc: 0.7776
1216/1283 [===========================>..] - ETA: 0s - loss: 0.4845 - acc: 0.7747
1283/1283 [==============================] - 1s 448us/step - loss: 0.4845 - acc: 0.7724 - val_loss: 0.8936 - val_acc: 0.5197

Epoch 00006: val_acc did not improve
Epoch 7/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5715 - acc: 0.6719
 192/1283 [===>..........................] - ETA: 0s - loss: 0.5630 - acc: 0.6510
 384/1283 [=======>......................] - ETA: 0s - loss: 0.5035 - acc: 0.7422
 512/1283 [==========>...................] - ETA: 0s - loss: 0.4963 - acc: 0.7461
 704/1283 [===============>..............] - ETA: 0s - loss: 0.4812 - acc: 0.7656
 832/1283 [==================>...........] - ETA: 0s - loss: 0.4787 - acc: 0.7692
 896/1283 [===================>..........] - ETA: 0s - loss: 0.4731 - acc: 0.7812
1152/1283 [=========================>....] - ETA: 0s - loss: 0.4578 - acc: 0.7899
1283/1283 [==============================] - 1s 560us/step - loss: 0.4561 - acc: 0.7942 - val_loss: 0.7629 - val_acc: 0.5633

Epoch 00007: val_acc did not improve
Epoch 8/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.3265 - acc: 0.8750
 192/1283 [===>..........................] - ETA: 0s - loss: 0.3794 - acc: 0.8229
 256/1283 [====>.........................] - ETA: 0s - loss: 0.3978 - acc: 0.8164
 512/1283 [==========>...................] - ETA: 0s - loss: 0.3924 - acc: 0.8164
 640/1283 [=============>................] - ETA: 0s - loss: 0.3855 - acc: 0.8250
 832/1283 [==================>...........] - ETA: 0s - loss: 0.3782 - acc: 0.8317
1024/1283 [======================>.......] - ETA: 0s - loss: 0.3725 - acc: 0.8320
1152/1283 [=========================>....] - ETA: 0s - loss: 0.3714 - acc: 0.8333
1283/1283 [==============================] - 1s 412us/step - loss: 0.3680 - acc: 0.8355 - val_loss: 0.8304 - val_acc: 0.5546

Epoch 00008: val_acc did not improve
Epoch 9/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.3465 - acc: 0.8438
 256/1283 [====>.........................] - ETA: 0s - loss: 0.3445 - acc: 0.8516
 448/1283 [=========>....................] - ETA: 0s - loss: 0.3241 - acc: 0.8683
 640/1283 [=============>................] - ETA: 0s - loss: 0.3248 - acc: 0.8656
 768/1283 [================>.............] - ETA: 0s - loss: 0.3193 - acc: 0.8711
 960/1283 [=====================>........] - ETA: 0s - loss: 0.3152 - acc: 0.8771
1152/1283 [=========================>....] - ETA: 0s - loss: 0.3143 - acc: 0.8802
1283/1283 [==============================] - 0s 384us/step - loss: 0.3136 - acc: 0.8784 - val_loss: 0.8736 - val_acc: 0.5415

Epoch 00009: val_acc did not improve
Epoch 10/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.2455 - acc: 0.9062
 192/1283 [===>..........................] - ETA: 0s - loss: 0.2843 - acc: 0.8750
 384/1283 [=======>......................] - ETA: 0s - loss: 0.2903 - acc: 0.8698
 576/1283 [============>.................] - ETA: 0s - loss: 0.2716 - acc: 0.8889
 704/1283 [===============>..............] - ETA: 0s - loss: 0.2757 - acc: 0.8892
 896/1283 [===================>..........] - ETA: 0s - loss: 0.2813 - acc: 0.8873
1152/1283 [=========================>....] - ETA: 0s - loss: 0.2803 - acc: 0.8863
1283/1283 [==============================] - 0s 322us/step - loss: 0.2811 - acc: 0.8846 - val_loss: 0.9172 - val_acc: 0.5677

Epoch 00010: val_acc did not improve
Epoch 11/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.2102 - acc: 0.9375
 256/1283 [====>.........................] - ETA: 0s - loss: 0.2400 - acc: 0.9219
 448/1283 [=========>....................] - ETA: 0s - loss: 0.2357 - acc: 0.9219
 704/1283 [===============>..............] - ETA: 0s - loss: 0.2222 - acc: 0.9304
 832/1283 [==================>...........] - ETA: 0s - loss: 0.2178 - acc: 0.9327
1088/1283 [========================>.....] - ETA: 0s - loss: 0.2131 - acc: 0.9347
1280/1283 [============================>.] - ETA: 0s - loss: 0.2121 - acc: 0.9313
1283/1283 [==============================] - 0s 346us/step - loss: 0.2121 - acc: 0.9314 - val_loss: 1.0587 - val_acc: 0.5415

Epoch 00011: val_acc did not improve
Epoch 12/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.2015 - acc: 0.9688
 256/1283 [====>.........................] - ETA: 0s - loss: 0.1838 - acc: 0.9609
 448/1283 [=========>....................] - ETA: 0s - loss: 0.1807 - acc: 0.9576
 576/1283 [============>.................] - ETA: 0s - loss: 0.1675 - acc: 0.9618
 768/1283 [================>.............] - ETA: 0s - loss: 0.1706 - acc: 0.9544
 960/1283 [=====================>........] - ETA: 0s - loss: 0.1683 - acc: 0.9521
1152/1283 [=========================>....] - ETA: 0s - loss: 0.1687 - acc: 0.9505
1283/1283 [==============================] - 0s 384us/step - loss: 0.1725 - acc: 0.9439 - val_loss: 1.1217 - val_acc: 0.5808

Epoch 00012: val_acc improved from 0.57205 to 0.58079, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_2_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_2_ml_20.ckpt
Epoch 13/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1831 - acc: 0.9375
 256/1283 [====>.........................] - ETA: 0s - loss: 0.1846 - acc: 0.9062
 512/1283 [==========>...................] - ETA: 0s - loss: 0.1711 - acc: 0.9199
 640/1283 [=============>................] - ETA: 0s - loss: 0.1677 - acc: 0.9266
 896/1283 [===================>..........] - ETA: 0s - loss: 0.1643 - acc: 0.9364
1152/1283 [=========================>....] - ETA: 0s - loss: 0.1675 - acc: 0.9349
1283/1283 [==============================] - 0s 282us/step - loss: 0.1663 - acc: 0.9353 - val_loss: 1.2670 - val_acc: 0.5633

Epoch 00013: val_acc did not improve
Epoch 14/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.2027 - acc: 0.9062
 320/1283 [======>.......................] - ETA: 0s - loss: 0.1592 - acc: 0.9406
 512/1283 [==========>...................] - ETA: 0s - loss: 0.1504 - acc: 0.9473
 640/1283 [=============>................] - ETA: 0s - loss: 0.1420 - acc: 0.9516
 896/1283 [===================>..........] - ETA: 0s - loss: 0.1404 - acc: 0.9554
1088/1283 [========================>.....] - ETA: 0s - loss: 0.1374 - acc: 0.9577
1216/1283 [===========================>..] - ETA: 0s - loss: 0.1329 - acc: 0.9605
1283/1283 [==============================] - 0s 367us/step - loss: 0.1306 - acc: 0.9618 - val_loss: 1.2409 - val_acc: 0.5764

Epoch 00014: val_acc did not improve
Epoch 15/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1274 - acc: 0.9531
 256/1283 [====>.........................] - ETA: 0s - loss: 0.1159 - acc: 0.9609
 448/1283 [=========>....................] - ETA: 0s - loss: 0.1021 - acc: 0.9665
 576/1283 [============>.................] - ETA: 0s - loss: 0.1057 - acc: 0.9653
 704/1283 [===============>..............] - ETA: 0s - loss: 0.1092 - acc: 0.9673
 896/1283 [===================>..........] - ETA: 0s - loss: 0.1118 - acc: 0.9676
1024/1283 [======================>.......] - ETA: 0s - loss: 0.1124 - acc: 0.9639
1280/1283 [============================>.] - ETA: 0s - loss: 0.1088 - acc: 0.9648
1283/1283 [==============================] - 0s 342us/step - loss: 0.1095 - acc: 0.9641 - val_loss: 1.4332 - val_acc: 0.5546

Epoch 00015: val_acc did not improve
Epoch 16/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0551 - acc: 1.0000
 256/1283 [====>.........................] - ETA: 0s - loss: 0.1288 - acc: 0.9492
 448/1283 [=========>....................] - ETA: 0s - loss: 0.1174 - acc: 0.9531
 640/1283 [=============>................] - ETA: 0s - loss: 0.1369 - acc: 0.9391
 768/1283 [================>.............] - ETA: 0s - loss: 0.1520 - acc: 0.9362
 896/1283 [===================>..........] - ETA: 0s - loss: 0.1518 - acc: 0.9364
1152/1283 [=========================>....] - ETA: 0s - loss: 0.1434 - acc: 0.9410
1283/1283 [==============================] - 0s 355us/step - loss: 0.1400 - acc: 0.9408 - val_loss: 1.4597 - val_acc: 0.5459

Epoch 00016: val_acc did not improve
Epoch 17/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1110 - acc: 0.9688
 320/1283 [======>.......................] - ETA: 0s - loss: 0.1044 - acc: 0.9625
 576/1283 [============>.................] - ETA: 0s - loss: 0.0963 - acc: 0.9705
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0957 - acc: 0.9700
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0931 - acc: 0.9715
1280/1283 [============================>.] - ETA: 0s - loss: 0.0930 - acc: 0.9727
1283/1283 [==============================] - 0s 279us/step - loss: 0.0928 - acc: 0.9727 - val_loss: 1.5422 - val_acc: 0.5546

Epoch 00017: val_acc did not improve
Epoch 18/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0765 - acc: 0.9844
 384/1283 [=======>......................] - ETA: 0s - loss: 0.0810 - acc: 0.9818
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0729 - acc: 0.9815
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0719 - acc: 0.9785
1280/1283 [============================>.] - ETA: 0s - loss: 0.0711 - acc: 0.9797
1283/1283 [==============================] - 0s 204us/step - loss: 0.0719 - acc: 0.9790 - val_loss: 1.8372 - val_acc: 0.5502

Epoch 00018: val_acc did not improve
Epoch 19/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1710 - acc: 0.9531
 384/1283 [=======>......................] - ETA: 0s - loss: 0.1246 - acc: 0.9427
 576/1283 [============>.................] - ETA: 0s - loss: 0.1369 - acc: 0.9410
 704/1283 [===============>..............] - ETA: 0s - loss: 0.1349 - acc: 0.9403
 832/1283 [==================>...........] - ETA: 0s - loss: 0.1559 - acc: 0.9303
1024/1283 [======================>.......] - ETA: 0s - loss: 0.1444 - acc: 0.9355
1283/1283 [==============================] - 0s 302us/step - loss: 0.1462 - acc: 0.9345 - val_loss: 1.7161 - val_acc: 0.5590

Epoch 00019: val_acc did not improve
Epoch 20/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1330 - acc: 0.9375
 320/1283 [======>.......................] - ETA: 0s - loss: 0.1167 - acc: 0.9625
 512/1283 [==========>...................] - ETA: 0s - loss: 0.1116 - acc: 0.9629
 704/1283 [===============>..............] - ETA: 0s - loss: 0.1218 - acc: 0.9560
 896/1283 [===================>..........] - ETA: 0s - loss: 0.1300 - acc: 0.9509
1088/1283 [========================>.....] - ETA: 0s - loss: 0.1230 - acc: 0.9550
1280/1283 [============================>.] - ETA: 0s - loss: 0.1275 - acc: 0.9492
1283/1283 [==============================] - 0s 301us/step - loss: 0.1291 - acc: 0.9486 - val_loss: 2.0530 - val_acc: 0.4760

Epoch 00020: val_acc did not improve
Epoch 21/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1030 - acc: 0.9844
 256/1283 [====>.........................] - ETA: 0s - loss: 0.2093 - acc: 0.9414
 448/1283 [=========>....................] - ETA: 0s - loss: 0.1770 - acc: 0.9509
 576/1283 [============>.................] - ETA: 0s - loss: 0.1813 - acc: 0.9427
 768/1283 [================>.............] - ETA: 0s - loss: 0.2008 - acc: 0.9349
 960/1283 [=====================>........] - ETA: 0s - loss: 0.2000 - acc: 0.9292
1152/1283 [=========================>....] - ETA: 0s - loss: 0.1880 - acc: 0.9332
1283/1283 [==============================] - 0s 328us/step - loss: 0.1840 - acc: 0.9330 - val_loss: 1.6970 - val_acc: 0.5153

Epoch 00021: val_acc did not improve
Epoch 22/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1746 - acc: 0.9219
 192/1283 [===>..........................] - ETA: 0s - loss: 0.1326 - acc: 0.9375
 320/1283 [======>.......................] - ETA: 0s - loss: 0.1195 - acc: 0.9469
 448/1283 [=========>....................] - ETA: 0s - loss: 0.1083 - acc: 0.9576
 704/1283 [===============>..............] - ETA: 0s - loss: 0.1109 - acc: 0.9602
 960/1283 [=====================>........] - ETA: 0s - loss: 0.1003 - acc: 0.9615
1280/1283 [============================>.] - ETA: 0s - loss: 0.0953 - acc: 0.9641
1283/1283 [==============================] - 0s 319us/step - loss: 0.0952 - acc: 0.9641 - val_loss: 1.7555 - val_acc: 0.5415

Epoch 00022: val_acc did not improve
Epoch 00022: early stopping
batch_size=64
batch_norm=False
dropout_rate=0.2
n_layers=2
max_len=20
nodes=100
mode=A
PCA audio=30
PCA visual=15
PCA text=100
accuracy=0.4956268221574344
best_valid_accuracy=0.5058309037900874
/afs/inf.ed.ac.uk/user/s17/s1738075/.local/lib/python2.7/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
pca_early_fusion_cnn.py:146: RuntimeWarning: invalid value encountered in divide
  train_set_audio = train_set_audio / audio_max
pca_early_fusion_cnn.py:148: RuntimeWarning: invalid value encountered in divide
  test_set_audio = test_set_audio / audio_max
2018-03-28 22:08:50.807606: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
This API will be deprecated in the future versions. Please check the Github page for the current API

Modality facet for video 8qrpnFRGt2A segment 13 is (partially) missing and is thus being replaced by zeros!

Train on 1283 samples, validate on 229 samples
Epoch 1/100

  64/1283 [>.............................] - ETA: 32s - loss: 0.7027 - acc: 0.5469
 192/1283 [===>..........................] - ETA: 10s - loss: 0.7145 - acc: 0.5260
 320/1283 [======>.......................] - ETA: 5s - loss: 0.7053 - acc: 0.5375 
 448/1283 [=========>....................] - ETA: 3s - loss: 0.7090 - acc: 0.5223
 512/1283 [==========>...................] - ETA: 3s - loss: 0.7083 - acc: 0.5176
 640/1283 [=============>................] - ETA: 2s - loss: 0.7215 - acc: 0.4953
 768/1283 [================>.............] - ETA: 1s - loss: 0.7149 - acc: 0.5039
 896/1283 [===================>..........] - ETA: 0s - loss: 0.7098 - acc: 0.5201
1024/1283 [======================>.......] - ETA: 0s - loss: 0.7119 - acc: 0.5264
1152/1283 [=========================>....] - ETA: 0s - loss: 0.7129 - acc: 0.5295
1280/1283 [============================>.] - ETA: 0s - loss: 0.7111 - acc: 0.5281
1283/1283 [==============================] - 3s 2ms/step - loss: 0.7108 - acc: 0.5292 - val_loss: 0.7013 - val_acc: 0.4934

Epoch 00001: val_acc improved from -inf to 0.49345, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_2_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_2_ml_20.ckpt
Epoch 2/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.6644 - acc: 0.5000
 192/1283 [===>..........................] - ETA: 0s - loss: 0.6563 - acc: 0.5729
 256/1283 [====>.........................] - ETA: 0s - loss: 0.6682 - acc: 0.5820
 320/1283 [======>.......................] - ETA: 0s - loss: 0.6527 - acc: 0.5938
 448/1283 [=========>....................] - ETA: 0s - loss: 0.6478 - acc: 0.6183
 576/1283 [============>.................] - ETA: 0s - loss: 0.6457 - acc: 0.6267
 704/1283 [===============>..............] - ETA: 0s - loss: 0.6535 - acc: 0.6108
 832/1283 [==================>...........] - ETA: 0s - loss: 0.6486 - acc: 0.6178
 896/1283 [===================>..........] - ETA: 0s - loss: 0.6472 - acc: 0.6228
 960/1283 [=====================>........] - ETA: 0s - loss: 0.6477 - acc: 0.6208
1088/1283 [========================>.....] - ETA: 0s - loss: 0.6440 - acc: 0.6333
1216/1283 [===========================>..] - ETA: 0s - loss: 0.6459 - acc: 0.6324
1283/1283 [==============================] - 1s 937us/step - loss: 0.6465 - acc: 0.6313 - val_loss: 0.6884 - val_acc: 0.5633

Epoch 00002: val_acc improved from 0.49345 to 0.56332, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_2_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_2_ml_20.ckpt
Epoch 3/100

  64/1283 [>.............................] - ETA: 1s - loss: 0.5786 - acc: 0.7344
 128/1283 [=>............................] - ETA: 1s - loss: 0.5722 - acc: 0.7109
 192/1283 [===>..........................] - ETA: 0s - loss: 0.5933 - acc: 0.6875
 256/1283 [====>.........................] - ETA: 0s - loss: 0.5845 - acc: 0.6992
 384/1283 [=======>......................] - ETA: 0s - loss: 0.5764 - acc: 0.7109
 512/1283 [==========>...................] - ETA: 0s - loss: 0.5850 - acc: 0.7051
 640/1283 [=============>................] - ETA: 0s - loss: 0.5887 - acc: 0.6922
 768/1283 [================>.............] - ETA: 0s - loss: 0.5889 - acc: 0.6940
 896/1283 [===================>..........] - ETA: 0s - loss: 0.5984 - acc: 0.6763
1024/1283 [======================>.......] - ETA: 0s - loss: 0.5965 - acc: 0.6787
1152/1283 [=========================>....] - ETA: 0s - loss: 0.5937 - acc: 0.6823
1280/1283 [============================>.] - ETA: 0s - loss: 0.5941 - acc: 0.6813
1283/1283 [==============================] - 1s 686us/step - loss: 0.5940 - acc: 0.6812 - val_loss: 0.7085 - val_acc: 0.5328

Epoch 00003: val_acc did not improve
Epoch 4/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.6117 - acc: 0.7031
 192/1283 [===>..........................] - ETA: 0s - loss: 0.5656 - acc: 0.7292
 320/1283 [======>.......................] - ETA: 0s - loss: 0.5608 - acc: 0.7219
 448/1283 [=========>....................] - ETA: 0s - loss: 0.5477 - acc: 0.7388
 576/1283 [============>.................] - ETA: 0s - loss: 0.5476 - acc: 0.7309
 704/1283 [===============>..............] - ETA: 0s - loss: 0.5407 - acc: 0.7330
 832/1283 [==================>...........] - ETA: 0s - loss: 0.5406 - acc: 0.7296
1024/1283 [======================>.......] - ETA: 0s - loss: 0.5445 - acc: 0.7246
1088/1283 [========================>.....] - ETA: 0s - loss: 0.5406 - acc: 0.7270
1152/1283 [=========================>....] - ETA: 0s - loss: 0.5418 - acc: 0.7257
1216/1283 [===========================>..] - ETA: 0s - loss: 0.5383 - acc: 0.7294
1283/1283 [==============================] - 1s 794us/step - loss: 0.5383 - acc: 0.7303 - val_loss: 0.7242 - val_acc: 0.5502

Epoch 00004: val_acc did not improve
Epoch 5/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.4300 - acc: 0.8281
 128/1283 [=>............................] - ETA: 0s - loss: 0.4445 - acc: 0.8281
 192/1283 [===>..........................] - ETA: 0s - loss: 0.4757 - acc: 0.7865
 320/1283 [======>.......................] - ETA: 0s - loss: 0.4666 - acc: 0.7969
 448/1283 [=========>....................] - ETA: 0s - loss: 0.4734 - acc: 0.7946
 512/1283 [==========>...................] - ETA: 0s - loss: 0.4792 - acc: 0.7812
 576/1283 [============>.................] - ETA: 0s - loss: 0.4785 - acc: 0.7830
 640/1283 [=============>................] - ETA: 0s - loss: 0.4773 - acc: 0.7859
 768/1283 [================>.............] - ETA: 0s - loss: 0.4807 - acc: 0.7786
 896/1283 [===================>..........] - ETA: 0s - loss: 0.4777 - acc: 0.7846
1024/1283 [======================>.......] - ETA: 0s - loss: 0.4856 - acc: 0.7783
1152/1283 [=========================>....] - ETA: 0s - loss: 0.4820 - acc: 0.7812
1216/1283 [===========================>..] - ETA: 0s - loss: 0.4809 - acc: 0.7837
1280/1283 [============================>.] - ETA: 0s - loss: 0.4845 - acc: 0.7781
1283/1283 [==============================] - 1s 1ms/step - loss: 0.4842 - acc: 0.7786 - val_loss: 0.7542 - val_acc: 0.5240

Epoch 00005: val_acc did not improve
Epoch 6/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.4271 - acc: 0.8594
 192/1283 [===>..........................] - ETA: 0s - loss: 0.4046 - acc: 0.8281
 256/1283 [====>.........................] - ETA: 0s - loss: 0.4242 - acc: 0.8164
 320/1283 [======>.......................] - ETA: 0s - loss: 0.4124 - acc: 0.8219
 448/1283 [=========>....................] - ETA: 0s - loss: 0.4185 - acc: 0.8147
 576/1283 [============>.................] - ETA: 0s - loss: 0.4164 - acc: 0.8142
 704/1283 [===============>..............] - ETA: 0s - loss: 0.4246 - acc: 0.8054
 832/1283 [==================>...........] - ETA: 0s - loss: 0.4288 - acc: 0.8017
 960/1283 [=====================>........] - ETA: 0s - loss: 0.4256 - acc: 0.8063
1088/1283 [========================>.....] - ETA: 0s - loss: 0.4249 - acc: 0.8088
1216/1283 [===========================>..] - ETA: 0s - loss: 0.4208 - acc: 0.8092
1283/1283 [==============================] - 1s 763us/step - loss: 0.4172 - acc: 0.8137 - val_loss: 0.7691 - val_acc: 0.5633

Epoch 00006: val_acc did not improve
Epoch 7/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.3118 - acc: 0.8906
 192/1283 [===>..........................] - ETA: 0s - loss: 0.3819 - acc: 0.7917
 256/1283 [====>.........................] - ETA: 0s - loss: 0.3912 - acc: 0.7891
 320/1283 [======>.......................] - ETA: 0s - loss: 0.3844 - acc: 0.7906
 384/1283 [=======>......................] - ETA: 0s - loss: 0.3873 - acc: 0.8021
 448/1283 [=========>....................] - ETA: 0s - loss: 0.3781 - acc: 0.8147
 576/1283 [============>.................] - ETA: 0s - loss: 0.4032 - acc: 0.7969
 704/1283 [===============>..............] - ETA: 0s - loss: 0.3958 - acc: 0.8082
 832/1283 [==================>...........] - ETA: 0s - loss: 0.3913 - acc: 0.8137
 960/1283 [=====================>........] - ETA: 0s - loss: 0.3847 - acc: 0.8260
1088/1283 [========================>.....] - ETA: 0s - loss: 0.3784 - acc: 0.8290
1216/1283 [===========================>..] - ETA: 0s - loss: 0.3775 - acc: 0.8314
1283/1283 [==============================] - 1s 741us/step - loss: 0.3750 - acc: 0.8332 - val_loss: 0.8243 - val_acc: 0.5240

Epoch 00007: val_acc did not improve
Epoch 8/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.2483 - acc: 0.9531
 256/1283 [====>.........................] - ETA: 0s - loss: 0.2936 - acc: 0.8906
 320/1283 [======>.......................] - ETA: 0s - loss: 0.2964 - acc: 0.8844
 384/1283 [=======>......................] - ETA: 1s - loss: 0.3016 - acc: 0.8802
 448/1283 [=========>....................] - ETA: 1s - loss: 0.3008 - acc: 0.8795
 576/1283 [============>.................] - ETA: 1s - loss: 0.3006 - acc: 0.8802
 704/1283 [===============>..............] - ETA: 0s - loss: 0.3009 - acc: 0.8750
 832/1283 [==================>...........] - ETA: 0s - loss: 0.3004 - acc: 0.8738
 960/1283 [=====================>........] - ETA: 0s - loss: 0.2984 - acc: 0.8802
1024/1283 [======================>.......] - ETA: 0s - loss: 0.2993 - acc: 0.8799
1152/1283 [=========================>....] - ETA: 0s - loss: 0.2976 - acc: 0.8767
1280/1283 [============================>.] - ETA: 0s - loss: 0.2990 - acc: 0.8781
1283/1283 [==============================] - 1s 1ms/step - loss: 0.2986 - acc: 0.8784 - val_loss: 0.9049 - val_acc: 0.5066

Epoch 00008: val_acc did not improve
Epoch 9/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.2732 - acc: 0.9062
 192/1283 [===>..........................] - ETA: 0s - loss: 0.2112 - acc: 0.9323
 320/1283 [======>.......................] - ETA: 0s - loss: 0.2090 - acc: 0.9375
 448/1283 [=========>....................] - ETA: 0s - loss: 0.2199 - acc: 0.9330
 576/1283 [============>.................] - ETA: 0s - loss: 0.2215 - acc: 0.9306
 640/1283 [=============>................] - ETA: 0s - loss: 0.2184 - acc: 0.9328
 704/1283 [===============>..............] - ETA: 0s - loss: 0.2185 - acc: 0.9347
 832/1283 [==================>...........] - ETA: 0s - loss: 0.2222 - acc: 0.9327
 960/1283 [=====================>........] - ETA: 0s - loss: 0.2215 - acc: 0.9302
1024/1283 [======================>.......] - ETA: 0s - loss: 0.2220 - acc: 0.9287
1088/1283 [========================>.....] - ETA: 0s - loss: 0.2205 - acc: 0.9311
1216/1283 [===========================>..] - ETA: 0s - loss: 0.2225 - acc: 0.9285
1283/1283 [==============================] - 1s 1ms/step - loss: 0.2263 - acc: 0.9260 - val_loss: 1.0080 - val_acc: 0.5328

Epoch 00009: val_acc did not improve
Epoch 10/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1559 - acc: 0.9688
 192/1283 [===>..........................] - ETA: 0s - loss: 0.1757 - acc: 0.9479
 320/1283 [======>.......................] - ETA: 0s - loss: 0.1761 - acc: 0.9437
 448/1283 [=========>....................] - ETA: 0s - loss: 0.1972 - acc: 0.9263
 576/1283 [============>.................] - ETA: 0s - loss: 0.1893 - acc: 0.9340
 704/1283 [===============>..............] - ETA: 0s - loss: 0.1904 - acc: 0.9347
 896/1283 [===================>..........] - ETA: 0s - loss: 0.1916 - acc: 0.9286
1024/1283 [======================>.......] - ETA: 0s - loss: 0.1903 - acc: 0.9287
1152/1283 [=========================>....] - ETA: 0s - loss: 0.1927 - acc: 0.9280
1280/1283 [============================>.] - ETA: 0s - loss: 0.1934 - acc: 0.9281
1283/1283 [==============================] - 1s 519us/step - loss: 0.1933 - acc: 0.9283 - val_loss: 1.0854 - val_acc: 0.5371

Epoch 00010: val_acc did not improve
Epoch 11/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1632 - acc: 0.9531
 192/1283 [===>..........................] - ETA: 0s - loss: 0.1555 - acc: 0.9479
 320/1283 [======>.......................] - ETA: 0s - loss: 0.1521 - acc: 0.9469
 448/1283 [=========>....................] - ETA: 0s - loss: 0.1639 - acc: 0.9308
 576/1283 [============>.................] - ETA: 0s - loss: 0.1651 - acc: 0.9323
 704/1283 [===============>..............] - ETA: 0s - loss: 0.1654 - acc: 0.9332
 832/1283 [==================>...........] - ETA: 0s - loss: 0.1686 - acc: 0.9291
 960/1283 [=====================>........] - ETA: 0s - loss: 0.1680 - acc: 0.9313
1088/1283 [========================>.....] - ETA: 0s - loss: 0.1671 - acc: 0.9347
1280/1283 [============================>.] - ETA: 0s - loss: 0.1612 - acc: 0.9406
1283/1283 [==============================] - 1s 528us/step - loss: 0.1610 - acc: 0.9408 - val_loss: 1.3033 - val_acc: 0.4934

Epoch 00011: val_acc did not improve
Epoch 12/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1541 - acc: 0.9844
 256/1283 [====>.........................] - ETA: 0s - loss: 0.1309 - acc: 0.9727
 384/1283 [=======>......................] - ETA: 0s - loss: 0.1307 - acc: 0.9688
 512/1283 [==========>...................] - ETA: 0s - loss: 0.1225 - acc: 0.9688
 704/1283 [===============>..............] - ETA: 0s - loss: 0.1235 - acc: 0.9673
 832/1283 [==================>...........] - ETA: 0s - loss: 0.1297 - acc: 0.9627
 960/1283 [=====================>........] - ETA: 0s - loss: 0.1270 - acc: 0.9625
1088/1283 [========================>.....] - ETA: 0s - loss: 0.1329 - acc: 0.9577
1216/1283 [===========================>..] - ETA: 0s - loss: 0.1318 - acc: 0.9581
1283/1283 [==============================] - 1s 515us/step - loss: 0.1333 - acc: 0.9564 - val_loss: 1.2647 - val_acc: 0.5371

Epoch 00012: val_acc did not improve
Epoch 00012: early stopping
batch_size=64
batch_norm=False
dropout_rate=0.2
n_layers=2
max_len=20
nodes=100
mode=A
PCA audio=30
PCA visual=20
PCA text=100
accuracy=0.49854227405247814
best_valid_accuracy=0.5262390670553936
/afs/inf.ed.ac.uk/user/s17/s1738075/.local/lib/python2.7/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
pca_early_fusion_cnn.py:146: RuntimeWarning: invalid value encountered in divide
  train_set_audio = train_set_audio / audio_max
pca_early_fusion_cnn.py:148: RuntimeWarning: invalid value encountered in divide
  test_set_audio = test_set_audio / audio_max
2018-03-28 22:18:58.667181: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
This API will be deprecated in the future versions. Please check the Github page for the current API

Modality facet for video 8qrpnFRGt2A segment 13 is (partially) missing and is thus being replaced by zeros!

Train on 1283 samples, validate on 229 samples
Epoch 1/100

  64/1283 [>.............................] - ETA: 15s - loss: 0.7093 - acc: 0.5000
 192/1283 [===>..........................] - ETA: 4s - loss: 0.6996 - acc: 0.5469 
 320/1283 [======>.......................] - ETA: 2s - loss: 0.6984 - acc: 0.5437
 448/1283 [=========>....................] - ETA: 1s - loss: 0.6959 - acc: 0.5625
 576/1283 [============>.................] - ETA: 1s - loss: 0.6968 - acc: 0.5556
 768/1283 [================>.............] - ETA: 0s - loss: 0.6940 - acc: 0.5664
 896/1283 [===================>..........] - ETA: 0s - loss: 0.6929 - acc: 0.5692
1024/1283 [======================>.......] - ETA: 0s - loss: 0.6929 - acc: 0.5693
1216/1283 [===========================>..] - ETA: 0s - loss: 0.6907 - acc: 0.5732
1283/1283 [==============================] - 2s 1ms/step - loss: 0.6930 - acc: 0.5713 - val_loss: 0.6906 - val_acc: 0.5546

Epoch 00001: val_acc improved from -inf to 0.55459, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_2_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_2_ml_20.ckpt
Epoch 2/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.6043 - acc: 0.7188
 192/1283 [===>..........................] - ETA: 0s - loss: 0.6387 - acc: 0.6302
 320/1283 [======>.......................] - ETA: 0s - loss: 0.6433 - acc: 0.6250
 448/1283 [=========>....................] - ETA: 0s - loss: 0.6357 - acc: 0.6384
 512/1283 [==========>...................] - ETA: 0s - loss: 0.6327 - acc: 0.6484
 640/1283 [=============>................] - ETA: 0s - loss: 0.6313 - acc: 0.6500
 768/1283 [================>.............] - ETA: 0s - loss: 0.6323 - acc: 0.6510
 896/1283 [===================>..........] - ETA: 0s - loss: 0.6298 - acc: 0.6596
1024/1283 [======================>.......] - ETA: 0s - loss: 0.6270 - acc: 0.6621
1152/1283 [=========================>....] - ETA: 0s - loss: 0.6239 - acc: 0.6701
1280/1283 [============================>.] - ETA: 0s - loss: 0.6199 - acc: 0.6742
1283/1283 [==============================] - 1s 590us/step - loss: 0.6203 - acc: 0.6734 - val_loss: 0.6920 - val_acc: 0.5633

Epoch 00002: val_acc improved from 0.55459 to 0.56332, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_2_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_2_ml_20.ckpt
Epoch 3/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5663 - acc: 0.7500
 192/1283 [===>..........................] - ETA: 0s - loss: 0.5723 - acc: 0.7344
 320/1283 [======>.......................] - ETA: 0s - loss: 0.5524 - acc: 0.7625
 512/1283 [==========>...................] - ETA: 0s - loss: 0.5625 - acc: 0.7266
 704/1283 [===============>..............] - ETA: 0s - loss: 0.5646 - acc: 0.7259
 832/1283 [==================>...........] - ETA: 0s - loss: 0.5628 - acc: 0.7248
 960/1283 [=====================>........] - ETA: 0s - loss: 0.5671 - acc: 0.7135
1088/1283 [========================>.....] - ETA: 0s - loss: 0.5672 - acc: 0.7132
1216/1283 [===========================>..] - ETA: 0s - loss: 0.5662 - acc: 0.7163
1283/1283 [==============================] - 1s 559us/step - loss: 0.5672 - acc: 0.7140 - val_loss: 0.7145 - val_acc: 0.5459

Epoch 00003: val_acc did not improve
Epoch 4/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5400 - acc: 0.7812
 128/1283 [=>............................] - ETA: 0s - loss: 0.5193 - acc: 0.7734
 192/1283 [===>..........................] - ETA: 0s - loss: 0.5297 - acc: 0.7448
 320/1283 [======>.......................] - ETA: 0s - loss: 0.5242 - acc: 0.7344
 448/1283 [=========>....................] - ETA: 0s - loss: 0.5178 - acc: 0.7478
 640/1283 [=============>................] - ETA: 0s - loss: 0.5108 - acc: 0.7516
 768/1283 [================>.............] - ETA: 0s - loss: 0.5087 - acc: 0.7552
 896/1283 [===================>..........] - ETA: 0s - loss: 0.5080 - acc: 0.7556
1024/1283 [======================>.......] - ETA: 0s - loss: 0.5057 - acc: 0.7559
1216/1283 [===========================>..] - ETA: 0s - loss: 0.5075 - acc: 0.7558
1283/1283 [==============================] - 1s 596us/step - loss: 0.5062 - acc: 0.7553 - val_loss: 0.7401 - val_acc: 0.5852

Epoch 00004: val_acc improved from 0.56332 to 0.58515, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_2_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_2_ml_20.ckpt
Epoch 5/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5133 - acc: 0.7344
 192/1283 [===>..........................] - ETA: 0s - loss: 0.4330 - acc: 0.7969
 320/1283 [======>.......................] - ETA: 0s - loss: 0.4496 - acc: 0.7812
 448/1283 [=========>....................] - ETA: 0s - loss: 0.4446 - acc: 0.7857
 512/1283 [==========>...................] - ETA: 0s - loss: 0.4487 - acc: 0.7773
 576/1283 [============>.................] - ETA: 0s - loss: 0.4402 - acc: 0.7899
 704/1283 [===============>..............] - ETA: 0s - loss: 0.4306 - acc: 0.8011
 832/1283 [==================>...........] - ETA: 0s - loss: 0.4231 - acc: 0.8113
 960/1283 [=====================>........] - ETA: 0s - loss: 0.4248 - acc: 0.8073
1088/1283 [========================>.....] - ETA: 0s - loss: 0.4284 - acc: 0.8015
1216/1283 [===========================>..] - ETA: 0s - loss: 0.4245 - acc: 0.8076
1283/1283 [==============================] - 1s 653us/step - loss: 0.4243 - acc: 0.8083 - val_loss: 0.9734 - val_acc: 0.5502

Epoch 00005: val_acc did not improve
Epoch 6/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.4378 - acc: 0.7812
 192/1283 [===>..........................] - ETA: 0s - loss: 0.4349 - acc: 0.7500
 320/1283 [======>.......................] - ETA: 0s - loss: 0.4005 - acc: 0.7875
 384/1283 [=======>......................] - ETA: 0s - loss: 0.4117 - acc: 0.7812
 512/1283 [==========>...................] - ETA: 0s - loss: 0.4134 - acc: 0.7930
 640/1283 [=============>................] - ETA: 0s - loss: 0.4033 - acc: 0.8000
 768/1283 [================>.............] - ETA: 0s - loss: 0.4081 - acc: 0.7956
 896/1283 [===================>..........] - ETA: 0s - loss: 0.4058 - acc: 0.7980
1024/1283 [======================>.......] - ETA: 0s - loss: 0.4096 - acc: 0.7949
1152/1283 [=========================>....] - ETA: 0s - loss: 0.4091 - acc: 0.7986
1280/1283 [============================>.] - ETA: 0s - loss: 0.3992 - acc: 0.8094
1283/1283 [==============================] - 1s 558us/step - loss: 0.3987 - acc: 0.8098 - val_loss: 0.9097 - val_acc: 0.5546

Epoch 00006: val_acc did not improve
Epoch 7/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.3732 - acc: 0.8438
 192/1283 [===>..........................] - ETA: 0s - loss: 0.3806 - acc: 0.8177
 320/1283 [======>.......................] - ETA: 0s - loss: 0.3644 - acc: 0.8313
 384/1283 [=======>......................] - ETA: 0s - loss: 0.3619 - acc: 0.8359
 512/1283 [==========>...................] - ETA: 0s - loss: 0.3690 - acc: 0.8320
 640/1283 [=============>................] - ETA: 0s - loss: 0.3544 - acc: 0.8453
 704/1283 [===============>..............] - ETA: 0s - loss: 0.3491 - acc: 0.8494
 768/1283 [================>.............] - ETA: 0s - loss: 0.3487 - acc: 0.8490
 896/1283 [===================>..........] - ETA: 0s - loss: 0.3419 - acc: 0.8471
1024/1283 [======================>.......] - ETA: 0s - loss: 0.3336 - acc: 0.8516
1152/1283 [=========================>....] - ETA: 0s - loss: 0.3275 - acc: 0.8559
1280/1283 [============================>.] - ETA: 0s - loss: 0.3267 - acc: 0.8570
1283/1283 [==============================] - 1s 677us/step - loss: 0.3273 - acc: 0.8566 - val_loss: 0.8114 - val_acc: 0.5677

Epoch 00007: val_acc did not improve
Epoch 8/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.2252 - acc: 0.9062
 128/1283 [=>............................] - ETA: 0s - loss: 0.2038 - acc: 0.9297
 256/1283 [====>.........................] - ETA: 0s - loss: 0.2571 - acc: 0.9062
 384/1283 [=======>......................] - ETA: 0s - loss: 0.2820 - acc: 0.8750
 512/1283 [==========>...................] - ETA: 0s - loss: 0.2943 - acc: 0.8730
 640/1283 [=============>................] - ETA: 0s - loss: 0.3056 - acc: 0.8594
 768/1283 [================>.............] - ETA: 0s - loss: 0.3021 - acc: 0.8633
 896/1283 [===================>..........] - ETA: 0s - loss: 0.3026 - acc: 0.8605
1024/1283 [======================>.......] - ETA: 0s - loss: 0.3041 - acc: 0.8594
1152/1283 [=========================>....] - ETA: 0s - loss: 0.3003 - acc: 0.8628
1280/1283 [============================>.] - ETA: 0s - loss: 0.2945 - acc: 0.8688
1283/1283 [==============================] - 1s 623us/step - loss: 0.2941 - acc: 0.8691 - val_loss: 0.8494 - val_acc: 0.5852

Epoch 00008: val_acc improved from 0.58515 to 0.58515, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_2_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_2_ml_20.ckpt
Epoch 9/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.2001 - acc: 0.8906
 192/1283 [===>..........................] - ETA: 0s - loss: 0.2106 - acc: 0.9167
 320/1283 [======>.......................] - ETA: 0s - loss: 0.2139 - acc: 0.9125
 448/1283 [=========>....................] - ETA: 0s - loss: 0.2403 - acc: 0.8973
 576/1283 [============>.................] - ETA: 0s - loss: 0.2372 - acc: 0.9028
 704/1283 [===============>..............] - ETA: 0s - loss: 0.2412 - acc: 0.9020
 832/1283 [==================>...........] - ETA: 0s - loss: 0.2463 - acc: 0.9026
 960/1283 [=====================>........] - ETA: 0s - loss: 0.2434 - acc: 0.9031
1088/1283 [========================>.....] - ETA: 0s - loss: 0.2479 - acc: 0.8980
1152/1283 [=========================>....] - ETA: 0s - loss: 0.2456 - acc: 0.8984
1216/1283 [===========================>..] - ETA: 0s - loss: 0.2434 - acc: 0.9013
1283/1283 [==============================] - 1s 646us/step - loss: 0.2410 - acc: 0.9049 - val_loss: 1.0671 - val_acc: 0.4891

Epoch 00009: val_acc did not improve
Epoch 10/100

  64/1283 [>.............................] - ETA: 1s - loss: 0.1952 - acc: 0.9219
 192/1283 [===>..........................] - ETA: 0s - loss: 0.2045 - acc: 0.9271
 320/1283 [======>.......................] - ETA: 0s - loss: 0.2016 - acc: 0.9156
 448/1283 [=========>....................] - ETA: 0s - loss: 0.1985 - acc: 0.9196
 576/1283 [============>.................] - ETA: 0s - loss: 0.2161 - acc: 0.9115
 704/1283 [===============>..............] - ETA: 0s - loss: 0.2070 - acc: 0.9148
 832/1283 [==================>...........] - ETA: 0s - loss: 0.1974 - acc: 0.9207
 960/1283 [=====================>........] - ETA: 0s - loss: 0.1985 - acc: 0.9229
1088/1283 [========================>.....] - ETA: 0s - loss: 0.1998 - acc: 0.9228
1216/1283 [===========================>..] - ETA: 0s - loss: 0.1979 - acc: 0.9235
1283/1283 [==============================] - 1s 564us/step - loss: 0.1990 - acc: 0.9228 - val_loss: 1.2499 - val_acc: 0.5677

Epoch 00010: val_acc did not improve
Epoch 11/100

  64/1283 [>.............................] - ETA: 1s - loss: 0.2722 - acc: 0.8750
 128/1283 [=>............................] - ETA: 1s - loss: 0.2368 - acc: 0.9062
 256/1283 [====>.........................] - ETA: 0s - loss: 0.1844 - acc: 0.9414
 384/1283 [=======>......................] - ETA: 0s - loss: 0.1683 - acc: 0.9453
 512/1283 [==========>...................] - ETA: 0s - loss: 0.1744 - acc: 0.9336
 576/1283 [============>.................] - ETA: 0s - loss: 0.1719 - acc: 0.9358
 768/1283 [================>.............] - ETA: 0s - loss: 0.1593 - acc: 0.9427
 896/1283 [===================>..........] - ETA: 0s - loss: 0.1576 - acc: 0.9431
1088/1283 [========================>.....] - ETA: 0s - loss: 0.1544 - acc: 0.9421
1216/1283 [===========================>..] - ETA: 0s - loss: 0.1485 - acc: 0.9474
1283/1283 [==============================] - 1s 641us/step - loss: 0.1456 - acc: 0.9493 - val_loss: 1.0919 - val_acc: 0.5546

Epoch 00011: val_acc did not improve
Epoch 12/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1019 - acc: 0.9531
 192/1283 [===>..........................] - ETA: 0s - loss: 0.1029 - acc: 0.9635
 384/1283 [=======>......................] - ETA: 0s - loss: 0.0924 - acc: 0.9792
 512/1283 [==========>...................] - ETA: 0s - loss: 0.0915 - acc: 0.9824
 640/1283 [=============>................] - ETA: 0s - loss: 0.0924 - acc: 0.9797
 768/1283 [================>.............] - ETA: 0s - loss: 0.0893 - acc: 0.9792
 896/1283 [===================>..........] - ETA: 0s - loss: 0.0862 - acc: 0.9810
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0882 - acc: 0.9766
1152/1283 [=========================>....] - ETA: 0s - loss: 0.0865 - acc: 0.9766
1280/1283 [============================>.] - ETA: 0s - loss: 0.0897 - acc: 0.9758
1283/1283 [==============================] - 1s 484us/step - loss: 0.0903 - acc: 0.9751 - val_loss: 1.2050 - val_acc: 0.5764

Epoch 00012: val_acc did not improve
Epoch 13/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0829 - acc: 0.9844
 192/1283 [===>..........................] - ETA: 0s - loss: 0.0908 - acc: 0.9688
 320/1283 [======>.......................] - ETA: 0s - loss: 0.1074 - acc: 0.9531
 448/1283 [=========>....................] - ETA: 0s - loss: 0.1099 - acc: 0.9576
 640/1283 [=============>................] - ETA: 0s - loss: 0.1032 - acc: 0.9656
 768/1283 [================>.............] - ETA: 0s - loss: 0.1048 - acc: 0.9648
 896/1283 [===================>..........] - ETA: 0s - loss: 0.0995 - acc: 0.9665
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0955 - acc: 0.9697
1152/1283 [=========================>....] - ETA: 0s - loss: 0.0934 - acc: 0.9705
1283/1283 [==============================] - 1s 574us/step - loss: 0.0921 - acc: 0.9712 - val_loss: 1.2924 - val_acc: 0.5677

Epoch 00013: val_acc did not improve
Epoch 14/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0493 - acc: 0.9844
 192/1283 [===>..........................] - ETA: 0s - loss: 0.0616 - acc: 0.9844
 256/1283 [====>.........................] - ETA: 0s - loss: 0.0557 - acc: 0.9883
 384/1283 [=======>......................] - ETA: 0s - loss: 0.0615 - acc: 0.9818
 512/1283 [==========>...................] - ETA: 0s - loss: 0.0657 - acc: 0.9785
 640/1283 [=============>................] - ETA: 0s - loss: 0.0650 - acc: 0.9797
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0689 - acc: 0.9773
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0700 - acc: 0.9772
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0673 - acc: 0.9781
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0685 - acc: 0.9766
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0721 - acc: 0.9761
1280/1283 [============================>.] - ETA: 0s - loss: 0.0737 - acc: 0.9719
1283/1283 [==============================] - 1s 769us/step - loss: 0.0735 - acc: 0.9719 - val_loss: 1.4881 - val_acc: 0.5328

Epoch 00014: val_acc did not improve
Epoch 15/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0264 - acc: 1.0000
 192/1283 [===>..........................] - ETA: 0s - loss: 0.0600 - acc: 0.9792
 256/1283 [====>.........................] - ETA: 0s - loss: 0.0594 - acc: 0.9844
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0589 - acc: 0.9888
 640/1283 [=============>................] - ETA: 0s - loss: 0.0569 - acc: 0.9875
 896/1283 [===================>..........] - ETA: 0s - loss: 0.0544 - acc: 0.9855
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0555 - acc: 0.9853
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0542 - acc: 0.9860
1283/1283 [==============================] - 1s 442us/step - loss: 0.0524 - acc: 0.9867 - val_loss: 1.4999 - val_acc: 0.5721

Epoch 00015: val_acc did not improve
Epoch 16/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0274 - acc: 0.9844
 192/1283 [===>..........................] - ETA: 0s - loss: 0.0352 - acc: 0.9896
 384/1283 [=======>......................] - ETA: 0s - loss: 0.0449 - acc: 0.9818
 512/1283 [==========>...................] - ETA: 0s - loss: 0.0432 - acc: 0.9824
 640/1283 [=============>................] - ETA: 0s - loss: 0.0438 - acc: 0.9844
 768/1283 [================>.............] - ETA: 0s - loss: 0.0422 - acc: 0.9857
 896/1283 [===================>..........] - ETA: 0s - loss: 0.0439 - acc: 0.9844
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0409 - acc: 0.9863
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0406 - acc: 0.9871
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0404 - acc: 0.9868
1283/1283 [==============================] - 1s 637us/step - loss: 0.0400 - acc: 0.9875 - val_loss: 1.5798 - val_acc: 0.5721

Epoch 00016: val_acc did not improve
Epoch 17/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0252 - acc: 0.9844
 192/1283 [===>..........................] - ETA: 0s - loss: 0.0688 - acc: 0.9844
 320/1283 [======>.......................] - ETA: 0s - loss: 0.0710 - acc: 0.9812
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0714 - acc: 0.9821
 512/1283 [==========>...................] - ETA: 0s - loss: 0.0746 - acc: 0.9785
 640/1283 [=============>................] - ETA: 0s - loss: 0.0757 - acc: 0.9719
 768/1283 [================>.............] - ETA: 0s - loss: 0.0737 - acc: 0.9727
 896/1283 [===================>..........] - ETA: 0s - loss: 0.0774 - acc: 0.9721
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0712 - acc: 0.9746
1152/1283 [=========================>....] - ETA: 0s - loss: 0.0726 - acc: 0.9731
1280/1283 [============================>.] - ETA: 0s - loss: 0.0716 - acc: 0.9734
1283/1283 [==============================] - 1s 616us/step - loss: 0.0715 - acc: 0.9735 - val_loss: 1.7368 - val_acc: 0.5939

Epoch 00017: val_acc improved from 0.58515 to 0.59389, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_2_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_2_ml_20.ckpt
Epoch 18/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0300 - acc: 1.0000
 192/1283 [===>..........................] - ETA: 0s - loss: 0.0416 - acc: 0.9896
 320/1283 [======>.......................] - ETA: 0s - loss: 0.0550 - acc: 0.9844
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0519 - acc: 0.9821
 576/1283 [============>.................] - ETA: 0s - loss: 0.0521 - acc: 0.9826
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0536 - acc: 0.9815
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0546 - acc: 0.9820
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0548 - acc: 0.9812
1152/1283 [=========================>....] - ETA: 0s - loss: 0.0521 - acc: 0.9844
1280/1283 [============================>.] - ETA: 0s - loss: 0.0501 - acc: 0.9859
1283/1283 [==============================] - 1s 530us/step - loss: 0.0501 - acc: 0.9860 - val_loss: 1.7398 - val_acc: 0.5808

Epoch 00018: val_acc did not improve
Epoch 19/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0353 - acc: 1.0000
 192/1283 [===>..........................] - ETA: 0s - loss: 0.0479 - acc: 0.9844
 320/1283 [======>.......................] - ETA: 0s - loss: 0.0466 - acc: 0.9875
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0504 - acc: 0.9821
 576/1283 [============>.................] - ETA: 0s - loss: 0.0554 - acc: 0.9792
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0552 - acc: 0.9787
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0538 - acc: 0.9796
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0535 - acc: 0.9792
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0514 - acc: 0.9816
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0511 - acc: 0.9819
1283/1283 [==============================] - 1s 570us/step - loss: 0.0494 - acc: 0.9829 - val_loss: 1.9159 - val_acc: 0.5764

Epoch 00019: val_acc did not improve
Epoch 20/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0280 - acc: 1.0000
 192/1283 [===>..........................] - ETA: 0s - loss: 0.0540 - acc: 0.9844
 320/1283 [======>.......................] - ETA: 0s - loss: 0.0561 - acc: 0.9844
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0472 - acc: 0.9866
 576/1283 [============>.................] - ETA: 0s - loss: 0.0482 - acc: 0.9861
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0557 - acc: 0.9815
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0507 - acc: 0.9844
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0467 - acc: 0.9865
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0455 - acc: 0.9862
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0486 - acc: 0.9844
1283/1283 [==============================] - 1s 602us/step - loss: 0.0484 - acc: 0.9844 - val_loss: 1.8624 - val_acc: 0.5633

Epoch 00020: val_acc did not improve
Epoch 21/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0511 - acc: 0.9688
 192/1283 [===>..........................] - ETA: 0s - loss: 0.0465 - acc: 0.9688
 320/1283 [======>.......................] - ETA: 0s - loss: 0.0500 - acc: 0.9750
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0543 - acc: 0.9777
 512/1283 [==========>...................] - ETA: 0s - loss: 0.0702 - acc: 0.9746
 640/1283 [=============>................] - ETA: 0s - loss: 0.0659 - acc: 0.9766
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0608 - acc: 0.9796
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0579 - acc: 0.9802
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0559 - acc: 0.9816
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0536 - acc: 0.9819
1283/1283 [==============================] - 1s 586us/step - loss: 0.0532 - acc: 0.9821 - val_loss: 2.1651 - val_acc: 0.5852

Epoch 00021: val_acc did not improve
Epoch 22/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0558 - acc: 0.9844
 192/1283 [===>..........................] - ETA: 0s - loss: 0.0724 - acc: 0.9635
 320/1283 [======>.......................] - ETA: 0s - loss: 0.0605 - acc: 0.9688
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0640 - acc: 0.9688
 576/1283 [============>.................] - ETA: 0s - loss: 0.0697 - acc: 0.9653
 768/1283 [================>.............] - ETA: 0s - loss: 0.0719 - acc: 0.9674
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0656 - acc: 0.9719
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0624 - acc: 0.9743
1280/1283 [============================>.] - ETA: 0s - loss: 0.0603 - acc: 0.9766
1283/1283 [==============================] - 1s 457us/step - loss: 0.0621 - acc: 0.9751 - val_loss: 2.0841 - val_acc: 0.5721

Epoch 00022: val_acc did not improve
Epoch 23/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0281 - acc: 0.9844
 192/1283 [===>..........................] - ETA: 0s - loss: 0.1128 - acc: 0.9531
 384/1283 [=======>......................] - ETA: 0s - loss: 0.1356 - acc: 0.9479
 512/1283 [==========>...................] - ETA: 0s - loss: 0.1402 - acc: 0.9414
 576/1283 [============>.................] - ETA: 0s - loss: 0.1543 - acc: 0.9340
 704/1283 [===============>..............] - ETA: 0s - loss: 0.1461 - acc: 0.9375
 896/1283 [===================>..........] - ETA: 0s - loss: 0.1468 - acc: 0.9408
 960/1283 [=====================>........] - ETA: 0s - loss: 0.1516 - acc: 0.9417
1024/1283 [======================>.......] - ETA: 0s - loss: 0.1545 - acc: 0.9385
1216/1283 [===========================>..] - ETA: 0s - loss: 0.1601 - acc: 0.9350
1283/1283 [==============================] - 1s 563us/step - loss: 0.1560 - acc: 0.9369 - val_loss: 1.9027 - val_acc: 0.5764

Epoch 00023: val_acc did not improve
Epoch 24/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0575 - acc: 0.9844
 192/1283 [===>..........................] - ETA: 0s - loss: 0.0718 - acc: 0.9792
 384/1283 [=======>......................] - ETA: 0s - loss: 0.1085 - acc: 0.9688
 576/1283 [============>.................] - ETA: 0s - loss: 0.1064 - acc: 0.9670
 768/1283 [================>.............] - ETA: 0s - loss: 0.0995 - acc: 0.9688
 896/1283 [===================>..........] - ETA: 0s - loss: 0.0937 - acc: 0.9699
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0881 - acc: 0.9717
1152/1283 [=========================>....] - ETA: 0s - loss: 0.0844 - acc: 0.9748
1283/1283 [==============================] - 1s 436us/step - loss: 0.0828 - acc: 0.9751 - val_loss: 1.7533 - val_acc: 0.5502

Epoch 00024: val_acc did not improve
Epoch 25/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0549 - acc: 0.9844
 256/1283 [====>.........................] - ETA: 0s - loss: 0.0718 - acc: 0.9805
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0793 - acc: 0.9754
 512/1283 [==========>...................] - ETA: 0s - loss: 0.0818 - acc: 0.9727
 640/1283 [=============>................] - ETA: 0s - loss: 0.0877 - acc: 0.9641
 768/1283 [================>.............] - ETA: 0s - loss: 0.0803 - acc: 0.9688
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0751 - acc: 0.9708
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0786 - acc: 0.9697
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0820 - acc: 0.9696
1283/1283 [==============================] - 1s 478us/step - loss: 0.0834 - acc: 0.9688 - val_loss: 1.8544 - val_acc: 0.5546

Epoch 00025: val_acc did not improve
Epoch 26/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0189 - acc: 1.0000
 256/1283 [====>.........................] - ETA: 0s - loss: 0.0287 - acc: 0.9922
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0339 - acc: 0.9933
 640/1283 [=============>................] - ETA: 0s - loss: 0.0363 - acc: 0.9922
 768/1283 [================>.............] - ETA: 0s - loss: 0.0388 - acc: 0.9883
 896/1283 [===================>..........] - ETA: 0s - loss: 0.0425 - acc: 0.9844
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0423 - acc: 0.9844
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0424 - acc: 0.9852
1283/1283 [==============================] - 1s 457us/step - loss: 0.0433 - acc: 0.9852 - val_loss: 2.1119 - val_acc: 0.5721

Epoch 00026: val_acc did not improve
Epoch 27/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0841 - acc: 0.9688
 192/1283 [===>..........................] - ETA: 0s - loss: 0.1654 - acc: 0.9271
 384/1283 [=======>......................] - ETA: 0s - loss: 0.1502 - acc: 0.9219
 512/1283 [==========>...................] - ETA: 0s - loss: 0.1637 - acc: 0.9258
 704/1283 [===============>..............] - ETA: 0s - loss: 0.1604 - acc: 0.9332
 896/1283 [===================>..........] - ETA: 0s - loss: 0.1498 - acc: 0.9408
1024/1283 [======================>.......] - ETA: 0s - loss: 0.1501 - acc: 0.9414
1216/1283 [===========================>..] - ETA: 0s - loss: 0.1464 - acc: 0.9416
1283/1283 [==============================] - 1s 439us/step - loss: 0.1468 - acc: 0.9408 - val_loss: 2.1417 - val_acc: 0.5852

Epoch 00027: val_acc did not improve
Epoch 00027: early stopping
batch_size=64
batch_norm=False
dropout_rate=0.2
n_layers=2
max_len=20
nodes=100
mode=A
PCA audio=30
PCA visual=25
PCA text=100
accuracy=0.5043731778425656
best_valid_accuracy=0.5306122448979592
/afs/inf.ed.ac.uk/user/s17/s1738075/.local/lib/python2.7/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
pca_early_fusion_cnn.py:146: RuntimeWarning: invalid value encountered in divide
  train_set_audio = train_set_audio / audio_max
pca_early_fusion_cnn.py:148: RuntimeWarning: invalid value encountered in divide
  test_set_audio = test_set_audio / audio_max
2018-03-28 22:23:27.362004: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
This API will be deprecated in the future versions. Please check the Github page for the current API

Modality facet for video 8qrpnFRGt2A segment 13 is (partially) missing and is thus being replaced by zeros!

Train on 1283 samples, validate on 229 samples
Epoch 1/100

  64/1283 [>.............................] - ETA: 9s - loss: 0.7093 - acc: 0.4844
 192/1283 [===>..........................] - ETA: 3s - loss: 0.7218 - acc: 0.5000
 320/1283 [======>.......................] - ETA: 2s - loss: 0.7178 - acc: 0.5125
 448/1283 [=========>....................] - ETA: 1s - loss: 0.7197 - acc: 0.5112
 576/1283 [============>.................] - ETA: 1s - loss: 0.7151 - acc: 0.5226
 704/1283 [===============>..............] - ETA: 0s - loss: 0.7111 - acc: 0.5312
 768/1283 [================>.............] - ETA: 0s - loss: 0.7075 - acc: 0.5352
 896/1283 [===================>..........] - ETA: 0s - loss: 0.7076 - acc: 0.5234
1024/1283 [======================>.......] - ETA: 0s - loss: 0.7031 - acc: 0.5322
1152/1283 [=========================>....] - ETA: 0s - loss: 0.7036 - acc: 0.5330
1280/1283 [============================>.] - ETA: 0s - loss: 0.7017 - acc: 0.5391
1283/1283 [==============================] - 1s 1ms/step - loss: 0.7018 - acc: 0.5386 - val_loss: 0.6988 - val_acc: 0.4891

Epoch 00001: val_acc improved from -inf to 0.48908, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_2_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_2_ml_20.ckpt
Epoch 2/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5971 - acc: 0.7656
 192/1283 [===>..........................] - ETA: 0s - loss: 0.6178 - acc: 0.7083
 320/1283 [======>.......................] - ETA: 0s - loss: 0.6288 - acc: 0.6750
 448/1283 [=========>....................] - ETA: 0s - loss: 0.6298 - acc: 0.6696
 576/1283 [============>.................] - ETA: 0s - loss: 0.6317 - acc: 0.6597
 704/1283 [===============>..............] - ETA: 0s - loss: 0.6370 - acc: 0.6520
 832/1283 [==================>...........] - ETA: 0s - loss: 0.6310 - acc: 0.6611
 960/1283 [=====================>........] - ETA: 0s - loss: 0.6303 - acc: 0.6635
1088/1283 [========================>.....] - ETA: 0s - loss: 0.6297 - acc: 0.6654
1216/1283 [===========================>..] - ETA: 0s - loss: 0.6294 - acc: 0.6645
1283/1283 [==============================] - 1s 533us/step - loss: 0.6291 - acc: 0.6633 - val_loss: 0.6921 - val_acc: 0.5590

Epoch 00002: val_acc improved from 0.48908 to 0.55895, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_2_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_2_ml_20.ckpt
Epoch 3/100

  64/1283 [>.............................] - ETA: 1s - loss: 0.5716 - acc: 0.7344
 192/1283 [===>..........................] - ETA: 0s - loss: 0.5596 - acc: 0.7396
 320/1283 [======>.......................] - ETA: 0s - loss: 0.5552 - acc: 0.7688
 448/1283 [=========>....................] - ETA: 0s - loss: 0.5548 - acc: 0.7589
 576/1283 [============>.................] - ETA: 0s - loss: 0.5594 - acc: 0.7396
 768/1283 [================>.............] - ETA: 0s - loss: 0.5658 - acc: 0.7240
 960/1283 [=====================>........] - ETA: 0s - loss: 0.5701 - acc: 0.7156
1152/1283 [=========================>....] - ETA: 0s - loss: 0.5710 - acc: 0.7144
1280/1283 [============================>.] - ETA: 0s - loss: 0.5703 - acc: 0.7148
1283/1283 [==============================] - 1s 560us/step - loss: 0.5699 - acc: 0.7155 - val_loss: 0.7151 - val_acc: 0.5546

Epoch 00003: val_acc did not improve
Epoch 4/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5392 - acc: 0.7344
 192/1283 [===>..........................] - ETA: 0s - loss: 0.4957 - acc: 0.7917
 256/1283 [====>.........................] - ETA: 0s - loss: 0.4955 - acc: 0.8008
 384/1283 [=======>......................] - ETA: 0s - loss: 0.4944 - acc: 0.7943
 576/1283 [============>.................] - ETA: 0s - loss: 0.4973 - acc: 0.7865
 768/1283 [================>.............] - ETA: 0s - loss: 0.4862 - acc: 0.7956
 896/1283 [===================>..........] - ETA: 0s - loss: 0.4908 - acc: 0.7868
1024/1283 [======================>.......] - ETA: 0s - loss: 0.4926 - acc: 0.7783
1216/1283 [===========================>..] - ETA: 0s - loss: 0.4910 - acc: 0.7771
1283/1283 [==============================] - 1s 517us/step - loss: 0.4912 - acc: 0.7771 - val_loss: 0.8148 - val_acc: 0.5764

Epoch 00004: val_acc improved from 0.55895 to 0.57642, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_2_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_2_ml_20.ckpt
Epoch 5/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.4714 - acc: 0.7969
 192/1283 [===>..........................] - ETA: 0s - loss: 0.4095 - acc: 0.8333
 320/1283 [======>.......................] - ETA: 0s - loss: 0.4206 - acc: 0.8156
 448/1283 [=========>....................] - ETA: 0s - loss: 0.4153 - acc: 0.8237
 576/1283 [============>.................] - ETA: 0s - loss: 0.4256 - acc: 0.8194
 768/1283 [================>.............] - ETA: 0s - loss: 0.4195 - acc: 0.8242
 896/1283 [===================>..........] - ETA: 0s - loss: 0.4165 - acc: 0.8225
1024/1283 [======================>.......] - ETA: 0s - loss: 0.4111 - acc: 0.8281
1216/1283 [===========================>..] - ETA: 0s - loss: 0.4078 - acc: 0.8265
1283/1283 [==============================] - 1s 480us/step - loss: 0.4075 - acc: 0.8262 - val_loss: 0.7720 - val_acc: 0.5371

Epoch 00005: val_acc did not improve
Epoch 6/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.3500 - acc: 0.8438
 128/1283 [=>............................] - ETA: 0s - loss: 0.3349 - acc: 0.8594
 256/1283 [====>.........................] - ETA: 0s - loss: 0.3430 - acc: 0.8672
 448/1283 [=========>....................] - ETA: 0s - loss: 0.3493 - acc: 0.8594
 640/1283 [=============>................] - ETA: 0s - loss: 0.3445 - acc: 0.8562
 704/1283 [===============>..............] - ETA: 0s - loss: 0.3485 - acc: 0.8509
 832/1283 [==================>...........] - ETA: 0s - loss: 0.3483 - acc: 0.8534
 960/1283 [=====================>........] - ETA: 0s - loss: 0.3402 - acc: 0.8594
1024/1283 [======================>.......] - ETA: 0s - loss: 0.3362 - acc: 0.8643
1152/1283 [=========================>....] - ETA: 0s - loss: 0.3346 - acc: 0.8672
1280/1283 [============================>.] - ETA: 0s - loss: 0.3299 - acc: 0.8711
1283/1283 [==============================] - 1s 662us/step - loss: 0.3300 - acc: 0.8706 - val_loss: 0.8089 - val_acc: 0.5328

Epoch 00006: val_acc did not improve
Epoch 7/100

  64/1283 [>.............................] - ETA: 1s - loss: 0.2666 - acc: 0.9219
 192/1283 [===>..........................] - ETA: 0s - loss: 0.2504 - acc: 0.9479
 320/1283 [======>.......................] - ETA: 0s - loss: 0.2368 - acc: 0.9469
 448/1283 [=========>....................] - ETA: 0s - loss: 0.2517 - acc: 0.9263
 576/1283 [============>.................] - ETA: 0s - loss: 0.2470 - acc: 0.9236
 704/1283 [===============>..............] - ETA: 0s - loss: 0.2485 - acc: 0.9205
 832/1283 [==================>...........] - ETA: 0s - loss: 0.2493 - acc: 0.9243
 960/1283 [=====================>........] - ETA: 0s - loss: 0.2466 - acc: 0.9260
1088/1283 [========================>.....] - ETA: 0s - loss: 0.2485 - acc: 0.9237
1216/1283 [===========================>..] - ETA: 0s - loss: 0.2489 - acc: 0.9227
1283/1283 [==============================] - 1s 643us/step - loss: 0.2501 - acc: 0.9182 - val_loss: 0.9748 - val_acc: 0.5328

Epoch 00007: val_acc did not improve
Epoch 8/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.2314 - acc: 0.8906
 192/1283 [===>..........................] - ETA: 0s - loss: 0.1944 - acc: 0.9323
 320/1283 [======>.......................] - ETA: 0s - loss: 0.1900 - acc: 0.9375
 448/1283 [=========>....................] - ETA: 0s - loss: 0.1867 - acc: 0.9442
 576/1283 [============>.................] - ETA: 0s - loss: 0.1760 - acc: 0.9497
 704/1283 [===============>..............] - ETA: 0s - loss: 0.1718 - acc: 0.9517
 832/1283 [==================>...........] - ETA: 0s - loss: 0.1720 - acc: 0.9495
 896/1283 [===================>..........] - ETA: 0s - loss: 0.1741 - acc: 0.9464
1024/1283 [======================>.......] - ETA: 0s - loss: 0.1731 - acc: 0.9482
1152/1283 [=========================>....] - ETA: 0s - loss: 0.1767 - acc: 0.9453
1280/1283 [============================>.] - ETA: 0s - loss: 0.1788 - acc: 0.9453
1283/1283 [==============================] - 1s 607us/step - loss: 0.1785 - acc: 0.9454 - val_loss: 0.9684 - val_acc: 0.5677

Epoch 00008: val_acc did not improve
Epoch 9/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1249 - acc: 0.9531
 256/1283 [====>.........................] - ETA: 0s - loss: 0.1226 - acc: 0.9688
 320/1283 [======>.......................] - ETA: 0s - loss: 0.1216 - acc: 0.9625
 448/1283 [=========>....................] - ETA: 0s - loss: 0.1263 - acc: 0.9621
 576/1283 [============>.................] - ETA: 0s - loss: 0.1245 - acc: 0.9653
 704/1283 [===============>..............] - ETA: 0s - loss: 0.1268 - acc: 0.9645
 832/1283 [==================>...........] - ETA: 0s - loss: 0.1285 - acc: 0.9615
 960/1283 [=====================>........] - ETA: 0s - loss: 0.1245 - acc: 0.9656
1088/1283 [========================>.....] - ETA: 0s - loss: 0.1240 - acc: 0.9669
1216/1283 [===========================>..] - ETA: 0s - loss: 0.1216 - acc: 0.9688
1283/1283 [==============================] - 1s 559us/step - loss: 0.1212 - acc: 0.9680 - val_loss: 1.1550 - val_acc: 0.5633

Epoch 00009: val_acc did not improve
Epoch 10/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1430 - acc: 0.9375
 256/1283 [====>.........................] - ETA: 0s - loss: 0.1085 - acc: 0.9570
 384/1283 [=======>......................] - ETA: 0s - loss: 0.1036 - acc: 0.9661
 512/1283 [==========>...................] - ETA: 0s - loss: 0.1006 - acc: 0.9668
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0972 - acc: 0.9702
 896/1283 [===================>..........] - ETA: 0s - loss: 0.0972 - acc: 0.9732
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0961 - acc: 0.9733
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0970 - acc: 0.9712
1283/1283 [==============================] - 1s 459us/step - loss: 0.0962 - acc: 0.9719 - val_loss: 1.2370 - val_acc: 0.5721

Epoch 00010: val_acc did not improve
Epoch 11/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0853 - acc: 0.9531
 256/1283 [====>.........................] - ETA: 0s - loss: 0.0674 - acc: 0.9766
 384/1283 [=======>......................] - ETA: 0s - loss: 0.0756 - acc: 0.9740
 512/1283 [==========>...................] - ETA: 0s - loss: 0.0826 - acc: 0.9746
 640/1283 [=============>................] - ETA: 0s - loss: 0.0841 - acc: 0.9703
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0828 - acc: 0.9730
 768/1283 [================>.............] - ETA: 0s - loss: 0.0863 - acc: 0.9701
 896/1283 [===================>..........] - ETA: 0s - loss: 0.0913 - acc: 0.9688
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0897 - acc: 0.9697
1216/1283 [===========================>..] - ETA: 0s - loss: 0.1005 - acc: 0.9638
1283/1283 [==============================] - 1s 568us/step - loss: 0.1066 - acc: 0.9595 - val_loss: 1.3794 - val_acc: 0.5415

Epoch 00011: val_acc did not improve
Epoch 12/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0558 - acc: 1.0000
 128/1283 [=>............................] - ETA: 0s - loss: 0.1217 - acc: 0.9531
 192/1283 [===>..........................] - ETA: 0s - loss: 0.1442 - acc: 0.9479
 256/1283 [====>.........................] - ETA: 0s - loss: 0.1375 - acc: 0.9453
 384/1283 [=======>......................] - ETA: 0s - loss: 0.1381 - acc: 0.9505
 512/1283 [==========>...................] - ETA: 0s - loss: 0.1359 - acc: 0.9473
 576/1283 [============>.................] - ETA: 0s - loss: 0.1292 - acc: 0.9514
 704/1283 [===============>..............] - ETA: 0s - loss: 0.1306 - acc: 0.9503
 832/1283 [==================>...........] - ETA: 0s - loss: 0.1296 - acc: 0.9507
 896/1283 [===================>..........] - ETA: 0s - loss: 0.1268 - acc: 0.9520
1088/1283 [========================>.....] - ETA: 0s - loss: 0.1309 - acc: 0.9540
1216/1283 [===========================>..] - ETA: 0s - loss: 0.1277 - acc: 0.9556
1283/1283 [==============================] - 1s 675us/step - loss: 0.1273 - acc: 0.9556 - val_loss: 1.5568 - val_acc: 0.5022

Epoch 00012: val_acc did not improve
Epoch 13/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1007 - acc: 0.9688
 192/1283 [===>..........................] - ETA: 0s - loss: 0.0900 - acc: 0.9844
 320/1283 [======>.......................] - ETA: 0s - loss: 0.0793 - acc: 0.9875
 512/1283 [==========>...................] - ETA: 0s - loss: 0.0744 - acc: 0.9883
 640/1283 [=============>................] - ETA: 0s - loss: 0.0743 - acc: 0.9844
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0712 - acc: 0.9856
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0705 - acc: 0.9854
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0693 - acc: 0.9854
1152/1283 [=========================>....] - ETA: 0s - loss: 0.0667 - acc: 0.9852
1280/1283 [============================>.] - ETA: 0s - loss: 0.0670 - acc: 0.9852
1283/1283 [==============================] - 1s 525us/step - loss: 0.0672 - acc: 0.9852 - val_loss: 1.7533 - val_acc: 0.5502

Epoch 00013: val_acc did not improve
Epoch 14/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0508 - acc: 1.0000
 256/1283 [====>.........................] - ETA: 0s - loss: 0.0651 - acc: 0.9844
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0612 - acc: 0.9821
 576/1283 [============>.................] - ETA: 0s - loss: 0.0596 - acc: 0.9844
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0674 - acc: 0.9801
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0681 - acc: 0.9796
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0670 - acc: 0.9802
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0716 - acc: 0.9770
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0703 - acc: 0.9762
1283/1283 [==============================] - 1s 480us/step - loss: 0.0704 - acc: 0.9758 - val_loss: 1.6123 - val_acc: 0.5590

Epoch 00014: val_acc did not improve
Epoch 00014: early stopping
batch_size=64
batch_norm=False
dropout_rate=0.2
n_layers=2
max_len=20
nodes=100
mode=A
PCA audio=30
PCA visual=30
PCA text=100
accuracy=0.5204081632653061
best_valid_accuracy=0.44752186588921283
/afs/inf.ed.ac.uk/user/s17/s1738075/.local/lib/python2.7/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
pca_early_fusion_cnn.py:146: RuntimeWarning: invalid value encountered in divide
  train_set_audio = train_set_audio / audio_max
pca_early_fusion_cnn.py:148: RuntimeWarning: invalid value encountered in divide
  test_set_audio = test_set_audio / audio_max
2018-03-28 22:44:42.844231: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
This API will be deprecated in the future versions. Please check the Github page for the current API

Modality facet for video 8qrpnFRGt2A segment 13 is (partially) missing and is thus being replaced by zeros!

Train on 1283 samples, validate on 229 samples
Epoch 1/100

  64/1283 [>.............................] - ETA: 2s - loss: 0.7121 - acc: 0.5625
 320/1283 [======>.......................] - ETA: 0s - loss: 0.7639 - acc: 0.5219
 448/1283 [=========>....................] - ETA: 0s - loss: 0.7539 - acc: 0.5223
 640/1283 [=============>................] - ETA: 0s - loss: 0.7411 - acc: 0.5359
 960/1283 [=====================>........] - ETA: 0s - loss: 0.7250 - acc: 0.5375
1152/1283 [=========================>....] - ETA: 0s - loss: 0.7171 - acc: 0.5503
1280/1283 [============================>.] - ETA: 0s - loss: 0.7165 - acc: 0.5469
1283/1283 [==============================] - 1s 451us/step - loss: 0.7163 - acc: 0.5472 - val_loss: 0.6949 - val_acc: 0.5502

Epoch 00001: val_acc improved from -inf to 0.55022, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_2_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_2_ml_20.ckpt
Epoch 2/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.6182 - acc: 0.7031
 256/1283 [====>.........................] - ETA: 0s - loss: 0.6062 - acc: 0.6914
 384/1283 [=======>......................] - ETA: 0s - loss: 0.6136 - acc: 0.6771
 512/1283 [==========>...................] - ETA: 0s - loss: 0.6093 - acc: 0.6797
 640/1283 [=============>................] - ETA: 0s - loss: 0.6065 - acc: 0.6828
 768/1283 [================>.............] - ETA: 0s - loss: 0.6043 - acc: 0.6849
 896/1283 [===================>..........] - ETA: 0s - loss: 0.6081 - acc: 0.6786
1024/1283 [======================>.......] - ETA: 0s - loss: 0.6136 - acc: 0.6738
1152/1283 [=========================>....] - ETA: 0s - loss: 0.6114 - acc: 0.6788
1280/1283 [============================>.] - ETA: 0s - loss: 0.6133 - acc: 0.6742
1283/1283 [==============================] - 1s 493us/step - loss: 0.6139 - acc: 0.6734 - val_loss: 0.6969 - val_acc: 0.5415

Epoch 00002: val_acc did not improve
Epoch 3/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5738 - acc: 0.7031
 256/1283 [====>.........................] - ETA: 0s - loss: 0.5667 - acc: 0.7188
 384/1283 [=======>......................] - ETA: 0s - loss: 0.5609 - acc: 0.7292
 512/1283 [==========>...................] - ETA: 0s - loss: 0.5554 - acc: 0.7461
 640/1283 [=============>................] - ETA: 0s - loss: 0.5466 - acc: 0.7656
 768/1283 [================>.............] - ETA: 0s - loss: 0.5453 - acc: 0.7643
 960/1283 [=====================>........] - ETA: 0s - loss: 0.5508 - acc: 0.7510
1088/1283 [========================>.....] - ETA: 0s - loss: 0.5485 - acc: 0.7472
1283/1283 [==============================] - 1s 416us/step - loss: 0.5464 - acc: 0.7459 - val_loss: 0.7139 - val_acc: 0.5721

Epoch 00003: val_acc improved from 0.55022 to 0.57205, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_2_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_2_ml_20.ckpt
Epoch 4/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.4634 - acc: 0.8281
 320/1283 [======>.......................] - ETA: 0s - loss: 0.4581 - acc: 0.8094
 512/1283 [==========>...................] - ETA: 0s - loss: 0.4580 - acc: 0.8164
 640/1283 [=============>................] - ETA: 0s - loss: 0.4624 - acc: 0.8109
 832/1283 [==================>...........] - ETA: 0s - loss: 0.4738 - acc: 0.7969
1024/1283 [======================>.......] - ETA: 0s - loss: 0.4740 - acc: 0.7910
1216/1283 [===========================>..] - ETA: 0s - loss: 0.4752 - acc: 0.7812
1283/1283 [==============================] - 0s 387us/step - loss: 0.4727 - acc: 0.7825 - val_loss: 0.7795 - val_acc: 0.5415

Epoch 00004: val_acc did not improve
Epoch 5/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.4628 - acc: 0.7969
 256/1283 [====>.........................] - ETA: 0s - loss: 0.4250 - acc: 0.8242
 384/1283 [=======>......................] - ETA: 0s - loss: 0.4195 - acc: 0.8151
 512/1283 [==========>...................] - ETA: 0s - loss: 0.4032 - acc: 0.8301
 704/1283 [===============>..............] - ETA: 0s - loss: 0.3963 - acc: 0.8395
 832/1283 [==================>...........] - ETA: 0s - loss: 0.3972 - acc: 0.8401
 960/1283 [=====================>........] - ETA: 0s - loss: 0.3872 - acc: 0.8427
1152/1283 [=========================>....] - ETA: 0s - loss: 0.3835 - acc: 0.8394
1283/1283 [==============================] - 1s 444us/step - loss: 0.3855 - acc: 0.8348 - val_loss: 0.8105 - val_acc: 0.5415

Epoch 00005: val_acc did not improve
Epoch 6/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.2944 - acc: 0.8906
 192/1283 [===>..........................] - ETA: 0s - loss: 0.3013 - acc: 0.8906
 320/1283 [======>.......................] - ETA: 0s - loss: 0.3182 - acc: 0.8812
 512/1283 [==========>...................] - ETA: 0s - loss: 0.3194 - acc: 0.8691
 640/1283 [=============>................] - ETA: 0s - loss: 0.3164 - acc: 0.8719
 768/1283 [================>.............] - ETA: 0s - loss: 0.3112 - acc: 0.8828
 896/1283 [===================>..........] - ETA: 0s - loss: 0.3105 - acc: 0.8828
1024/1283 [======================>.......] - ETA: 0s - loss: 0.3061 - acc: 0.8867
1152/1283 [=========================>....] - ETA: 0s - loss: 0.3093 - acc: 0.8828
1283/1283 [==============================] - 1s 485us/step - loss: 0.3125 - acc: 0.8815 - val_loss: 0.9633 - val_acc: 0.5808

Epoch 00006: val_acc improved from 0.57205 to 0.58079, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_2_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_2_ml_20.ckpt
Epoch 7/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.2445 - acc: 0.8906
 256/1283 [====>.........................] - ETA: 0s - loss: 0.2437 - acc: 0.9062
 448/1283 [=========>....................] - ETA: 0s - loss: 0.2482 - acc: 0.9062
 704/1283 [===============>..............] - ETA: 0s - loss: 0.2513 - acc: 0.9077
 960/1283 [=====================>........] - ETA: 0s - loss: 0.2452 - acc: 0.9104
1152/1283 [=========================>....] - ETA: 0s - loss: 0.2466 - acc: 0.9062
1280/1283 [============================>.] - ETA: 0s - loss: 0.2531 - acc: 0.9031
1283/1283 [==============================] - 0s 348us/step - loss: 0.2526 - acc: 0.9034 - val_loss: 0.9112 - val_acc: 0.5721

Epoch 00007: val_acc did not improve
Epoch 8/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.2048 - acc: 0.9219
 256/1283 [====>.........................] - ETA: 0s - loss: 0.1913 - acc: 0.9414
 448/1283 [=========>....................] - ETA: 0s - loss: 0.2097 - acc: 0.9196
 576/1283 [============>.................] - ETA: 0s - loss: 0.1992 - acc: 0.9288
 768/1283 [================>.............] - ETA: 0s - loss: 0.1983 - acc: 0.9336
 960/1283 [=====================>........] - ETA: 0s - loss: 0.1930 - acc: 0.9406
1152/1283 [=========================>....] - ETA: 0s - loss: 0.1879 - acc: 0.9392
1283/1283 [==============================] - 1s 439us/step - loss: 0.1884 - acc: 0.9400 - val_loss: 0.9917 - val_acc: 0.5633

Epoch 00008: val_acc did not improve
Epoch 9/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1190 - acc: 0.9688
 256/1283 [====>.........................] - ETA: 0s - loss: 0.1482 - acc: 0.9688
 384/1283 [=======>......................] - ETA: 0s - loss: 0.1542 - acc: 0.9635
 576/1283 [============>.................] - ETA: 0s - loss: 0.1513 - acc: 0.9635
 704/1283 [===============>..............] - ETA: 0s - loss: 0.1515 - acc: 0.9602
 896/1283 [===================>..........] - ETA: 0s - loss: 0.1545 - acc: 0.9565
1024/1283 [======================>.......] - ETA: 0s - loss: 0.1575 - acc: 0.9541
1216/1283 [===========================>..] - ETA: 0s - loss: 0.1627 - acc: 0.9482
1283/1283 [==============================] - 1s 446us/step - loss: 0.1603 - acc: 0.9493 - val_loss: 1.1153 - val_acc: 0.5590

Epoch 00009: val_acc did not improve
Epoch 10/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1517 - acc: 0.9531
 256/1283 [====>.........................] - ETA: 0s - loss: 0.1397 - acc: 0.9453
 384/1283 [=======>......................] - ETA: 0s - loss: 0.1381 - acc: 0.9479
 512/1283 [==========>...................] - ETA: 0s - loss: 0.1342 - acc: 0.9492
 640/1283 [=============>................] - ETA: 0s - loss: 0.1292 - acc: 0.9500
 768/1283 [================>.............] - ETA: 0s - loss: 0.1228 - acc: 0.9583
 896/1283 [===================>..........] - ETA: 0s - loss: 0.1217 - acc: 0.9609
1024/1283 [======================>.......] - ETA: 0s - loss: 0.1193 - acc: 0.9629
1152/1283 [=========================>....] - ETA: 0s - loss: 0.1181 - acc: 0.9661
1280/1283 [============================>.] - ETA: 0s - loss: 0.1171 - acc: 0.9664
1283/1283 [==============================] - 1s 624us/step - loss: 0.1175 - acc: 0.9665 - val_loss: 1.2603 - val_acc: 0.5808

Epoch 00010: val_acc did not improve
Epoch 11/100

  64/1283 [>.............................] - ETA: 1s - loss: 0.0908 - acc: 0.9844
 256/1283 [====>.........................] - ETA: 0s - loss: 0.1198 - acc: 0.9609
 384/1283 [=======>......................] - ETA: 0s - loss: 0.1137 - acc: 0.9531
 512/1283 [==========>...................] - ETA: 0s - loss: 0.1258 - acc: 0.9473
 576/1283 [============>.................] - ETA: 0s - loss: 0.1288 - acc: 0.9444
 640/1283 [=============>................] - ETA: 0s - loss: 0.1279 - acc: 0.9453
 768/1283 [================>.............] - ETA: 0s - loss: 0.1262 - acc: 0.9479
 960/1283 [=====================>........] - ETA: 0s - loss: 0.1225 - acc: 0.9500
1152/1283 [=========================>....] - ETA: 0s - loss: 0.1188 - acc: 0.9514
1280/1283 [============================>.] - ETA: 0s - loss: 0.1161 - acc: 0.9539
1283/1283 [==============================] - 1s 530us/step - loss: 0.1160 - acc: 0.9540 - val_loss: 1.2726 - val_acc: 0.5764

Epoch 00011: val_acc did not improve
Epoch 12/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0758 - acc: 0.9844
 192/1283 [===>..........................] - ETA: 0s - loss: 0.0789 - acc: 0.9740
 320/1283 [======>.......................] - ETA: 0s - loss: 0.0784 - acc: 0.9750
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0846 - acc: 0.9688
 576/1283 [============>.................] - ETA: 0s - loss: 0.0785 - acc: 0.9757
 768/1283 [================>.............] - ETA: 0s - loss: 0.0782 - acc: 0.9740
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0734 - acc: 0.9771
1152/1283 [=========================>....] - ETA: 0s - loss: 0.0694 - acc: 0.9800
1280/1283 [============================>.] - ETA: 0s - loss: 0.0715 - acc: 0.9773
1283/1283 [==============================] - 1s 444us/step - loss: 0.0716 - acc: 0.9774 - val_loss: 1.4028 - val_acc: 0.5852

Epoch 00012: val_acc improved from 0.58079 to 0.58515, saving model to classification_logs//cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_2_ml_20/saved_models/best_validation_cnn_early_fusion_m_A_ep_100_bs_64_bn_False_dr_0.2_nl_2_ml_20.ckpt
Epoch 13/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0471 - acc: 0.9844
 256/1283 [====>.........................] - ETA: 0s - loss: 0.0414 - acc: 0.9883
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0519 - acc: 0.9821
 576/1283 [============>.................] - ETA: 0s - loss: 0.0548 - acc: 0.9809
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0553 - acc: 0.9801
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0551 - acc: 0.9808
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0530 - acc: 0.9833
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0567 - acc: 0.9825
1283/1283 [==============================] - 1s 454us/step - loss: 0.0573 - acc: 0.9829 - val_loss: 1.4168 - val_acc: 0.5721

Epoch 00013: val_acc did not improve
Epoch 14/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0593 - acc: 0.9844
 256/1283 [====>.........................] - ETA: 0s - loss: 0.0521 - acc: 0.9922
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0508 - acc: 0.9933
 512/1283 [==========>...................] - ETA: 0s - loss: 0.0490 - acc: 0.9922
 640/1283 [=============>................] - ETA: 0s - loss: 0.0519 - acc: 0.9859
 768/1283 [================>.............] - ETA: 0s - loss: 0.0565 - acc: 0.9818
 896/1283 [===================>..........] - ETA: 0s - loss: 0.0542 - acc: 0.9844
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0528 - acc: 0.9854
1152/1283 [=========================>....] - ETA: 0s - loss: 0.0505 - acc: 0.9861
1283/1283 [==============================] - 1s 488us/step - loss: 0.0502 - acc: 0.9860 - val_loss: 1.6000 - val_acc: 0.5764

Epoch 00014: val_acc did not improve
Epoch 15/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0357 - acc: 1.0000
 192/1283 [===>..........................] - ETA: 0s - loss: 0.0358 - acc: 0.9948
 320/1283 [======>.......................] - ETA: 0s - loss: 0.0315 - acc: 0.9938
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0275 - acc: 0.9955
 576/1283 [============>.................] - ETA: 0s - loss: 0.0339 - acc: 0.9913
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0345 - acc: 0.9915
 896/1283 [===================>..........] - ETA: 0s - loss: 0.0363 - acc: 0.9900
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0351 - acc: 0.9902
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0341 - acc: 0.9901
1283/1283 [==============================] - 1s 450us/step - loss: 0.0338 - acc: 0.9906 - val_loss: 1.7134 - val_acc: 0.5546

Epoch 00015: val_acc did not improve
Epoch 16/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0346 - acc: 0.9844
 256/1283 [====>.........................] - ETA: 0s - loss: 0.0226 - acc: 0.9961
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0272 - acc: 0.9911
 576/1283 [============>.................] - ETA: 0s - loss: 0.0247 - acc: 0.9931
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0249 - acc: 0.9929
 896/1283 [===================>..........] - ETA: 0s - loss: 0.0244 - acc: 0.9933
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0278 - acc: 0.9908
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0282 - acc: 0.9910
1283/1283 [==============================] - 1s 392us/step - loss: 0.0289 - acc: 0.9906 - val_loss: 1.8332 - val_acc: 0.5721

Epoch 00016: val_acc did not improve
Epoch 17/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0363 - acc: 0.9844
 192/1283 [===>..........................] - ETA: 0s - loss: 0.0333 - acc: 0.9896
 384/1283 [=======>......................] - ETA: 0s - loss: 0.0237 - acc: 0.9948
 512/1283 [==========>...................] - ETA: 0s - loss: 0.0288 - acc: 0.9902
 640/1283 [=============>................] - ETA: 0s - loss: 0.0367 - acc: 0.9828
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0353 - acc: 0.9832
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0361 - acc: 0.9833
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0368 - acc: 0.9834
1152/1283 [=========================>....] - ETA: 0s - loss: 0.0372 - acc: 0.9826
1283/1283 [==============================] - 1s 534us/step - loss: 0.0369 - acc: 0.9829 - val_loss: 1.7284 - val_acc: 0.5546

Epoch 00017: val_acc did not improve
Epoch 18/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0094 - acc: 1.0000
 192/1283 [===>..........................] - ETA: 0s - loss: 0.0216 - acc: 0.9896
 256/1283 [====>.........................] - ETA: 0s - loss: 0.0195 - acc: 0.9922
 512/1283 [==========>...................] - ETA: 0s - loss: 0.0245 - acc: 0.9941
 640/1283 [=============>................] - ETA: 0s - loss: 0.0261 - acc: 0.9938
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0274 - acc: 0.9916
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0265 - acc: 0.9917
1152/1283 [=========================>....] - ETA: 0s - loss: 0.0267 - acc: 0.9913
1283/1283 [==============================] - 1s 420us/step - loss: 0.0264 - acc: 0.9914 - val_loss: 1.8207 - val_acc: 0.5677

Epoch 00018: val_acc did not improve
Epoch 19/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0117 - acc: 1.0000
 256/1283 [====>.........................] - ETA: 0s - loss: 0.0235 - acc: 0.9883
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0212 - acc: 0.9911
 768/1283 [================>.............] - ETA: 0s - loss: 0.0215 - acc: 0.9909
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0233 - acc: 0.9896
1152/1283 [=========================>....] - ETA: 0s - loss: 0.0216 - acc: 0.9913
1283/1283 [==============================] - 0s 323us/step - loss: 0.0221 - acc: 0.9906 - val_loss: 1.8716 - val_acc: 0.5677

Epoch 00019: val_acc did not improve
Epoch 20/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0099 - acc: 1.0000
 320/1283 [======>.......................] - ETA: 0s - loss: 0.0220 - acc: 0.9938
 512/1283 [==========>...................] - ETA: 0s - loss: 0.0211 - acc: 0.9961
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0200 - acc: 0.9957
 896/1283 [===================>..........] - ETA: 0s - loss: 0.0257 - acc: 0.9922
1152/1283 [=========================>....] - ETA: 0s - loss: 0.0288 - acc: 0.9896
1283/1283 [==============================] - 0s 312us/step - loss: 0.0280 - acc: 0.9891 - val_loss: 1.9489 - val_acc: 0.5415

Epoch 00020: val_acc did not improve
Epoch 21/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0049 - acc: 1.0000
 256/1283 [====>.........................] - ETA: 0s - loss: 0.0158 - acc: 1.0000
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0256 - acc: 0.9911
 640/1283 [=============>................] - ETA: 0s - loss: 0.0226 - acc: 0.9938
 896/1283 [===================>..........] - ETA: 0s - loss: 0.0226 - acc: 0.9922
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0210 - acc: 0.9926
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0232 - acc: 0.9910
1283/1283 [==============================] - 0s 315us/step - loss: 0.0224 - acc: 0.9914 - val_loss: 1.9905 - val_acc: 0.5502

Epoch 00021: val_acc did not improve
Epoch 22/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0074 - acc: 1.0000
 256/1283 [====>.........................] - ETA: 0s - loss: 0.0137 - acc: 1.0000
 384/1283 [=======>......................] - ETA: 0s - loss: 0.0161 - acc: 0.9948
 576/1283 [============>.................] - ETA: 0s - loss: 0.0158 - acc: 0.9948
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0146 - acc: 0.9943
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0180 - acc: 0.9927
1152/1283 [=========================>....] - ETA: 0s - loss: 0.0174 - acc: 0.9931
1280/1283 [============================>.] - ETA: 0s - loss: 0.0181 - acc: 0.9930
1283/1283 [==============================] - 1s 449us/step - loss: 0.0181 - acc: 0.9930 - val_loss: 1.9954 - val_acc: 0.5590

Epoch 00022: val_acc did not improve
Epoch 00022: early stopping
batch_size=64
batch_norm=False
dropout_rate=0.2
n_layers=2
max_len=20
nodes=100
mode=A
PCA audio=30
PCA visual=35
PCA text=100
accuracy=0.4620991253644315
best_valid_accuracy=0.4577259475218659
