/afs/inf.ed.ac.uk/user/s17/s1738075/.local/lib/python2.7/site-packages/pandas/core/nanops.py:39: UserWarning: The installed version of bottleneck 0.7.0 is not supported in pandas and will be not be used
The minimum supported version is 1.0.0

  ver=ver, min_ver=_MIN_BOTTLENECK_VERSION), UserWarning)
/afs/inf.ed.ac.uk/user/s17/s1738075/.local/lib/python2.7/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
pca_early_fusion_cnn.py:146: RuntimeWarning: invalid value encountered in divide
  train_set_audio = train_set_audio / audio_max
pca_early_fusion_cnn.py:148: RuntimeWarning: invalid value encountered in divide
  test_set_audio = test_set_audio / audio_max
2018-03-28 08:46:19.159819: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
This API will be deprecated in the future versions. Please check the Github page for the current API

Modality facet for video 8qrpnFRGt2A segment 13 is (partially) missing and is thus being replaced by zeros!

Train on 1283 samples, validate on 229 samples
Epoch 1/100

  64/1283 [>.............................] - ETA: 3s - loss: 0.7140 - acc: 0.5781
 320/1283 [======>.......................] - ETA: 0s - loss: 0.7277 - acc: 0.5594
 576/1283 [============>.................] - ETA: 0s - loss: 0.7199 - acc: 0.5382
 768/1283 [================>.............] - ETA: 0s - loss: 0.7130 - acc: 0.5430
1024/1283 [======================>.......] - ETA: 0s - loss: 0.7172 - acc: 0.5508
1216/1283 [===========================>..] - ETA: 0s - loss: 0.7138 - acc: 0.5559
1283/1283 [==============================] - 1s 411us/step - loss: 0.7184 - acc: 0.5542 - val_loss: 0.6561 - val_acc: 0.6288

Epoch 00001: val_acc improved from -inf to 0.62882, saving model to classification_logs//cnn_early_fusion_m_VT_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_15/saved_models/best_validation_cnn_early_fusion_m_VT_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_15.ckpt
Epoch 2/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.4858 - acc: 0.8281
 320/1283 [======>.......................] - ETA: 0s - loss: 0.5391 - acc: 0.6969
 512/1283 [==========>...................] - ETA: 0s - loss: 0.5290 - acc: 0.6973
 704/1283 [===============>..............] - ETA: 0s - loss: 0.5146 - acc: 0.7330
 960/1283 [=====================>........] - ETA: 0s - loss: 0.5180 - acc: 0.7344
1216/1283 [===========================>..] - ETA: 0s - loss: 0.5063 - acc: 0.7558
1283/1283 [==============================] - 0s 277us/step - loss: 0.5071 - acc: 0.7529 - val_loss: 0.6701 - val_acc: 0.6157

Epoch 00002: val_acc did not improve
Epoch 3/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.3986 - acc: 0.8594
 256/1283 [====>.........................] - ETA: 0s - loss: 0.3860 - acc: 0.8789
 448/1283 [=========>....................] - ETA: 0s - loss: 0.3814 - acc: 0.8795
 640/1283 [=============>................] - ETA: 0s - loss: 0.3861 - acc: 0.8672
 832/1283 [==================>...........] - ETA: 0s - loss: 0.3802 - acc: 0.8738
1024/1283 [======================>.......] - ETA: 0s - loss: 0.3755 - acc: 0.8672
1216/1283 [===========================>..] - ETA: 0s - loss: 0.3736 - acc: 0.8668
1283/1283 [==============================] - 0s 314us/step - loss: 0.3715 - acc: 0.8652 - val_loss: 0.6903 - val_acc: 0.6681

Epoch 00003: val_acc improved from 0.62882 to 0.66812, saving model to classification_logs//cnn_early_fusion_m_VT_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_15/saved_models/best_validation_cnn_early_fusion_m_VT_ep_100_bs_64_bn_False_dr_0.1_nl_1_ml_15.ckpt
Epoch 4/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.3269 - acc: 0.8906
 320/1283 [======>.......................] - ETA: 0s - loss: 0.3024 - acc: 0.9031
 576/1283 [============>.................] - ETA: 0s - loss: 0.2876 - acc: 0.9097
 768/1283 [================>.............] - ETA: 0s - loss: 0.2813 - acc: 0.9115
 960/1283 [=====================>........] - ETA: 0s - loss: 0.2878 - acc: 0.9062
1216/1283 [===========================>..] - ETA: 0s - loss: 0.2811 - acc: 0.9046
1283/1283 [==============================] - 0s 296us/step - loss: 0.2786 - acc: 0.9072 - val_loss: 0.7310 - val_acc: 0.6245

Epoch 00004: val_acc did not improve
Epoch 5/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.2124 - acc: 0.9688
 320/1283 [======>.......................] - ETA: 0s - loss: 0.2133 - acc: 0.9531
 512/1283 [==========>...................] - ETA: 0s - loss: 0.1965 - acc: 0.9648
 704/1283 [===============>..............] - ETA: 0s - loss: 0.2010 - acc: 0.9588
 896/1283 [===================>..........] - ETA: 0s - loss: 0.2010 - acc: 0.9542
1088/1283 [========================>.....] - ETA: 0s - loss: 0.1986 - acc: 0.9513
1283/1283 [==============================] - 0s 314us/step - loss: 0.1966 - acc: 0.9478 - val_loss: 0.7198 - val_acc: 0.6376

Epoch 00005: val_acc did not improve
Epoch 6/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1717 - acc: 0.9062
 256/1283 [====>.........................] - ETA: 0s - loss: 0.1642 - acc: 0.9531
 448/1283 [=========>....................] - ETA: 0s - loss: 0.1516 - acc: 0.9598
 704/1283 [===============>..............] - ETA: 0s - loss: 0.1492 - acc: 0.9588
 896/1283 [===================>..........] - ETA: 0s - loss: 0.1486 - acc: 0.9576
1088/1283 [========================>.....] - ETA: 0s - loss: 0.1462 - acc: 0.9596
1283/1283 [==============================] - 0s 298us/step - loss: 0.1423 - acc: 0.9618 - val_loss: 0.7717 - val_acc: 0.6245

Epoch 00006: val_acc did not improve
Epoch 7/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.1134 - acc: 0.9844
 256/1283 [====>.........................] - ETA: 0s - loss: 0.1120 - acc: 0.9727
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0986 - acc: 0.9799
 640/1283 [=============>................] - ETA: 0s - loss: 0.0995 - acc: 0.9828
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0954 - acc: 0.9832
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0931 - acc: 0.9844
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0945 - acc: 0.9835
1280/1283 [============================>.] - ETA: 0s - loss: 0.0913 - acc: 0.9852
1283/1283 [==============================] - 0s 371us/step - loss: 0.0913 - acc: 0.9852 - val_loss: 0.8618 - val_acc: 0.6245

Epoch 00007: val_acc did not improve
Epoch 8/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0517 - acc: 1.0000
 256/1283 [====>.........................] - ETA: 0s - loss: 0.0747 - acc: 0.9883
 384/1283 [=======>......................] - ETA: 0s - loss: 0.0747 - acc: 0.9870
 512/1283 [==========>...................] - ETA: 0s - loss: 0.0693 - acc: 0.9883
 640/1283 [=============>................] - ETA: 0s - loss: 0.0669 - acc: 0.9891
 768/1283 [================>.............] - ETA: 0s - loss: 0.0665 - acc: 0.9883
 960/1283 [=====================>........] - ETA: 0s - loss: 0.0694 - acc: 0.9865
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0686 - acc: 0.9844
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0676 - acc: 0.9852
1283/1283 [==============================] - 1s 510us/step - loss: 0.0656 - acc: 0.9860 - val_loss: 0.9012 - val_acc: 0.6201

Epoch 00008: val_acc did not improve
Epoch 9/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0340 - acc: 1.0000
 192/1283 [===>..........................] - ETA: 0s - loss: 0.0492 - acc: 0.9948
 320/1283 [======>.......................] - ETA: 0s - loss: 0.0475 - acc: 0.9938
 512/1283 [==========>...................] - ETA: 0s - loss: 0.0503 - acc: 0.9902
 640/1283 [=============>................] - ETA: 0s - loss: 0.0499 - acc: 0.9891
 768/1283 [================>.............] - ETA: 0s - loss: 0.0492 - acc: 0.9883
 896/1283 [===================>..........] - ETA: 0s - loss: 0.0498 - acc: 0.9877
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0501 - acc: 0.9863
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0474 - acc: 0.9877
1283/1283 [==============================] - 1s 496us/step - loss: 0.0476 - acc: 0.9875 - val_loss: 0.9838 - val_acc: 0.6332

Epoch 00009: val_acc did not improve
Epoch 10/100

  64/1283 [>.............................] - ETA: 1s - loss: 0.0260 - acc: 1.0000
 256/1283 [====>.........................] - ETA: 0s - loss: 0.0578 - acc: 0.9883
 384/1283 [=======>......................] - ETA: 0s - loss: 0.0537 - acc: 0.9896
 576/1283 [============>.................] - ETA: 0s - loss: 0.0483 - acc: 0.9896
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0451 - acc: 0.9901
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0497 - acc: 0.9892
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0490 - acc: 0.9902
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0509 - acc: 0.9893
1283/1283 [==============================] - 1s 476us/step - loss: 0.0519 - acc: 0.9891 - val_loss: 1.0608 - val_acc: 0.6288

Epoch 00010: val_acc did not improve
Epoch 11/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0439 - acc: 1.0000
 256/1283 [====>.........................] - ETA: 0s - loss: 0.0364 - acc: 0.9922
 384/1283 [=======>......................] - ETA: 0s - loss: 0.0393 - acc: 0.9922
 576/1283 [============>.................] - ETA: 0s - loss: 0.0353 - acc: 0.9948
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0363 - acc: 0.9929
 832/1283 [==================>...........] - ETA: 0s - loss: 0.0365 - acc: 0.9916
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0341 - acc: 0.9922
1152/1283 [=========================>....] - ETA: 0s - loss: 0.0341 - acc: 0.9922
1216/1283 [===========================>..] - ETA: 0s - loss: 0.0334 - acc: 0.9926
1283/1283 [==============================] - 1s 489us/step - loss: 0.0329 - acc: 0.9930 - val_loss: 1.1143 - val_acc: 0.6201

Epoch 00011: val_acc did not improve
Epoch 12/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0260 - acc: 0.9844
 128/1283 [=>............................] - ETA: 0s - loss: 0.0220 - acc: 0.9922
 256/1283 [====>.........................] - ETA: 0s - loss: 0.0238 - acc: 0.9961
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0231 - acc: 0.9955
 640/1283 [=============>................] - ETA: 0s - loss: 0.0199 - acc: 0.9969
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0213 - acc: 0.9957
 896/1283 [===================>..........] - ETA: 0s - loss: 0.0222 - acc: 0.9944
1024/1283 [======================>.......] - ETA: 0s - loss: 0.0229 - acc: 0.9941
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0237 - acc: 0.9936
1280/1283 [============================>.] - ETA: 0s - loss: 0.0229 - acc: 0.9945
1283/1283 [==============================] - 1s 522us/step - loss: 0.0228 - acc: 0.9945 - val_loss: 1.1500 - val_acc: 0.6245

Epoch 00012: val_acc did not improve
Epoch 13/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.0209 - acc: 0.9844
 128/1283 [=>............................] - ETA: 0s - loss: 0.0217 - acc: 0.9922
 320/1283 [======>.......................] - ETA: 0s - loss: 0.0163 - acc: 0.9969
 448/1283 [=========>....................] - ETA: 0s - loss: 0.0190 - acc: 0.9933
 576/1283 [============>.................] - ETA: 0s - loss: 0.0184 - acc: 0.9931
 704/1283 [===============>..............] - ETA: 0s - loss: 0.0175 - acc: 0.9943
 896/1283 [===================>..........] - ETA: 0s - loss: 0.0174 - acc: 0.9944
1088/1283 [========================>.....] - ETA: 0s - loss: 0.0179 - acc: 0.9945
1280/1283 [============================>.] - ETA: 0s - loss: 0.0178 - acc: 0.9953
1283/1283 [==============================] - 1s 415us/step - loss: 0.0177 - acc: 0.9953 - val_loss: 1.1843 - val_acc: 0.6419

Epoch 00013: val_acc did not improve
Epoch 00013: early stopping
batch_size=64
batch_norm=False
dropout_rate=0.1
n_layers=1
max_len=15
nodes=100
mode=VT
PCA audio=30
PCA visual=10
PCA text=100
accuracy=0.619533527696793
best_valid_accuracy=0.6457725947521866
