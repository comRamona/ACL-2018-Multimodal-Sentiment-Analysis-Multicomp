/afs/inf.ed.ac.uk/user/s17/s1738075/.local/lib/python2.7/site-packages/pandas/core/nanops.py:39: UserWarning: The installed version of bottleneck 0.7.0 is not supported in pandas and will be not be used
The minimum supported version is 1.0.0

  ver=ver, min_ver=_MIN_BOTTLENECK_VERSION), UserWarning)
/afs/inf.ed.ac.uk/user/s17/s1738075/.local/lib/python2.7/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
early_fusion_cnn.py:139: RuntimeWarning: invalid value encountered in divide
  train_set_audio = train_set_audio / audio_max
early_fusion_cnn.py:141: RuntimeWarning: invalid value encountered in divide
  test_set_audio = test_set_audio / audio_max
2018-03-20 23:20:36.547089: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
This API will be deprecated in the future versions. Please check the Github page for the current API

Modality facet for video 8qrpnFRGt2A segment 13 is (partially) missing and is thus being replaced by zeros!

Train on 1283 samples, validate on 229 samples
Epoch 1/100

  64/1283 [>.............................] - ETA: 3s - loss: 0.7006 - acc: 0.4688
 320/1283 [======>.......................] - ETA: 0s - loss: 0.6897 - acc: 0.5000
 576/1283 [============>.................] - ETA: 0s - loss: 0.7029 - acc: 0.5087
 768/1283 [================>.............] - ETA: 0s - loss: 0.6923 - acc: 0.5247
 960/1283 [=====================>........] - ETA: 0s - loss: 0.6918 - acc: 0.5260
1152/1283 [=========================>....] - ETA: 0s - loss: 0.6895 - acc: 0.5330
1283/1283 [==============================] - 1s 428us/step - loss: 0.6877 - acc: 0.5323 - val_loss: 0.7016 - val_acc: 0.5459

Epoch 00001: val_acc improved from -inf to 0.54585, saving model to classification_logs//cnn_early_fusion_m_V_ep_100_bs_64_bn_False_dr_0.2_nl_2_ml_25/saved_models/best_validation_cnn_early_fusion_m_V_ep_100_bs_64_bn_False_dr_0.2_nl_2_ml_25.ckpt
Epoch 2/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.6329 - acc: 0.6250
 256/1283 [====>.........................] - ETA: 0s - loss: 0.6761 - acc: 0.5664
 512/1283 [==========>...................] - ETA: 0s - loss: 0.6736 - acc: 0.5566
 768/1283 [================>.............] - ETA: 0s - loss: 0.6679 - acc: 0.5768
1024/1283 [======================>.......] - ETA: 0s - loss: 0.6705 - acc: 0.5703
1216/1283 [===========================>..] - ETA: 0s - loss: 0.6697 - acc: 0.5724
1283/1283 [==============================] - 0s 294us/step - loss: 0.6685 - acc: 0.5744 - val_loss: 0.6932 - val_acc: 0.5328

Epoch 00002: val_acc did not improve
Epoch 3/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.6473 - acc: 0.5938
 256/1283 [====>.........................] - ETA: 0s - loss: 0.6550 - acc: 0.6016
 384/1283 [=======>......................] - ETA: 0s - loss: 0.6393 - acc: 0.6224
 512/1283 [==========>...................] - ETA: 0s - loss: 0.6427 - acc: 0.6094
 704/1283 [===============>..............] - ETA: 0s - loss: 0.6434 - acc: 0.6122
 896/1283 [===================>..........] - ETA: 0s - loss: 0.6449 - acc: 0.6094
1024/1283 [======================>.......] - ETA: 0s - loss: 0.6425 - acc: 0.6104
1216/1283 [===========================>..] - ETA: 0s - loss: 0.6539 - acc: 0.6102
1283/1283 [==============================] - 0s 364us/step - loss: 0.6539 - acc: 0.6072 - val_loss: 0.7141 - val_acc: 0.5284

Epoch 00003: val_acc did not improve
Epoch 4/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.6993 - acc: 0.5156
 256/1283 [====>.........................] - ETA: 0s - loss: 0.6488 - acc: 0.6367
 448/1283 [=========>....................] - ETA: 0s - loss: 0.6368 - acc: 0.6429
 640/1283 [=============>................] - ETA: 0s - loss: 0.6362 - acc: 0.6359
 832/1283 [==================>...........] - ETA: 0s - loss: 0.6363 - acc: 0.6358
1024/1283 [======================>.......] - ETA: 0s - loss: 0.6323 - acc: 0.6367
1216/1283 [===========================>..] - ETA: 0s - loss: 0.6284 - acc: 0.6414
1283/1283 [==============================] - 0s 343us/step - loss: 0.6311 - acc: 0.6360 - val_loss: 0.7109 - val_acc: 0.5371

Epoch 00004: val_acc did not improve
Epoch 5/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5876 - acc: 0.6562
 256/1283 [====>.........................] - ETA: 0s - loss: 0.6399 - acc: 0.6133
 448/1283 [=========>....................] - ETA: 0s - loss: 0.6366 - acc: 0.6205
 640/1283 [=============>................] - ETA: 0s - loss: 0.6364 - acc: 0.6359
 832/1283 [==================>...........] - ETA: 0s - loss: 0.6318 - acc: 0.6478
1024/1283 [======================>.......] - ETA: 0s - loss: 0.6266 - acc: 0.6514
1216/1283 [===========================>..] - ETA: 0s - loss: 0.6289 - acc: 0.6513
1283/1283 [==============================] - 0s 336us/step - loss: 0.6274 - acc: 0.6547 - val_loss: 0.7084 - val_acc: 0.5153

Epoch 00005: val_acc did not improve
Epoch 6/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5862 - acc: 0.6875
 256/1283 [====>.........................] - ETA: 0s - loss: 0.6350 - acc: 0.6875
 448/1283 [=========>....................] - ETA: 0s - loss: 0.6288 - acc: 0.6741
 640/1283 [=============>................] - ETA: 0s - loss: 0.6189 - acc: 0.6734
 832/1283 [==================>...........] - ETA: 0s - loss: 0.6152 - acc: 0.6683
1088/1283 [========================>.....] - ETA: 0s - loss: 0.6190 - acc: 0.6590
1280/1283 [============================>.] - ETA: 0s - loss: 0.6194 - acc: 0.6531
1283/1283 [==============================] - 0s 332us/step - loss: 0.6193 - acc: 0.6532 - val_loss: 0.7053 - val_acc: 0.5502

Epoch 00006: val_acc improved from 0.54585 to 0.55022, saving model to classification_logs//cnn_early_fusion_m_V_ep_100_bs_64_bn_False_dr_0.2_nl_2_ml_25/saved_models/best_validation_cnn_early_fusion_m_V_ep_100_bs_64_bn_False_dr_0.2_nl_2_ml_25.ckpt
Epoch 7/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.6279 - acc: 0.6719
 256/1283 [====>.........................] - ETA: 0s - loss: 0.6389 - acc: 0.5664
 448/1283 [=========>....................] - ETA: 0s - loss: 0.6293 - acc: 0.5871
 640/1283 [=============>................] - ETA: 0s - loss: 0.6196 - acc: 0.6141
 768/1283 [================>.............] - ETA: 0s - loss: 0.6121 - acc: 0.6367
 896/1283 [===================>..........] - ETA: 0s - loss: 0.6123 - acc: 0.6451
1088/1283 [========================>.....] - ETA: 0s - loss: 0.6062 - acc: 0.6461
1216/1283 [===========================>..] - ETA: 0s - loss: 0.5998 - acc: 0.6538
1283/1283 [==============================] - 1s 454us/step - loss: 0.6082 - acc: 0.6508 - val_loss: 0.7125 - val_acc: 0.5284

Epoch 00007: val_acc did not improve
Epoch 8/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.6292 - acc: 0.6562
 192/1283 [===>..........................] - ETA: 0s - loss: 0.5715 - acc: 0.7188
 384/1283 [=======>......................] - ETA: 0s - loss: 0.5829 - acc: 0.7031
 512/1283 [==========>...................] - ETA: 0s - loss: 0.5846 - acc: 0.6953
 704/1283 [===============>..............] - ETA: 0s - loss: 0.5883 - acc: 0.6832
 896/1283 [===================>..........] - ETA: 0s - loss: 0.5873 - acc: 0.6808
1024/1283 [======================>.......] - ETA: 0s - loss: 0.5829 - acc: 0.6846
1152/1283 [=========================>....] - ETA: 0s - loss: 0.5806 - acc: 0.6866
1283/1283 [==============================] - 1s 431us/step - loss: 0.5801 - acc: 0.6890 - val_loss: 0.7457 - val_acc: 0.5284

Epoch 00008: val_acc did not improve
Epoch 9/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.6012 - acc: 0.6094
 192/1283 [===>..........................] - ETA: 0s - loss: 0.5684 - acc: 0.6771
 384/1283 [=======>......................] - ETA: 0s - loss: 0.5727 - acc: 0.6823
 512/1283 [==========>...................] - ETA: 0s - loss: 0.5659 - acc: 0.6855
 704/1283 [===============>..............] - ETA: 0s - loss: 0.5732 - acc: 0.6847
 832/1283 [==================>...........] - ETA: 0s - loss: 0.5710 - acc: 0.6827
 960/1283 [=====================>........] - ETA: 0s - loss: 0.5860 - acc: 0.6875
1088/1283 [========================>.....] - ETA: 0s - loss: 0.5773 - acc: 0.6967
1216/1283 [===========================>..] - ETA: 0s - loss: 0.5753 - acc: 0.6974
1283/1283 [==============================] - 1s 471us/step - loss: 0.5757 - acc: 0.6968 - val_loss: 0.7675 - val_acc: 0.5066

Epoch 00009: val_acc did not improve
Epoch 10/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5329 - acc: 0.7812
 192/1283 [===>..........................] - ETA: 0s - loss: 0.5492 - acc: 0.7135
 320/1283 [======>.......................] - ETA: 0s - loss: 0.5347 - acc: 0.7344
 512/1283 [==========>...................] - ETA: 0s - loss: 0.5766 - acc: 0.7305
 704/1283 [===============>..............] - ETA: 0s - loss: 0.5618 - acc: 0.7273
 832/1283 [==================>...........] - ETA: 0s - loss: 0.5691 - acc: 0.7139
1024/1283 [======================>.......] - ETA: 0s - loss: 0.5639 - acc: 0.7100
1152/1283 [=========================>....] - ETA: 0s - loss: 0.5597 - acc: 0.7135
1283/1283 [==============================] - 1s 421us/step - loss: 0.5543 - acc: 0.7155 - val_loss: 0.8049 - val_acc: 0.4978

Epoch 00010: val_acc did not improve
Epoch 11/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5423 - acc: 0.7969
 256/1283 [====>.........................] - ETA: 0s - loss: 0.5063 - acc: 0.7852
 384/1283 [=======>......................] - ETA: 0s - loss: 0.5189 - acc: 0.7526
 512/1283 [==========>...................] - ETA: 0s - loss: 0.5196 - acc: 0.7520
 640/1283 [=============>................] - ETA: 0s - loss: 0.5181 - acc: 0.7547
 768/1283 [================>.............] - ETA: 0s - loss: 0.5412 - acc: 0.7474
 896/1283 [===================>..........] - ETA: 0s - loss: 0.5353 - acc: 0.7522
1024/1283 [======================>.......] - ETA: 0s - loss: 0.5341 - acc: 0.7490
1152/1283 [=========================>....] - ETA: 0s - loss: 0.5324 - acc: 0.7535
1280/1283 [============================>.] - ETA: 0s - loss: 0.5307 - acc: 0.7531
1283/1283 [==============================] - 1s 492us/step - loss: 0.5311 - acc: 0.7529 - val_loss: 0.8140 - val_acc: 0.4934

Epoch 00011: val_acc did not improve
Epoch 12/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.4437 - acc: 0.7812
 192/1283 [===>..........................] - ETA: 0s - loss: 0.5216 - acc: 0.7448
 320/1283 [======>.......................] - ETA: 0s - loss: 0.5030 - acc: 0.7562
 448/1283 [=========>....................] - ETA: 0s - loss: 0.5315 - acc: 0.7366
 576/1283 [============>.................] - ETA: 0s - loss: 0.5349 - acc: 0.7396
 704/1283 [===============>..............] - ETA: 0s - loss: 0.5390 - acc: 0.7344
 896/1283 [===================>..........] - ETA: 0s - loss: 0.5500 - acc: 0.7165
1024/1283 [======================>.......] - ETA: 0s - loss: 0.5388 - acc: 0.7266
1152/1283 [=========================>....] - ETA: 0s - loss: 0.5361 - acc: 0.7318
1280/1283 [============================>.] - ETA: 0s - loss: 0.5343 - acc: 0.7328
1283/1283 [==============================] - 1s 488us/step - loss: 0.5337 - acc: 0.7334 - val_loss: 0.8396 - val_acc: 0.4716

Epoch 00012: val_acc did not improve
Epoch 13/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.6737 - acc: 0.8125
 192/1283 [===>..........................] - ETA: 0s - loss: 0.5527 - acc: 0.7812
 320/1283 [======>.......................] - ETA: 0s - loss: 0.5100 - acc: 0.7969
 448/1283 [=========>....................] - ETA: 0s - loss: 0.5032 - acc: 0.7879
 640/1283 [=============>................] - ETA: 0s - loss: 0.4971 - acc: 0.7828
 768/1283 [================>.............] - ETA: 0s - loss: 0.4889 - acc: 0.7812
 896/1283 [===================>..........] - ETA: 0s - loss: 0.4828 - acc: 0.7846
1024/1283 [======================>.......] - ETA: 0s - loss: 0.4947 - acc: 0.7725
1152/1283 [=========================>....] - ETA: 0s - loss: 0.4942 - acc: 0.7726
1283/1283 [==============================] - 1s 469us/step - loss: 0.4910 - acc: 0.7701 - val_loss: 0.8980 - val_acc: 0.4978

Epoch 00013: val_acc did not improve
Epoch 14/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.3709 - acc: 0.8750
 256/1283 [====>.........................] - ETA: 0s - loss: 0.4280 - acc: 0.8047
 384/1283 [=======>......................] - ETA: 0s - loss: 0.4507 - acc: 0.8099
 512/1283 [==========>...................] - ETA: 0s - loss: 0.4563 - acc: 0.7891
 640/1283 [=============>................] - ETA: 0s - loss: 0.4508 - acc: 0.7906
 768/1283 [================>.............] - ETA: 0s - loss: 0.4503 - acc: 0.7969
 896/1283 [===================>..........] - ETA: 0s - loss: 0.4512 - acc: 0.7913
1024/1283 [======================>.......] - ETA: 0s - loss: 0.4463 - acc: 0.7949
1152/1283 [=========================>....] - ETA: 0s - loss: 0.4434 - acc: 0.7977
1280/1283 [============================>.] - ETA: 0s - loss: 0.4530 - acc: 0.7984
1283/1283 [==============================] - 1s 460us/step - loss: 0.4538 - acc: 0.7973 - val_loss: 0.9314 - val_acc: 0.4847

Epoch 00014: val_acc did not improve
Epoch 15/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.4165 - acc: 0.8125
 192/1283 [===>..........................] - ETA: 0s - loss: 0.3822 - acc: 0.8281
 320/1283 [======>.......................] - ETA: 0s - loss: 0.3730 - acc: 0.8375
 448/1283 [=========>....................] - ETA: 0s - loss: 0.4196 - acc: 0.8348
 576/1283 [============>.................] - ETA: 0s - loss: 0.4258 - acc: 0.8194
 704/1283 [===============>..............] - ETA: 0s - loss: 0.4279 - acc: 0.8125
 832/1283 [==================>...........] - ETA: 0s - loss: 0.4369 - acc: 0.8065
 960/1283 [=====================>........] - ETA: 0s - loss: 0.4367 - acc: 0.8063
1088/1283 [========================>.....] - ETA: 0s - loss: 0.4420 - acc: 0.7987
1280/1283 [============================>.] - ETA: 0s - loss: 0.4440 - acc: 0.7930
1283/1283 [==============================] - 1s 498us/step - loss: 0.4437 - acc: 0.7935 - val_loss: 0.8194 - val_acc: 0.5284

Epoch 00015: val_acc did not improve
Epoch 16/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.3704 - acc: 0.8750
 256/1283 [====>.........................] - ETA: 0s - loss: 0.4822 - acc: 0.7656
 384/1283 [=======>......................] - ETA: 0s - loss: 0.5611 - acc: 0.7552
 512/1283 [==========>...................] - ETA: 0s - loss: 0.5425 - acc: 0.7598
 640/1283 [=============>................] - ETA: 0s - loss: 0.5374 - acc: 0.7531
 768/1283 [================>.............] - ETA: 0s - loss: 0.5234 - acc: 0.7526
 896/1283 [===================>..........] - ETA: 0s - loss: 0.5117 - acc: 0.7612
1024/1283 [======================>.......] - ETA: 0s - loss: 0.5078 - acc: 0.7568
1216/1283 [===========================>..] - ETA: 0s - loss: 0.4973 - acc: 0.7590
1283/1283 [==============================] - 1s 465us/step - loss: 0.4945 - acc: 0.7607 - val_loss: 0.7819 - val_acc: 0.4891

Epoch 00016: val_acc did not improve
Epoch 00016: early stopping
batch_size=64
batch_norm=False
dropout_rate=0.2
n_layers=2
max_len=25
epochs=100
mode=V
accuracy=0.5262390670553936
best_valid_accuracy=0.5539358600583091
