/afs/inf.ed.ac.uk/user/s17/s1738075/.local/lib/python2.7/site-packages/pandas/core/nanops.py:39: UserWarning: The installed version of bottleneck 0.7.0 is not supported in pandas and will be not be used
The minimum supported version is 1.0.0

  ver=ver, min_ver=_MIN_BOTTLENECK_VERSION), UserWarning)
/afs/inf.ed.ac.uk/user/s17/s1738075/.local/lib/python2.7/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
early_fusion_cnn.py:139: RuntimeWarning: invalid value encountered in divide
  train_set_audio = train_set_audio / audio_max
early_fusion_cnn.py:141: RuntimeWarning: invalid value encountered in divide
  test_set_audio = test_set_audio / audio_max
2018-03-20 23:20:59.865458: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
This API will be deprecated in the future versions. Please check the Github page for the current API

Modality facet for video 8qrpnFRGt2A segment 13 is (partially) missing and is thus being replaced by zeros!

Train on 1283 samples, validate on 229 samples
Epoch 1/100

  64/1283 [>.............................] - ETA: 7s - loss: 0.7068 - acc: 0.4219
 256/1283 [====>.........................] - ETA: 1s - loss: 0.6929 - acc: 0.4961
 448/1283 [=========>....................] - ETA: 1s - loss: 0.6925 - acc: 0.5000
 576/1283 [============>.................] - ETA: 0s - loss: 0.6891 - acc: 0.5069
 704/1283 [===============>..............] - ETA: 0s - loss: 0.6884 - acc: 0.5043
 832/1283 [==================>...........] - ETA: 0s - loss: 0.6933 - acc: 0.5132
 960/1283 [=====================>........] - ETA: 0s - loss: 0.6899 - acc: 0.5198
1152/1283 [=========================>....] - ETA: 0s - loss: 0.6878 - acc: 0.5304
1280/1283 [============================>.] - ETA: 0s - loss: 0.6846 - acc: 0.5406
1283/1283 [==============================] - 1s 738us/step - loss: 0.6845 - acc: 0.5401 - val_loss: 0.6922 - val_acc: 0.5328

Epoch 00001: val_acc improved from -inf to 0.53275, saving model to classification_logs//cnn_early_fusion_m_V_ep_100_bs_64_bn_False_dr_0.2_nl_2_ml_20/saved_models/best_validation_cnn_early_fusion_m_V_ep_100_bs_64_bn_False_dr_0.2_nl_2_ml_20.ckpt
Epoch 2/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.6632 - acc: 0.5625
 256/1283 [====>.........................] - ETA: 0s - loss: 0.6657 - acc: 0.5742
 384/1283 [=======>......................] - ETA: 0s - loss: 0.6670 - acc: 0.5651
 512/1283 [==========>...................] - ETA: 0s - loss: 0.6643 - acc: 0.5879
 640/1283 [=============>................] - ETA: 0s - loss: 0.6792 - acc: 0.5859
 768/1283 [================>.............] - ETA: 0s - loss: 0.6711 - acc: 0.5951
 896/1283 [===================>..........] - ETA: 0s - loss: 0.6681 - acc: 0.6004
1024/1283 [======================>.......] - ETA: 0s - loss: 0.6643 - acc: 0.6133
1152/1283 [=========================>....] - ETA: 0s - loss: 0.6637 - acc: 0.6094
1280/1283 [============================>.] - ETA: 0s - loss: 0.6590 - acc: 0.6164
1283/1283 [==============================] - 1s 445us/step - loss: 0.6590 - acc: 0.6165 - val_loss: 0.7011 - val_acc: 0.5240

Epoch 00002: val_acc did not improve
Epoch 3/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.6697 - acc: 0.6094
 192/1283 [===>..........................] - ETA: 0s - loss: 0.6654 - acc: 0.5885
 384/1283 [=======>......................] - ETA: 0s - loss: 0.6476 - acc: 0.6068
 576/1283 [============>.................] - ETA: 0s - loss: 0.6497 - acc: 0.6181
 704/1283 [===============>..............] - ETA: 0s - loss: 0.6450 - acc: 0.6236
 832/1283 [==================>...........] - ETA: 0s - loss: 0.6439 - acc: 0.6334
 960/1283 [=====================>........] - ETA: 0s - loss: 0.6473 - acc: 0.6250
1152/1283 [=========================>....] - ETA: 0s - loss: 0.6548 - acc: 0.6233
1283/1283 [==============================] - 1s 402us/step - loss: 0.6523 - acc: 0.6228 - val_loss: 0.7119 - val_acc: 0.5197

Epoch 00003: val_acc did not improve
Epoch 4/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.6415 - acc: 0.5312
 256/1283 [====>.........................] - ETA: 0s - loss: 0.6228 - acc: 0.6328
 384/1283 [=======>......................] - ETA: 0s - loss: 0.6175 - acc: 0.6484
 576/1283 [============>.................] - ETA: 0s - loss: 0.6338 - acc: 0.6354
 832/1283 [==================>...........] - ETA: 0s - loss: 0.6316 - acc: 0.6454
1024/1283 [======================>.......] - ETA: 0s - loss: 0.6258 - acc: 0.6504
1280/1283 [============================>.] - ETA: 0s - loss: 0.6223 - acc: 0.6523
1283/1283 [==============================] - 0s 340us/step - loss: 0.6227 - acc: 0.6516 - val_loss: 0.7243 - val_acc: 0.5371

Epoch 00004: val_acc improved from 0.53275 to 0.53712, saving model to classification_logs//cnn_early_fusion_m_V_ep_100_bs_64_bn_False_dr_0.2_nl_2_ml_20/saved_models/best_validation_cnn_early_fusion_m_V_ep_100_bs_64_bn_False_dr_0.2_nl_2_ml_20.ckpt
Epoch 5/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.6056 - acc: 0.6094
 320/1283 [======>.......................] - ETA: 0s - loss: 0.6126 - acc: 0.6438
 512/1283 [==========>...................] - ETA: 0s - loss: 0.6060 - acc: 0.6543
 704/1283 [===============>..............] - ETA: 0s - loss: 0.6034 - acc: 0.6591
 960/1283 [=====================>........] - ETA: 0s - loss: 0.6114 - acc: 0.6573
1152/1283 [=========================>....] - ETA: 0s - loss: 0.6152 - acc: 0.6502
1283/1283 [==============================] - 0s 273us/step - loss: 0.6175 - acc: 0.6539 - val_loss: 0.7107 - val_acc: 0.5066

Epoch 00005: val_acc did not improve
Epoch 6/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5511 - acc: 0.7812
 320/1283 [======>.......................] - ETA: 0s - loss: 0.5905 - acc: 0.6844
 576/1283 [============>.................] - ETA: 0s - loss: 0.5811 - acc: 0.6962
 768/1283 [================>.............] - ETA: 0s - loss: 0.5900 - acc: 0.6849
 960/1283 [=====================>........] - ETA: 0s - loss: 0.5907 - acc: 0.6760
1088/1283 [========================>.....] - ETA: 0s - loss: 0.5963 - acc: 0.6664
1216/1283 [===========================>..] - ETA: 0s - loss: 0.5912 - acc: 0.6702
1283/1283 [==============================] - 0s 341us/step - loss: 0.5898 - acc: 0.6719 - val_loss: 0.7606 - val_acc: 0.4847

Epoch 00006: val_acc did not improve
Epoch 7/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5639 - acc: 0.6562
 256/1283 [====>.........................] - ETA: 0s - loss: 0.5608 - acc: 0.6875
 448/1283 [=========>....................] - ETA: 0s - loss: 0.5669 - acc: 0.6853
 640/1283 [=============>................] - ETA: 0s - loss: 0.5661 - acc: 0.6828
 896/1283 [===================>..........] - ETA: 0s - loss: 0.5660 - acc: 0.6942
1088/1283 [========================>.....] - ETA: 0s - loss: 0.5689 - acc: 0.6958
1283/1283 [==============================] - 0s 306us/step - loss: 0.5723 - acc: 0.6945 - val_loss: 0.7832 - val_acc: 0.4978

Epoch 00007: val_acc did not improve
Epoch 8/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5822 - acc: 0.6719
 256/1283 [====>.........................] - ETA: 0s - loss: 0.5401 - acc: 0.6992
 512/1283 [==========>...................] - ETA: 0s - loss: 0.5593 - acc: 0.6973
 704/1283 [===============>..............] - ETA: 0s - loss: 0.5603 - acc: 0.7060
 896/1283 [===================>..........] - ETA: 0s - loss: 0.5664 - acc: 0.6975
1088/1283 [========================>.....] - ETA: 0s - loss: 0.5678 - acc: 0.6976
1280/1283 [============================>.] - ETA: 0s - loss: 0.5633 - acc: 0.7086
1283/1283 [==============================] - 0s 300us/step - loss: 0.5628 - acc: 0.7093 - val_loss: 0.7670 - val_acc: 0.5022

Epoch 00008: val_acc did not improve
Epoch 9/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.5321 - acc: 0.7656
 256/1283 [====>.........................] - ETA: 0s - loss: 0.5392 - acc: 0.7656
 512/1283 [==========>...................] - ETA: 0s - loss: 0.5335 - acc: 0.7383
 704/1283 [===============>..............] - ETA: 0s - loss: 0.5233 - acc: 0.7372
 896/1283 [===================>..........] - ETA: 0s - loss: 0.5231 - acc: 0.7388
1088/1283 [========================>.....] - ETA: 0s - loss: 0.5171 - acc: 0.7399
1280/1283 [============================>.] - ETA: 0s - loss: 0.5250 - acc: 0.7352
1283/1283 [==============================] - 0s 314us/step - loss: 0.5247 - acc: 0.7358 - val_loss: 0.8488 - val_acc: 0.5066

Epoch 00009: val_acc did not improve
Epoch 10/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.4103 - acc: 0.8281
 256/1283 [====>.........................] - ETA: 0s - loss: 0.4633 - acc: 0.7773
 448/1283 [=========>....................] - ETA: 0s - loss: 0.4863 - acc: 0.7522
 640/1283 [=============>................] - ETA: 0s - loss: 0.4985 - acc: 0.7391
 832/1283 [==================>...........] - ETA: 0s - loss: 0.4998 - acc: 0.7404
1024/1283 [======================>.......] - ETA: 0s - loss: 0.5138 - acc: 0.7344
1216/1283 [===========================>..] - ETA: 0s - loss: 0.5038 - acc: 0.7434
1283/1283 [==============================] - 0s 305us/step - loss: 0.5030 - acc: 0.7443 - val_loss: 0.7706 - val_acc: 0.4978

Epoch 00010: val_acc did not improve
Epoch 11/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.4133 - acc: 0.7969
 256/1283 [====>.........................] - ETA: 0s - loss: 0.4330 - acc: 0.7852
 448/1283 [=========>....................] - ETA: 0s - loss: 0.4352 - acc: 0.7879
 640/1283 [=============>................] - ETA: 0s - loss: 0.4563 - acc: 0.7750
 832/1283 [==================>...........] - ETA: 0s - loss: 0.4623 - acc: 0.7728
1024/1283 [======================>.......] - ETA: 0s - loss: 0.4620 - acc: 0.7695
1216/1283 [===========================>..] - ETA: 0s - loss: 0.4659 - acc: 0.7656
1283/1283 [==============================] - 0s 329us/step - loss: 0.4692 - acc: 0.7654 - val_loss: 0.8111 - val_acc: 0.5022

Epoch 00011: val_acc did not improve
Epoch 12/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.4137 - acc: 0.8750
 256/1283 [====>.........................] - ETA: 0s - loss: 0.4149 - acc: 0.8203
 448/1283 [=========>....................] - ETA: 0s - loss: 0.4259 - acc: 0.8192
 704/1283 [===============>..............] - ETA: 0s - loss: 0.4317 - acc: 0.8097
 896/1283 [===================>..........] - ETA: 0s - loss: 0.4283 - acc: 0.8125
1088/1283 [========================>.....] - ETA: 0s - loss: 0.4264 - acc: 0.8097
1280/1283 [============================>.] - ETA: 0s - loss: 0.4288 - acc: 0.8055
1283/1283 [==============================] - 0s 312us/step - loss: 0.4287 - acc: 0.8051 - val_loss: 0.8782 - val_acc: 0.5284

Epoch 00012: val_acc did not improve
Epoch 13/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.3242 - acc: 0.9062
 256/1283 [====>.........................] - ETA: 0s - loss: 0.5184 - acc: 0.7812
 448/1283 [=========>....................] - ETA: 0s - loss: 0.5077 - acc: 0.7812
 640/1283 [=============>................] - ETA: 0s - loss: 0.5362 - acc: 0.7438
 896/1283 [===================>..........] - ETA: 0s - loss: 0.5140 - acc: 0.7545
1152/1283 [=========================>....] - ETA: 0s - loss: 0.4978 - acc: 0.7595
1283/1283 [==============================] - 0s 296us/step - loss: 0.4832 - acc: 0.7732 - val_loss: 0.9351 - val_acc: 0.4978

Epoch 00013: val_acc did not improve
Epoch 14/100

  64/1283 [>.............................] - ETA: 0s - loss: 0.4251 - acc: 0.8594
 320/1283 [======>.......................] - ETA: 0s - loss: 0.3904 - acc: 0.8500
 576/1283 [============>.................] - ETA: 0s - loss: 0.4083 - acc: 0.8177
 832/1283 [==================>...........] - ETA: 0s - loss: 0.4109 - acc: 0.8149
1088/1283 [========================>.....] - ETA: 0s - loss: 0.4082 - acc: 0.8171
1283/1283 [==============================] - 0s 272us/step - loss: 0.3955 - acc: 0.8246 - val_loss: 1.0254 - val_acc: 0.4716

Epoch 00014: val_acc did not improve
Epoch 00014: early stopping
batch_size=64
batch_norm=False
dropout_rate=0.2
n_layers=2
max_len=20
epochs=100
mode=V
accuracy=0.47230320699708456
best_valid_accuracy=0.543731778425656
